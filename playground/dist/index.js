var eg=Object.create;var la=Object.defineProperty,tg=Object.defineProperties,rg=Object.getOwnPropertyDescriptor,ng=Object.getOwnPropertyDescriptors,ig=Object.getOwnPropertyNames,ca=Object.getOwnPropertySymbols,og=Object.getPrototypeOf,oc=Object.prototype.hasOwnProperty,Eu=Object.prototype.propertyIsEnumerable;var ic=(e,t,r)=>t in e?la(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,k=(e,t)=>{for(var r in t||(t={}))oc.call(t,r)&&ic(e,r,t[r]);if(ca)for(var r of ca(t))Eu.call(t,r)&&ic(e,r,t[r]);return e},O=(e,t)=>tg(e,ng(t));var Ou=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,r)=>(typeof require!="undefined"?require:t)[r]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var $u=(e,t)=>{var r={};for(var n in e)oc.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&ca)for(var n of ca(e))t.indexOf(n)<0&&Eu.call(e,n)&&(r[n]=e[n]);return r};var ua=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ar=(e,t)=>{for(var r in t)la(e,r,{get:t[r],enumerable:!0})},ag=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ig(t))!oc.call(e,i)&&i!==r&&la(e,i,{get:()=>t[i],enumerable:!(n=rg(t,i))||n.enumerable});return e};var Vt=(e,t,r)=>(r=e!=null?eg(og(e)):{},ag(t||!e||!e.__esModule?la(r,"default",{value:e,enumerable:!0}):r,e));var re=(e,t,r)=>(ic(e,typeof t!="symbol"?t+"":t,r),r),zu=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var g=(e,t,r)=>(zu(e,t,"read from private field"),r?r.call(e):t.get(e)),P=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},U=(e,t,r,n)=>(zu(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);var fa=ua((i1,Lu)=>{Lu.exports=function(e,t,r,n,i){var o,a;if(n===void 0)n=0;else if(n=n|0,n<0||n>=e.length)throw new RangeError("invalid lower bound");if(i===void 0)i=e.length-1;else if(i=i|0,i<n||i>=e.length)throw new RangeError("invalid upper bound");for(;n<=i;)if(o=n+(i-n>>>1),a=+r(e[o],t,o,e),a<0)n=o+1;else if(a>0)i=o-1;else return o;return~n}});var pa=ua((o1,Iu)=>{"use strict";Iu.exports=sg;function Dn(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function sg(e){if(e=e||{},e.circles)return cg(e);return e.proto?n:r;function t(i,o){for(var a=Object.keys(i),s=new Array(a.length),l=0;l<a.length;l++){var c=a[l],u=i[c];typeof u!="object"||u===null?s[c]=u:u instanceof Date?s[c]=new Date(u):ArrayBuffer.isView(u)?s[c]=Dn(u):s[c]=o(u)}return s}function r(i){if(typeof i!="object"||i===null)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return t(i,r);if(i instanceof Map)return new Map(t(Array.from(i),r));if(i instanceof Set)return new Set(t(Array.from(i),r));var o={};for(var a in i)if(Object.hasOwnProperty.call(i,a)!==!1){var s=i[a];typeof s!="object"||s===null?o[a]=s:s instanceof Date?o[a]=new Date(s):s instanceof Map?o[a]=new Map(t(Array.from(s),r)):s instanceof Set?o[a]=new Set(t(Array.from(s),r)):ArrayBuffer.isView(s)?o[a]=Dn(s):o[a]=r(s)}return o}function n(i){if(typeof i!="object"||i===null)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return t(i,n);if(i instanceof Map)return new Map(t(Array.from(i),n));if(i instanceof Set)return new Set(t(Array.from(i),n));var o={};for(var a in i){var s=i[a];typeof s!="object"||s===null?o[a]=s:s instanceof Date?o[a]=new Date(s):s instanceof Map?o[a]=new Map(t(Array.from(s),n)):s instanceof Set?o[a]=new Set(t(Array.from(s),n)):ArrayBuffer.isView(s)?o[a]=Dn(s):o[a]=n(s)}return o}}function cg(e){var t=[],r=[];return e.proto?o:i;function n(a,s){for(var l=Object.keys(a),c=new Array(l.length),u=0;u<l.length;u++){var p=l[u],d=a[p];if(typeof d!="object"||d===null)c[p]=d;else if(d instanceof Date)c[p]=new Date(d);else if(ArrayBuffer.isView(d))c[p]=Dn(d);else{var m=t.indexOf(d);m!==-1?c[p]=r[m]:c[p]=s(d)}}return c}function i(a){if(typeof a!="object"||a===null)return a;if(a instanceof Date)return new Date(a);if(Array.isArray(a))return n(a,i);if(a instanceof Map)return new Map(n(Array.from(a),i));if(a instanceof Set)return new Set(n(Array.from(a),i));var s={};t.push(a),r.push(s);for(var l in a)if(Object.hasOwnProperty.call(a,l)!==!1){var c=a[l];if(typeof c!="object"||c===null)s[l]=c;else if(c instanceof Date)s[l]=new Date(c);else if(c instanceof Map)s[l]=new Map(n(Array.from(c),i));else if(c instanceof Set)s[l]=new Set(n(Array.from(c),i));else if(ArrayBuffer.isView(c))s[l]=Dn(c);else{var u=t.indexOf(c);u!==-1?s[l]=r[u]:s[l]=i(c)}}return t.pop(),r.pop(),s}function o(a){if(typeof a!="object"||a===null)return a;if(a instanceof Date)return new Date(a);if(Array.isArray(a))return n(a,o);if(a instanceof Map)return new Map(n(Array.from(a),o));if(a instanceof Set)return new Set(n(Array.from(a),o));var s={};t.push(a),r.push(s);for(var l in a){var c=a[l];if(typeof c!="object"||c===null)s[l]=c;else if(c instanceof Date)s[l]=new Date(c);else if(c instanceof Map)s[l]=new Map(n(Array.from(c),o));else if(c instanceof Set)s[l]=new Set(n(Array.from(c),o));else if(ArrayBuffer.isView(c))s[l]=Dn(c);else{var u=t.indexOf(c);u!==-1?s[l]=r[u]:s[l]=o(c)}}return t.pop(),r.pop(),s}}});var va=ua((Qu,ka)=>{(function(e){if(typeof ka=="object"&&typeof ka.exports=="object"){var t=e(Ou,Qu);t!==void 0&&(ka.exports=t)}else typeof define=="function"&&define.amd&&define(["require","exports"],e)})(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=void 0;class r{constructor(c,u,p,d){this._uri=c,this._languageId=u,this._version=p,this._content=d,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(c){if(c){let u=this.offsetAt(c.start),p=this.offsetAt(c.end);return this._content.substring(u,p)}return this._content}update(c,u){for(let p of c)if(r.isIncremental(p)){let d=a(p.range),m=this.offsetAt(d.start),_=this.offsetAt(d.end);this._content=this._content.substring(0,m)+p.text+this._content.substring(_,this._content.length);let T=Math.max(d.start.line,0),b=Math.max(d.end.line,0),S=this._lineOffsets,z=o(p.text,!1,m);if(b-T===z.length)for(let $=0,J=z.length;$<J;$++)S[$+T+1]=z[$];else z.length<1e4?S.splice(T+1,b-T,...z):this._lineOffsets=S=S.slice(0,T+1).concat(z,S.slice(b+1));let q=p.text.length-(_-m);if(q!==0)for(let $=T+1+z.length,J=S.length;$<J;$++)S[$]=S[$]+q}else if(r.isFull(p))this._content=p.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=u}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=o(this._content,!0)),this._lineOffsets}positionAt(c){c=Math.max(Math.min(c,this._content.length),0);let u=this.getLineOffsets(),p=0,d=u.length;if(d===0)return{line:0,character:c};for(;p<d;){let _=Math.floor((p+d)/2);u[_]>c?d=_:p=_+1}let m=p-1;return{line:m,character:c-u[m]}}offsetAt(c){let u=this.getLineOffsets();if(c.line>=u.length)return this._content.length;if(c.line<0)return 0;let p=u[c.line],d=c.line+1<u.length?u[c.line+1]:this._content.length;return Math.max(Math.min(p+c.character,d),p)}get lineCount(){return this.getLineOffsets().length}static isIncremental(c){let u=c;return u!=null&&typeof u.text=="string"&&u.range!==void 0&&(u.rangeLength===void 0||typeof u.rangeLength=="number")}static isFull(c){let u=c;return u!=null&&typeof u.text=="string"&&u.range===void 0&&u.rangeLength===void 0}}var n;(function(l){function c(d,m,_,T){return new r(d,m,_,T)}l.create=c;function u(d,m,_){if(d instanceof r)return d.update(m,_),d;throw new Error("TextDocument.update: document must be created by TextDocument.create")}l.update=u;function p(d,m){let _=d.getText(),T=i(m.map(s),(z,q)=>{let $=z.range.start.line-q.range.start.line;return $===0?z.range.start.character-q.range.start.character:$}),b=0,S=[];for(let z of T){let q=d.offsetAt(z.range.start);if(q<b)throw new Error("Overlapping edit");q>b&&S.push(_.substring(b,q)),z.newText.length&&S.push(z.newText),b=d.offsetAt(z.range.end)}return S.push(_.substr(b)),S.join("")}l.applyEdits=p})(n=t.TextDocument||(t.TextDocument={}));function i(l,c){if(l.length<=1)return l;let u=l.length/2|0,p=l.slice(0,u),d=l.slice(u);i(p,c),i(d,c);let m=0,_=0,T=0;for(;m<p.length&&_<d.length;)c(p[m],d[_])<=0?l[T++]=p[m++]:l[T++]=d[_++];for(;m<p.length;)l[T++]=p[m++];for(;_<d.length;)l[T++]=d[_++];return l}function o(l,c,u=0){let p=c?[u]:[];for(let d=0;d<l.length;d++){let m=l.charCodeAt(d);(m===13||m===10)&&(m===13&&d+1<l.length&&l.charCodeAt(d+1)===10&&d++,p.push(u+d+1))}return p}function a(l){let c=l.start,u=l.end;return c.line>u.line||c.line===u.line&&c.character>u.character?{start:u,end:c}:l}function s(l){let c=a(l.range);return c!==l.range?{newText:l.newText,range:c}:l}})});var Pf=ua((Ha,If)=>{(function(e,t){typeof Ha=="object"&&typeof If<"u"?t(Ha):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e["base64-arraybuffer"]={}))})(Ha,function(e){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=typeof Uint8Array>"u"?[]:new Uint8Array(256),n=0;n<t.length;n++)r[t.charCodeAt(n)]=n;var i=function(a){var s=new Uint8Array(a),l,c=s.length,u="";for(l=0;l<c;l+=3)u+=t[s[l]>>2],u+=t[(s[l]&3)<<4|s[l+1]>>4],u+=t[(s[l+1]&15)<<2|s[l+2]>>6],u+=t[s[l+2]&63];return c%3===2?u=u.substring(0,u.length-1)+"=":c%3===1&&(u=u.substring(0,u.length-2)+"=="),u},o=function(a){var s=a.length*.75,l=a.length,c,u=0,p,d,m,_;a[a.length-1]==="="&&(s--,a[a.length-2]==="="&&s--);var T=new ArrayBuffer(s),b=new Uint8Array(T);for(c=0;c<l;c+=4)p=r[a.charCodeAt(c)],d=r[a.charCodeAt(c+1)],m=r[a.charCodeAt(c+2)],_=r[a.charCodeAt(c+3)],b[u++]=p<<2|d>>4,b[u++]=(d&15)<<4|m>>2,b[u++]=(m&3)<<6|_&63;return T};e.decode=o,e.encode=i,Object.defineProperty(e,"__esModule",{value:!0})})});var Au=Object.freeze({is(e){return e.startsWith("http:")||e.startsWith("https:")}}),e1=Object.freeze({mock(e){return new ac(e)}}),ac=class{options;constructor(t){this.options=t}async get(t){if(!this.options.fixtures[t])throw new Error(`404 not found: ${t}`);let r=this.options.fixtures[t];return r instanceof Uint8Array?r:typeof r=="string"?new TextEncoder().encode(r):new TextEncoder().encode(JSON.stringify(r))}};var Du=Vt(fa(),1),Mu=Vt(pa(),1),rt=URL;function Mn(e=t=>t[0]){return(t,r,n)=>{let i=new Map,o=n.value;return n.value=function(...a){let s=e(a);if(i.has(s))return i.get(s);let l=o.apply(this,a).then(c=>(i.delete(s),c),c=>(i.delete(s),Promise.reject(c)));return i.set(s,l),l},n}}var W;(function(e){e.TagPrefix="#",e.NamespacePathSep=":",e.PathSep="/",e.DefaultNamespace="minecraft";function t(n){switch(n.indexOf(e.NamespacePathSep)){case-1:return`${e.DefaultNamespace}${e.NamespacePathSep}${n}`;case 0:return`${e.DefaultNamespace}${n}`;default:return n}}e.lengthen=t;function r(n){return n.replace(/^(?:minecraft)?:/,"")}e.shorten=r})(W||(W={}));function wt(e){return new TextDecoder().decode(e)}var ye;(function(e){function t(n,i){return Array.isArray(n)?n.every(o=>i(o)):i(n)}e.is=t;function r(n){return Array.isArray(n)?n:[n]}e.toArray=r})(ye||(ye={}));var kr;(function(e){function t(r){return typeof r=="string"}e.isString=t})(kr||(kr={}));async function sc(e,t){return JSON.parse(wt(await e.archive.gunzip(t)))}function Pu(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Ai(e,t){let r=(0,Mu.default)()(e);for(let[n,i]of Object.entries(t))Pu(r[n])&&Pu(i)?r[n]=Ai(r[n],i):i===void 0?delete r[n]:r[n]=i;return r}var vr;(function(e){let t=Symbol("LazyDiscriminator");function r(a){return{discriminator:t,getter:a}}e.create=r;function n(a){return a?.discriminator===t}e.isComplex=n;function i(a){return n(a)&&!("value"in a)}e.isUnresolved=i;function o(a){return i(a)?a.value=a.getter():a}e.resolve=o})(vr||(vr={}));function rn(e,t,r){let n={};t=t.map(W.lengthen);for(let i of t)r.symbols.query(r.doc,e,i).forEachMember((o,a)=>{let s=Object.keys(a.visibleMembers),l=n[o]??=new Set,c=a.symbol?.relations?.default;c&&l.add(c.path[c.path.length-1]);for(let u of s)l.add(u)});return Object.fromEntries(Object.entries(n).map(([i,o])=>[i,[...o]]))}var Fu=Du.default;function Uu(e){return!!e[Symbol.iterator]}var Vu=Vt(fa(),1);var lg=`\r
`,nn="\r",on=`
`,Bu=Object.freeze([" ",`
`,"\r","	"]),an=class{string;indexMap;innerCursor=0;constructor(t,r=[]){this.string=t,this.indexMap=r}get cursor(){return qt.toOuterOffset(this.indexMap,this.innerCursor)}getCharRange(t=0){return qt.toOuterRange(this.indexMap,y.create(this.innerCursor+t,this.innerCursor+t+1))}peek(t=1,r=0){return this.string.slice(this.innerCursor+r,this.innerCursor+r+t)}tryPeek(t,r=0){return this.peek(t.length,r)===t}tryPeekAfterWhitespace(t){let r=this.string.length-this.innerCursor,n=0;for(;n<r&&Se.isWhitespace(this.peek(1,n));)n++;return this.tryPeek(t,n)}peekUntil(...t){let r="";for(let n=this.innerCursor;n<this.string.length;n++){let i=this.string.charAt(n);if(t.includes(i))return r;r+=i}return r}peekLine(){return this.peekUntil(nn,on)}hasNonSpaceAheadInLine(){for(let t=this.innerCursor;t<this.string.length;t++){let r=this.string.charAt(t);if(r===nn||r===on)break;if(!(r===" "||r==="	"))return!0}return!1}slice(t,r){if(typeof t=="number"){let i=qt.toInnerOffset(this.indexMap,t),o=r!==void 0?qt.toInnerOffset(this.indexMap,r):void 0;return this.string.slice(i,o)}let n=qt.toInnerRange(this.indexMap,y.get(t));return this.string.slice(n.start,n.end)}sliceToCursor(t){let r=qt.toInnerOffset(this.indexMap,t);return this.string.slice(r,this.innerCursor)}},Se=class extends an{string;indexMap;constructor(t,r=[]){super(t,r),this.string=t,this.indexMap=r}get cursor(){return super.cursor}set cursor(t){this.innerCursor=qt.toInnerOffset(this.indexMap,t)}clone(){let t=new Se(this.string,this.indexMap);return t.innerCursor=this.innerCursor,t}canRead(t=1){return this.innerCursor+t<=this.string.length}canReadInLine(){return this.canRead()&&this.peek()!==nn&&this.peek()!==on}read(){return this.string.charAt(this.innerCursor++)}skip(t=1){return this.innerCursor+=t,this}trySkip(t){return this.peek(t.length)===t?(this.skip(t.length),!0):!1}readLine(){return this.readUntil(nn,on)}skipLine(){return this.readLine(),this}nextLine(){return this.skipLine(),this.peek(2)===lg?this.skip(2):(this.peek()===nn||this.peek()===on)&&this.skip(),this}readSpace(){let t=this.innerCursor;return this.skipSpace(),this.string.slice(t,this.innerCursor)}skipSpace(){for(;this.canRead()&&Se.isSpace(this.peek());)this.skip();return this}readWhitespace(){let t=this.innerCursor;return this.skipWhitespace(),this.string.slice(t,this.innerCursor)}skipWhitespace(){for(;this.canRead()&&Se.isWhitespace(this.peek());)this.skip();return this}readIf(t){let r="";for(;this.canRead();){let n=this.peek();if(t(n))this.skip(),r+=n;else break}return r}skipIf(t){return this.readIf(t),this}readUntil(...t){let r="";for(;this.canRead();){let n=this.peek();if(t.includes(n))return r;r+=n,this.skip()}return r}skipUntilOrEnd(...t){return this.readUntil(...t),this}readUntilLineEnd(){return this.readUntil(nn,on)}skipUntilLineEnd(){return this.skipUntilOrEnd(nn,on)}readRemaining(){let t=this.innerCursor;return this.innerCursor=this.string.length,this.string.slice(t)}skipRemaining(){return this.readRemaining(),this}static isDigit(t){return t>="0"&&t<="9"}static isBrigadierQuote(t){return t==='"'||t==="'"}static isNewline(t){return t===`\r
`||t==="\r"||t===`
`}static isSpace(t){return t===" "||t==="	"}static isWhitespace(t){return Se.isSpace(t)||Se.isNewline(t)}};var Li;(function(e){function t(r){return typeof r=="function"&&(r=r()),r instanceof an&&(r=r.cursor),r}e.get=t})(Li||(Li={}));var y;(function(e){function t(b){let S=typeof b=="function"?b():b;return e.is(S)?e.create(S.start,S.end):cc.is(S)?e.create(S.range.start,S.range.end):e.create(S)}e.get=t;function r(b,S){return b=Li.get(b),{start:b,end:S!==void 0?Li.get(S):b}}e.create=r;function n(b,S){return{start:e.get(b).start,end:e.get(S).end}}e.span=n;function i(b){return!!b&&typeof b=="object"&&typeof b.start=="number"&&typeof b.end=="number"}e.is=i,e.Beginning=Object.freeze(e.create(0,1)),e.Full=Object.freeze(e.create(0,Number.POSITIVE_INFINITY));function o(b){return`[${b.start}, ${b.end})`}e.toString=o;function a(b,S,z=!1){return b=t(b),b.start<=S&&(z?S<=b.end:S<b.end)}e.contains=a;function s(b,S,z=!1){return b=t(b),S=t(S),a(b,S.start,z)&&a(b,S.end,!0)}e.containsRange=s;function l(b,S){return e.contains(b,S.start)||e.contains(S,b.start)}e.intersects=l;function c(b,S){return b.start===S.start&&b.end===S.end}e.equals=c;function u(b,S,z=!1){return z?b.end<e.get(S).start:b.end<=e.get(S).start}e.endsBefore=u;function p(b){return b=t(b),b.start===b.end}e.isEmpty=p;function d(b){return b.end-b.start}e.length=d;function m(b,S,z=!1){return(z?b.end<S.start:b.end<=S.start)?-1:(z?b.start>S.end:b.start>=S.end)?1:0}e.compare=m;function _(b,S,z=!1){return(z?b.end<S:b.end<=S)?-1:b.start>S?1:0}e.compareOffset=_;function T(b,S,z=S){return b=t(b),{start:b.start+S,end:b.end+z}}e.translate=T})(y||(y={}));var cc;(function(e){function t(r){return!!r&&typeof r=="object"&&y.is(r.range)}e.is=t})(cc||(cc={}));var qt;(function(e){function t(s,l,c,u,p){let d=l;for(let m of s){if(y.contains(m[c],l,p))return p?m[u].end:m[u].start;if(y.endsBefore(m[c],l))d=l-m[c].end+m[u].end;else break}return d}function r(s,l){return t(s,l,"outer","inner",!1)}e.toInnerOffset=r;function n(s,l){return y.create(r(s,l.start),t(s,l.end,"outer","inner",!0))}e.toInnerRange=n;function i(s,l){return t(s,l,"inner","outer",!1)}e.toOuterOffset=i;function o(s,l){return y.create(i(s,l.start),t(s,l.end,"inner","outer",!0))}e.toOuterRange=o;function a(s,l){return l.map(c=>({inner:c.inner,outer:o(s,c.outer)}))}e.merge=a})(qt||(qt={}));var da;(function(e){function t(r,n,i=3,o){let a={range:n,message:r,severity:i};return o&&(a.info=o),a}e.create=t})(da||(da={}));var Xe;(function(e){function t(a,s){return typeof a=="object"?r(a):n(a,s)}e.create=t;function r(a){return{line:a.line??0,character:a.character??0}}function n(a,s){return r({line:a,character:s})}e.Beginning=e.create(0,0),e.Infinity=e.create(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);function i(a){return`<${a.line}, ${a.character}>`}e.toString=i;function o(a,s){return a.line<s.line||a.line===s.line&&a.character<s.character}e.isBefore=o})(Xe||(Xe={}));var Fn;(function(e){function t(a,s,l,c){if(typeof a=="number")return{start:Xe.create(a,s),end:Xe.create(l,c)};if(s!==void 0)return{start:Xe.create(a),end:Xe.create(s)};{let u=a;return{start:Xe.create(u.start??{}),end:Xe.create(u.end??{})}}}e.create=t;function r(a,s){let l=y.get(a);return{start:s.positionAt(l.start),end:s.positionAt(l.end)}}e.from=r,e.Beginning=Object.freeze(e.create(0,0,0,1)),e.Full=Object.freeze(e.create(Xe.Beginning,Xe.Infinity));function n(a){return`[${Xe.toString(a.start)}, ${Xe.toString(a.end)})`}e.toString=n;function i(a,s){let{start:l,end:c}=a;return s.line<l.line||s.line>c.line?!1:l.line<s.line&&s.line<c.line?!0:(s.line===l.line?s.character>=l.character:!0)&&(s.line===c.line?s.character<c.character:!0)}e.contains=i;function o(a,s){return Xe.isBefore(Xe.create(a.end.line,a.end.character-1),s)}e.endsBefore=o})(Fn||(Fn={}));var ma;(function(e){function t(n){return{uri:n.uri??"",range:y.get(n.range??{start:0,end:0}),posRange:n.posRange??{start:{line:0,character:0},end:{line:0,character:0}}}}e.get=t;function r(n,i){return e.get({uri:n.uri,range:i,posRange:Fn.from(i,n)})}e.create=r})(ma||(ma={}));var Ie;(function(e){function t(p){return!!p&&typeof p=="object"&&typeof p.type=="string"&&y.is(p.range)}e.is=t;function r(p){for(let d of p.children??[])d.parent=p,r(d)}e.setParents=r;function n(p,d,m=!1){if(!p.children)return-1;let _=typeof d=="number"?y.compareOffset:y.compare;return(0,Vu.default)(p.children,d,(T,b)=>_(T.range,b,m))}e.findChildIndex=n;function i(p,d,m=!1){return p.children?.[n(p,d,m)]}e.findChild=i;function o(p,d,m=!1){if(!p.children)return-1;let _=-1;for(let[T,b]of p.children.entries())if(y.endsBefore(b.range,d,m))_=T;else break;return _}e.findLastChildIndex=o;function a(p,d,m=!1){return p.children?.[o(p,d,m)]}e.findLastChild=a;function s({node:p,needle:d,endInclusive:m=!1,predicate:_=()=>!0}){let T,b=y.contains(p,d,m)?p:void 0;for(;b&&_(b);)T=b,b=i(b,d,m);return T}e.findDeepestChild=s;function l({node:p,needle:d,endInclusive:m=!1,predicate:_=()=>!0}){let T=y.contains(p,d,m)?p:void 0;for(;T&&!_(T);)T=i(T,d,m);return T}e.findShallowestChild=l;function*c(p){let d=p;for(;d;)d.locals&&(yield d.locals),d=p.parent}e.getLocalsToRoot=c;function*u(p){p.locals&&(yield p.locals);for(let d of p.children??[])yield*u(d)}e.getLocalsToLeaves=u})(Ie||(Ie={}));var ha;(function(e){function t(n){return n.type==="boolean"}e.is=t;function r(n){return{type:"boolean",range:y.get(n)}}e.mock=r})(ha||(ha={}));var Un;(function(e){function t(r){return r?.type==="comment"}e.is=t})(Un||(Un={}));var qu;(function(e){function t(r){return r.type==="error"}e.is=t})(qu||(qu={}));var ga;(function(e){function t(r){return[...r.parserErrors,...r.checkerErrors??[],...r.linterErrors??[]]}e.getErrors=t})(ga||(ga={}));var sr;(function(e){function t(n){return n.type==="float"}e.is=t;function r(n){return{type:"float",range:y.get(n),value:0}}e.mock=r})(sr||(sr={}));var Bn;(function(e){function t(n){return n.type==="integer"}e.is=t;function r(n){return{type:"integer",range:y.get(n),value:0}}e.mock=r})(Bn||(Bn={}));var _a;(function(e){function t(r){return r?.type==="item"}e.is=t})(_a||(_a={}));var $e;(function(e){function t(n){return n?.type==="literal"}e.is=t;function r(n,i){return{type:"literal",range:y.get(n),options:i,value:""}}e.mock=r})($e||($e={}));var Zu;(function(e){function t(n){return n.type==="long"}e.is=t;function r(n){return{type:"long",range:y.get(n),value:0n}}e.mock=r})(Zu||(Zu={}));var sn;(function(e){function t(r){return r?.type==="pair"}e.is=t})(sn||(sn={}));var Q;(function(e){let t=W.TagPrefix,r=W.NamespacePathSep,n=W.PathSep,i=W.DefaultNamespace;function o(l){return l?.type==="resource_location"}e.is=o;function a(l,c){return{type:"resource_location",range:y.get(l),options:c}}e.mock=a;function s(l,c="origin"){let u=l.path?l.path.join(n):"",p;switch(c){case"origin":p=l.namespace!==void 0?`${l.namespace}${r}${u}`:u;break;case"full":p=`${l.namespace||i}${r}${u}`;break;case"short":p=l.namespace&&l.namespace!==i?`${l.namespace}${r}${u}`:u;break}return l.isTag?`${t}${p}`:p}e.toString=s})(Q||(Q={}));var Pi=Symbol("SequenceUtilDiscriminator"),Ii;(function(e){function t(r){return!!r&&r[Pi]}e.is=t})(Ii||(Ii={}));var ya;(function(e){function t(r,n){return r?r.includes(n):!1}e.is=t})(ya||(ya={}));var Hu=new Map([['"','"'],["'","'"],["\\","\\"],["b","\b"],["f","\f"],["n",`
`],["r","\r"],["t","	"]]),Qe;(function(e){function t(n){return n?.type==="string"}e.is=t;function r(n,i){return n=y.get(n),{type:"string",range:n,options:i,value:"",valueMap:[{inner:y.create(0),outer:y.create(n.start)}]}}e.mock=r})(Qe||(Qe={}));var xt;(function(e){function t(n){return n?.type==="symbol"}e.is=t;function r(n,i){return{type:"symbol",range:y.get(n),options:i,value:""}}e.mock=r})(xt||(xt={}));var Ku={array:"an array",boolean:"a boolean","bug-of-mc":"Due to a bug of Minecraft (%0%), %1%. Please Mojang, fix your game","code-action.block-state-sort-keys":"Sort block state","code-action.command-replaceitem":"Update this command to /item \u2026 replace","code-action.fix-file":"Fix all auto-fixable problems in this file","code-action.fix-workspace":"Fix all auto-fixable problems in the workspace","code-action.id-attribute-datafix":"Update this attribute name to 1.16","code-action.id-complete-default-namespace":"Complete default namespace","code-action.id-create-file":"Create %0% in the same data pack","code-action.id-omit-default-namespace":"Omit default namespace","code-action.id-zombified-piglin-datafix":"Change this ID to Zombified Piglin's","code-action.nbt-compound-sort-keys":"Sort NBT compound tag","code-action.nbt-type-to-byte":"Convert to an NBT byte tag","code-action.nbt-type-to-double":"Convert to an NBT double tag","code-action.nbt-type-to-float":"Convert to an NBT float tag","code-action.nbt-type-to-int":"Convert to an NBT int tag","code-action.nbt-type-to-long":"Convert to an NBT long tag","code-action.nbt-type-to-short":"Convert to an NBT short tag","code-action.nbt-uuid-datafix":"Update this UUID to 1.16","code-action.selector-sort-keys":"Sort selector argument","code-action.string-double-quote":"Quote this string with double quotation marks","code-action.string-single-quote":"Quote this string with single quotation marks","code-action.string-unquote":"Unquote this string","code-action.vector-align-0.0":"Align this vector to block origin","code-action.vector-align-0.5":"Align this vector to block center",comment:"a comment starting with %0%","conjunction.and_2":" and ","conjunction.and_3+_1":", ","conjunction.and_3+_2":", and ","conjunction.or_2":" or ","conjunction.or_3+_1":", ","conjunction.or_3+_2":", or ","datafix.error.command-replaceitem":"/replaceitem was removed in 20w46a (the second snapshot of 1.17) in favour of /item","duplicate-key":"Duplicate key %0%","ending-quote":"an ending quote %0%",entity:"an entity","error.unparseable-content":"Encountered unparseable content",expected:"Expected %0%","expected-got":"Expected %0% but got %1%",float:"a float","float.between":"a float between %0% and %1%",integer:"an integer","integer.between":"an integer between %0% and %1%","json.doc.advancement.display":"Advancement display settings. If present, the advancement will be visible in the advancement tabs.","json.checker.item.duplicate":"Duplicate list item","json.checker.property.deprecated":"Property %0% is deprecated","json.checker.property.missing":"Missing property %0%","json.checker.property.unknown":"Unknown property %0%","json.checker.string.hex-color":"a 6-digit hexadecimal number","json.checker.tag-entry.duplicate":"Duplicate tag entry","key-not-following-convention":"Invalid key %0% which doesn't follow %1% convention","linter.diagnostic-message-wrapper":"%0% (rule: %1%)","linter.name-convention.illegal":"Name %0% doesn't match %1%","linter.undeclared-symbol.message":"Cannot find %0% %1%","linter-config-validator.name-convention.type":"Expects a string that contains a regular expression describing the name","linter-config-validator.wrapper":"%0%. See [the documentation](%1) for more information",long:"a long","mcfunction.checker.command.data-modify-unapplicable-operation":"Operation %0% can only be used on %1%; the target path has type %2% instead","mcfunction.completer.block.states.default-value":"Default: %0%","mcfunction.parser.entity-selector.arguments.not-applicable":"%0% is not applicable here","mcfunction.parser.entity-selector.arguments.unknown":"Unknown entity selector argument %0%","mcfunction.parser.entity-selector.entities-disallowed":"The selector contains non-player entities","mcfunction.parser.entity-selector.multiple-disallowed":"The selector contains multiple entities","mcfunction.parser.entity-selector.player-name.too-long":"Player names cannot be longer than %0% characters","mcfunction.parser.eoc-unexpected":"Expected more arguments","mcfunction.parser.leading-slash":"a leading slash %0%","mcfunction.parser.no-permission":"Permission level %0% is required, which is higher than %1% defined in config","mcfunction.parser.objective.too-long":"Objective names cannot be longer than %0% characters","mcfunction.parser.range.min>max":"The minimum value %0% is larger than the maximum value %1%","mcfunction.parser.score_holder.fake-name.too-long":"Fake names cannot be longer than %0% characters","mcfunction.parser.sep":"a space (%0%)","mcfunction.parser.trailing":"Trailing data encountered: %0%","mcfunction.parser.unknown-parser":"Parser %0% hasn't been supported yet","mcfunction.parser.uuid.invalid":"Invalid UUID format","mcfunction.parser.vector.local-disallowed":"Local coordinates disallowed","mcfunction.parser.vector.mixed":"Cannot mix local coordinates and world coordinates together","mcfunction.signature-help.command-documentation":"[Minecraft Wiki: `%0%` command](https://minecraft.fandom.com/wiki/Commands/%0%)","mcfunction.signature-help.argument-parser-documentation":"[Minecraft Wiki: `%0%` argument parser](https://minecraft.fandom.com/wiki/Argument_types#%0%)","missing-key":"Missing key %0%","nbt.checker.block-states.fake-boolean":"Boolean block state values should be quoted","nbt.checker.block-states.unexpected-value-type":"Block state values should be either a string or an int","nbt.checker.block-states.unknown-state":"Unknown block state %0% for the following block(s): %1%","nbt.checker.boolean.out-of-range":"A boolean value should be either %0% or %1%","nbt.checker.collection.length-between":"%0% with length between %1% and %2%","nbt.checker.compound.field.union-empty-members":"Disallowed property","nbt.checker.path.index-out-of-bound":"The provided index %0% is out of bound, as the collection can only have at most %1% elements","nbt.checker.path.unexpected-filter":"Compound filters can only be used on compound tags","nbt.checker.path.unexpected-index":"Indices can only be used on array or list tags","nbt.checker.path.unexpected-key":"String keys can only be specified for compound tags","nbt.node":"a tag","nbt.node.byte":"a byte tag","nbt.node.byte_array":"a byte array tag","nbt.node.compound":"a compound tag","nbt.node.double":"a double tag","nbt.node.float":"a float tag","nbt.node.int":"an int tag","nbt.node.int_array":"an int array tag","nbt.node.list":"a list tag","nbt.node.long":"a long tag","nbt.node.long_array":"a long array tag","nbt.node.path.end":"the end of path","nbt.node.path.filter":"a compound filter","nbt.node.path.index":"an index","nbt.node.path.key":"a key","nbt.node.short":"a short tag","nbt.node.string":"a string tag","nbt.parser.number.out-of-range":"This looks like %0%, but it is actually %1% due to the numeral value being out of [%2%, %3%]","mcdoc.node.compound-definition":"a compound definition","mcdoc.node.enum-definition":"an enum definition","mcdoc.node.identifier":"an identifier","mcdoc.checker.duplicated-identifier":"Duplicated identifier %0%","mcdoc.checker.duplicated-identifier.related":"Identifier %0% is declared here","mcdoc.checker.entry.empty-mod-seg":"You cannot put \u201Cmod.mcdoc\u201D under a root directly","mcdoc.checker.entry.undefined-mod-seg":"The current file is not under any roots and won't be checked semantically","mcdoc.checker.ident-path.super-from-root":"This \u201Csuper\u201D it is out of the project's root","mcdoc.checker.ident-path.unknown-identifier":"Identifier %0% does not exist in module %1%","mcdoc.checker.ident-path.unknown-module":"Module %0% does not exist","mcdoc.checker.inject-clause.unmatched-injection":"Cannot inject %0% with %1%","mcdoc.checker.module-declaration.non-existent":"Implementation of module %0% does not exist","mcdoc.checker.module-declaration.duplicated":"Module %0% has already been declared","mcdoc.checker.module-declaration.duplicated.related":"Module %0% is declared here","mcdoc.checker.type-not-assignable":"Type %0% is not assignable to type %1%","mcdoc.parser.compound-definition.field-type":"a field type","mcdoc.parser.float.illegal":"Encountered illegal float number","mcdoc.parser.identifier.reserved-word":"%0% is a reserved word and cannot be used as an identifier name","mcdoc.parser.identifier.illegal":"%0% doesn't follow the format of %1%","mcdoc.parser.inject-clause.definition-expected":"Expected either an enum inject or a compound inject","mcdoc.parser.keyword.separation":"a separation","mcdoc.parser.resource-location.colon-expected":"Expected the colon (%0%) of resource locations","mcdoc.parser.syntax.doc-comment-unexpected":"Doc comments are not allowed here; you might want to replace the three slashes with two slashes","not-matching-any-child":"Invalid argument type",nothing:"nothing",number:"a number","number-range":"a number range","number-range.missing-min-and-max":"Expected either a minimum value or a maximum value","number.<=":"a number smaller than or equal to %0%","number.>=":"a number greater than or equal to %0%","number.between":"a number between %0% and %1%",object:"an object",objective:"an objective","objective-not-following-convention":"Invalid objective %0% which doesn't follow %1% convention","parser.float.illegal":"Illegal float numeral that doesn't follow %0%","parser.integer.illegal":"Illegal integer that doesn't follow %0%","parser.list.value":"a value","parser.list.trailing-sep":"Trailing separation","parser.record.key":"a key","parser.record.trailing-end":"Trailing separation","parser.record.unexpected-char":"Unexpected character %0%","parser.record.value":"a value","parser.resource-location.illegal":"Illegal character(s): %0%","parser.resource-location.namespace-expected":"Namespaces cannot be omitted here","parser.resource-location.tag-diallowed":"Tags are not allowed here","parser.string.illegal-brigadier":"Encountered non-[0-9A-Za-z_.+-] characters in %0%","parser.string.illegal-escape":"Unexpected escape character %0%","parser.string.illegal-quote":"Only %0% can be used to quote strings here","parser.string.illegal-unicode-escape":"Hexadecimal digit expected","punc.period":".","punc.quote":"\u201C%0%\u201D",quote:`a quote (\u201C'\u201D or \u201C"\u201D)`,quote_prefer_double:'Double quote (\u201C"\u201D) is preferable here',quote_prefer_single:"Single quote (\u201C'\u201D) is preferable here","resource-location":"a resource location","score-holder":"a score holder","scoreholder-not-following-convention":"Invalid score_holder %0% which doesn't follow %1% convention","server.new-version":"The Data-pack Language Server has been updated to a newer version: %0%","server.progress.fixing-workspace.begin":"Fixing all auto-fixable problems in the workspace","server.progress.fixing-workspace.report":"fixing %0%","server.progress.preparing.title":"Preparing Spyglass language features","server.remove-cache-file":"The cache file of DHP was moved to a storage location provided by VSCode. You can safely delete the ugly \u201C.datapack\u201D folder in your workspace root.","server.show-release-notes":"Show Release Notes",string:"a string",tag:"a tag","tag-not-following-convention":"Invalid tag %0% which doesn't follow %1% convention",team:"a team","team-not-following-convention":"Invalid team %0% which doesn't follow %1% convention","time-unit":"a time unit","too-many-block-affected":"Too many blocks in the specified area (maximum %0%, specified %1%)","too-many-chunk-affected":"Too many chunks in the specified area (maximum %0%, specified %1%)","unexpected-character":"Found non [a-z0-9/._-] character(s)","unexpected-datapack-tag":"Tags are not allowed here","unexpected-default-namespace":"Default namespace should be omitted here","unexpected-leading-slash":"Unexpected leading slash \u201C/\u201D","unexpected-local-coordinate":"Local coordinate %0% is not allowed","unexpected-nbt":"This tag doesn't exist here","unexpected-nbt-array-type":"Invalid array type %0%. Should be one of \u201CB\u201D, \u201CI\u201D, and \u201CL\u201D","unexpected-nbt-path-filter":"Compound filters are only used for compound tags","unexpected-nbt-path-index":"Indices are only used for lists/arrays tags","unexpected-nbt-path-key":"Keys are only used for compound tags","unexpected-nbt-path-sub":"The current tag doesn't have extra items","unexpected-omitted-default-namespace":"Default namespace shouldn't be omitted here","unexpected-relative-coordinate":"Relative coordinate %0% is not allowed","unexpected-scoreboard-sub-slot":"Only \u201Csidebar\u201D has sub slots","unknown-command":"Unknown command %0%","unknown-escape":"Unexpected escape character %0%","unknown-key":"Unknown key %0%","unquoted-string":"an unquoted string","unsorted-keys":"Unsorted keys",uuid:"a UUID",vector:"a vector"};var Gu={en:Ku},ug="en";function h(e,...t){let r=Gu[ug][e]??Gu.en[e];return fg(r,t)??""}function D(e){return h("punc.quote",e)}function fg(e,t){return e?.replace(/%\d+%/g,r=>{let n=parseInt(r.slice(1,-1)),i=t[n];return typeof i!="string"&&i[Symbol.iterator]&&(i=cr(i)),`${i??r}`})}function cr(e,t=!0,r="or"){let n=o=>t?D(o):o,i=(typeof e=="string"?[e]:Array.from(e)).map(n);switch(i.length){case 0:return h("nothing");case 1:return i[0];case 2:return i[0]+h(`conjunction.${r}_2`)+i[1];default:return`${i.slice(0,-1).join(h(`conjunction.${r}_3+_1`))}${h(`conjunction.${r}_3+_2`)}${i[i.length-1]}`}}function Ee(...e){let t=pg(e);return(r,n)=>{let i={type:"literal",range:y.create(r),options:t,value:""};for(let o of t.pool)if(r.trySkip(o))return i.value=o,i.range.end=r.cursor,i;return n.err.report(h("expected",t.pool),i),i}}function pg(e){let t;return typeof e[0]=="object"?t=e[0]:t={pool:e},t.pool=t.pool.sort((r,n)=>n.length-r.length),t}var lc=Vt(pa(),1);var uc=Object.freeze(["mcdoc","mcdoc/dispatcher"]),lr=Object.freeze(["activity","attribute","block","block_entity_type","block_predicate_type","chunk_status","custom_stat","enchantment","entity_type","float_provider_type","fluid","game_event","height_provider_type","int_provider_type","item","loot_condition_type","loot_function_type","loot_nbt_provider_type","loot_number_provider_type","loot_pool_entry_type","loot_score_provider_type","memory_module_type","menu","mob_effect","motive","particle_type","point_of_interest_type","pos_rule_test","position_source_type","potion","recipe_serializer","recipe_type","rule_test","schedule","sensor_type","sound_event","stat_type","villager_profession","villager_type","worldgen/biome_source","worldgen/block_placer_type","worldgen/block_state_provider_type","worldgen/carver","worldgen/chunk_generator","worldgen/decorator","worldgen/feature","worldgen/feature_size_type","worldgen/foliage_placer_type","worldgen/material_condition","worldgen/material_rule","worldgen/placement_modifier_type","worldgen/structure_feature","worldgen/structure_piece","worldgen/structure_pool_element","worldgen/structure_processor","worldgen/surface_builder","worldgen/tree_decorator_type","worldgen/trunk_placer_type"]),Xu=Object.freeze(["worldgen/biome","worldgen/configured_carver","worldgen/configured_feature","worldgen/configured_structure_feature","worldgen/configured_surface_builder","worldgen/noise","worldgen/noise_settings","worldgen/placed_feature","worldgen/processor_list","worldgen/template_pool"]),dg=Object.freeze(["function",...lr,...Xu]),mg=Object.freeze(dg.map(e=>`tag/${e}`)),qn=Object.freeze(["advancement","dimension","dimension_type","function","item_modifier","loot_table","predicate","recipe","structure",...mg,...Xu]),hg=Object.freeze(["attribute_modifier_uuid","bossbar","objective","score_holder","storage","tag","team"]),gg=Object.freeze([...qn,...hg]),Ow=Object.freeze([...gg,...uc,...lr]),_g=Object.freeze(["bossbar","storage","mcdoc/dispatcher",...qn,...lr]),Wu;(function(e){function t(r){return _g.includes(r)}e.is=t})(Wu||(Wu={}));var nt;(function(e){function t(i){return i?{category:i.category,path:i.path}:void 0}e.fromSymbol=t;function r(i){return JSON.stringify({category:i.category,path:i.path})}e.toString=r;function n(i){return JSON.parse(i)}e.fromString=n})(nt||(nt={}));var Vn,Ju=class{constructor(){P(this,Vn,new Set)}add(t){!t||g(this,Vn).add(nt.toString(t))}has(t){return g(this,Vn).has(nt.toString(t))}collect(){return[...g(this,Vn)].map(nt.fromString)}};Vn=new WeakMap;var cn=Object.freeze(["definition","declaration","implementation","reference","typeDefinition"]),Di;(function(e){function t(r){return cn.includes(r)}e.is=t})(Di||(Di={}));var Yu;(function(e){function t(r,n,...i){if(Uu(r)){for(let a of r){let s=t(a,n,...i);if(s)return s}return}let o=r[n];for(let a of i);}e.get=t})(Yu||(Yu={}));var ba;(function(e){function t(r,n,i,o,a){return k(k(k(k({},ma.create(r,n)),i?{fullRange:y.get(i),fullPosRange:Fn.from(i,r)}:{}),o?{contributor:o}:{}),a||{})}e.create=t})(ba||(ba={}));var Mi;(function(e){function t(o){let a=(c,u,p,d,m)=>{c.category=d,c.identifier=m[m.length-1],c.path=m,c.parentMap=u,p&&(c.parentSymbol=p),c.members&&s(c.members,c,d,m)},s=(c,u,p,d)=>{for(let[m,_]of Object.entries(c))a(_,c,u,p,[...d,m])},l=(0,lc.default)()(o);for(let[c,u]of Object.entries(l))s(u,void 0,c,[]);return l}e.link=t;function r(o){let a=c=>{delete c.category,delete c.identifier,delete c.parentMap,delete c.parentSymbol,delete c.path,c.members&&s(c.members)},s=c=>{for(let u of Object.values(c))a(u)},l=(0,lc.default)({circles:!0})(o);for(let c of Object.values(l))s(c);return l}e.unlink=r;function n(o){return JSON.stringify(r(o))}e.serialize=n;function i(o){return t(JSON.parse(o))}e.deserialize=i})(Mi||(Mi={}));var ef=Vt(va(),1);var xa=function(e,t,r,n){var i=arguments.length,o=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},xr,ln,Fi,Sr,un,St,ut=class{constructor(t,r,n,i=!1){P(this,xr,void 0);P(this,ln,void 0);P(this,Fi,void 0);P(this,Sr,new Set);P(this,un,Object.create(null));P(this,St,void 0);re(this,"_delayedOps",[]);re(this,"_inDelayMode");U(this,ln,new r),U(this,Fi,r),U(this,xr,t),U(this,St,n),this._inDelayMode=i,this.on("symbolCreated",({symbol:o})=>{g(this,Sr).add(nt.toString(o))}).on("symbolRemoved",({symbol:o})=>{g(this,Sr).delete(nt.toString(o))}).on("symbolLocationCreated",({symbol:o,location:a})=>{let s=g(this,un)[a.contributor??"undefined"]??=Object.create(null),l=s[a.uri]??=new Set,c=nt.toString(o);l.add(c),g(this,Sr).delete(c)}).on("symbolLocationRemoved",({symbol:o})=>{let a=nt.toString(o);g(this,Sr).add(a)})}get global(){return g(this,xr)}on(t,r){return g(this,ln).on(t,r),this}once(t,r){return g(this,ln).once(t,r),this}emit(t,...r){return g(this,ln).emit(t,...r)}buildCache(){ut.forEachSymbol(this.global,t=>{this.emit("symbolCreated",{symbol:t}),ut.forEachLocationOfSymbol(t,({type:r,location:n})=>{this.emit("symbolLocationCreated",{symbol:t,type:r,location:n})})})}clone(){return new ut(g(this,xr),g(this,Fi),g(this,St),!0)}applyDelayedEdits(){this._delayedOps.forEach(t=>t()),this._delayedOps=[],this._inDelayMode=!1}contributeAs(t,r){let n=g(this,St);U(this,St,t);try{r()}finally{U(this,St,n)}return this}async contributeAsAsync(t,r){let n=g(this,St);U(this,St,t);try{await r()}finally{U(this,St,n)}return this}clear({uri:t,contributor:r,predicate:n=()=>!0}){let i=()=>r?g(this,un)[r]?[g(this,un)[r]]:[]:Object.values(g(this,un)),o=()=>{let c=i();return(t?c.map(p=>p[t]??new Set):c.map(p=>Object.values(p)).flat()).map(p=>[...p]).flat().map(nt.fromString)},a=()=>t?[g(this,xr)]:[g(this,xr)],s=o(),l=a();for(let c of l){for(let u of s){let{symbol:p}=ut.lookupTable(c,u.category,u.path);!p||this.removeLocationsFromSymbol(p,t?d=>d.location.uri===t&&n(d):n)}this.trim(c)}}lookup(t,r,n){return ut.lookupTable(this.global,t,r)}query(t,r,...n){let i=ut.toUri(t),{parentSymbol:o,parentMap:a,symbol:s}=this.lookup(r,n,dc(t)?t.node:void 0),l=s?ut.isVisible(s,i):!0;return new wa({category:r,doc:t,contributor:g(this,St),map:l?a:void 0,parentSymbol:o,path:n,symbol:l?s:void 0,util:this})}getVisibleSymbols(t,r){let n=this.lookup(t,[],void 0).parentMap??void 0;return ut.filterVisibleSymbols(r,n)}static toUri(t){return typeof t=="string"?t:dc(t)?t.doc.uri:t.uri}trim(t){let r=n=>{!n||ut.isTrimmable(n)&&(delete n.parentMap[n.identifier],this.emit("symbolRemoved",{symbol:n}),r(n.parentSymbol))};for(let n of g(this,Sr)){let i=nt.fromString(n),{symbol:o}=ut.lookupTable(t,i.category,i.path);r(o)}}removeLocationsFromSymbol(t,r){for(let n of cn)!t[n]||(t[n]=t[n].reduce((i,o)=>(r({location:o,symbol:t,type:n})?this.emit("symbolLocationRemoved",{symbol:t,type:n,location:o}):i.push(o),i),[]))}enterMap(t,r,n,i,o,a,s,l){let c=r[o];return c?this.amendSymbol(c,a,s,l):c=this.createSymbol(n,t,r,i,o,a,s,l),this.emit("symbolAmended",{symbol:c}),c}static lookupTable(t,r,n){let i=t[r],o,a;for(let s=0;s<n.length;s++){if(a=i?.[n[s]],!a){s!==n.length-1&&(o=void 0,i=void 0);break}if(s===n.length-1)break;o=a,i=a.members}return{parentSymbol:o,parentMap:i,symbol:a}}static lookupTables(t,r,n){let i,o;for(let a=t.length-1;a>=0;a--){let s=t[a],l=this.lookupTable(s,r,n);if(l.symbol)return l;!o&&!i&&(l.parentSymbol||l.parentMap)&&(o=l.parentSymbol,i=l.parentMap)}return{parentSymbol:o,parentMap:i,symbol:void 0}}createSymbol(t,r,n,i,o,a,s,l){let c=n[o]=k(O(k({category:t,identifier:o},r?{parentSymbol:r}:{}),{parentMap:n,path:i}),a.data);return this.emit("symbolCreated",{symbol:c}),this.amendSymbolUsage(c,a.usage,s,l),c}amendSymbol(t,r,n,i){this.amendSymbolMetadata(t,r.data),this.amendSymbolUsage(t,r.usage,n,i)}amendSymbolMetadata(t,r){if(r){if("data"in r&&(t.data=r.data),"desc"in r&&(t.desc=r.desc),r.relations&&Object.keys(r.relations).length){t.relations??={};for(let n of Object.keys(r.relations))t.relations[n]=r.relations[n]}if("subcategory"in r&&(t.subcategory=r.subcategory),"visibility"in r){let n=i=>i===void 0||i===2||i===3;if(t.visibility===r.visibility||n(t.visibility)&&n(r.visibility))t.visibility=r.visibility;else throw new Error(`Cannot change visibility from ${t.visibility} to ${r.visibility}: ${JSON.stringify(nt.fromSymbol(t))}`)}r.visibilityRestriction?.length&&(t.visibilityRestriction=(t.visibilityRestriction??[]).concat(r.visibilityRestriction))}}amendSymbolUsage(t,r,n,i){if(r){let o=r.type??"reference",a=t[o]??=[],s=y.get((pc.is(r)?r.node:r.range)??0),l=ba.create(n,s,r.fullRange,i,{accessType:r.accessType,skipRenaming:r.skipRenaming});n.uri.startsWith("file:")||(delete l.range,delete l.posRange,delete l.fullRange,delete l.fullPosRange),a.push(l),this.emit("symbolLocationCreated",{symbol:t,type:o,location:l})}}resolveAlias(t){return t?.relations?.aliasOf?this.resolveAlias(this.lookup(t.relations.aliasOf.category,t.relations.aliasOf.path).symbol):t}static filterVisibleSymbols(t,r={}){let n={};for(let[i,o]of Object.entries(r))ut.isVisible(o,t)&&(n[i]=o);return n}static isTrimmable(t){return!Object.keys(t.members??{}).length&&!t.declaration?.length&&!t.definition?.length&&!t.implementation?.length&&!t.reference?.length&&!t.typeDefinition?.length}static isVisible(t,r){switch(t.visibility){case 3:return!1;case 0:case 1:case 2:default:return!0}}static isDeclared(t){return!!(t?.declaration?.length||t?.definition?.length)}static isDefined(t){return!!(t?.definition?.length||t?.definition?.length&&t?.implementation?.length)}static isImplemented(t){return!!(t?.implementation?.length||t?.definition?.length)}static isReferenced(t){return!!t?.reference?.length}static isTypeDefined(t){return!!t?.typeDefinition?.length}static getDeclaredLocation(t){return t.declaration?.[0]??t.definition?.[0]??(()=>{throw new Error(`Cannot get declared location of ${JSON.stringify(nt.fromSymbol(t))}`)})()}static forEachSymbolInMap(t,r){for(let n of Object.values(t))r(n),n.members&&this.forEachSymbolInMap(n.members,r)}static forEachSymbol(t,r){for(let n of Object.values(t))this.forEachSymbolInMap(n,r)}static forEachLocationOfSymbol(t,r){for(let n of cn)t[n]?.forEach(i=>r({type:n,location:i}))}static isVisibilityInGlobal(t){return t===void 0||t===2||t===3}static areVisibilitiesCompatible(t,r){return this.isVisibilityInGlobal(t)&&this.isVisibilityInGlobal(r)||t===0&&r===0||t===1&&r===1}},Ae=ut;xr=new WeakMap,ln=new WeakMap,Fi=new WeakMap,Sr=new WeakMap,un=new WeakMap,St=new WeakMap;xa([Sa()],Ae.prototype,"clear",null);xa([Sa()],Ae.prototype,"trim",null);xa([Sa()],Ae.prototype,"removeLocationsFromSymbol",null);var fc;(function(e){function t(r){return!!r?.range}e.is=t})(fc||(fc={}));var pc;(function(e){function t(r){return!!r?.node}e.is=t})(pc||(pc={}));var Zt,Cr,fn,Zn,Ui,Ht,ur,ze,mc=class{constructor({category:t,contributor:r,doc:n,map:i,parentSymbol:o,path:a,symbol:s,util:l}){re(this,"category");re(this,"path");P(this,Zt,void 0);P(this,Cr,void 0);P(this,fn,void 0);P(this,Zn,void 0);P(this,Ui,!1);P(this,Ht,void 0);P(this,ur,void 0);P(this,ze,void 0);re(this,"util");this.category=t,this.path=a,typeof n=="string"?(n=ef.TextDocument.create(n,"",0,""),U(this,fn,!0)):dc(n)&&(U(this,Cr,n.node),n=n.doc),U(this,Zt,n),U(this,Zn,r),U(this,Ht,i),U(this,ur,o),U(this,ze,s),this.util=l}get symbol(){return g(this,ze)}get visibleMembers(){return Ae.filterVisibleSymbols(g(this,Zt).uri,this.path.length===0?g(this,Ht):g(this,ze)?.members)}heyGimmeDaSymbol(){return g(this,ze)}with(t){return t(this),this}if(t,r){return t.call(this,g(this,ze),this)&&(r.call(this,g(this,ze),this),U(this,Ui,!0)),this}ifUnknown(t){return this.if(r=>r===void 0,t)}ifKnown(t){return this.if(r=>r!==void 0,t)}ifDeclared(t){return this.if(r=>Ae.isDeclared(r),t)}ifDefined(t){return this.if(Ae.isDefined,t)}ifImplemented(t){return this.if(Ae.isImplemented,t)}ifReferenced(t){return this.if(Ae.isReferenced,t)}ifTypeDefined(t){return this.if(Ae.isTypeDefined,t)}else(t){return g(this,Ui)||t.call(this,g(this,ze),this),this}elseEnter(t){return this.else(()=>this.enter(t))}elseResolveAlias(){return this.else(()=>this.resolveAlias())}_enter(t){let r=n=>{if(g(this,Ht)&&Ae.areVisibilitiesCompatible(n.data?.visibility,g(this,ze)?.visibility))return g(this,Ht);if(this.path.length>1){if(g(this,ur)){if(!Ae.areVisibilitiesCompatible(n.data?.visibility,g(this,ur).visibility))throw new Error(`Cannot enter member \u201C${this.getPath()}\u201D of ${wr.stringifyVisibility(n.data?.visibility)} visibility to parent of ${wr.stringifyVisibility(g(this,ur).visibility)} visibility`);return g(this,ur).members??={}}}else{let i;if(Ae.isVisibilityInGlobal(n.data?.visibility))i=this.util.global;else if(n.data?.visibility===1){if(!g(this,Cr))throw new Error(`Cannot enter \u201C${this.getPath()}\u201D with ${wr.stringifyVisibility(n.data?.visibility)} visibility as no node is supplied`);let o=g(this,Cr);for(;o;){if(o.type==="file"){i=o.locals;break}o=o.parent}if(!i)throw new Error(`Cannot enter \u201C${this.getPath()}\u201D with ${wr.stringifyVisibility(n.data?.visibility)} visibility as no file node is supplied`)}else{if(!g(this,Cr))throw new Error(`Cannot enter \u201C${this.getPath()}\u201D with ${wr.stringifyVisibility(n.data?.visibility)} visibility as no node is supplied`);let o=g(this,Cr);for(;o;){if(o.locals){i=o.locals;break}o=o.parent}if(!i)throw new Error(`Cannot enter \u201C${this.getPath()}\u201D with ${wr.stringifyVisibility(n.data?.visibility)} visibility as no node with locals is supplied`)}return i[this.category]??={}}throw new Error(`Cannot create the symbol map for \u201C${this.getPath()}\u201D`)};g(this,fn)&&fc.is(t.usage)&&(t.usage.range=y.create(0,0)),U(this,Ht,r(t)),U(this,ze,this.util.enterMap(g(this,ur),g(this,Ht),this.category,this.path,this.path[this.path.length-1],t,g(this,Zt),g(this,Zn))),t.usage?.node&&(t.usage.node.symbol=g(this,ze))}enter(t){return this._enter(t),this}amend(t){return this.ifKnown(()=>this.enter(t))}resolveAlias(){if(g(this,ze)){let t=this.util.resolveAlias(g(this,ze));if(!t)throw new Error("The current symbol points to an non-existent symbol.");U(this,ze,t),U(this,Ht,t.parentMap)}return this}member(){let t,r,n;if(arguments.length===2?(t=g(this,fn)?g(this,Zt).uri:g(this,Zt),r=arguments[0],n=arguments[1]):(t=arguments[0],r=arguments[1],n=arguments[2]),g(this,ze)===void 0)throw new Error(`Tried to query member symbol \u201C${r}\u201D from an undefined symbol (path \u201C${this.path.join(".")}\u201D)`);let i=typeof t=="string"&&t===g(this,Zt).uri&&!g(this,fn)?g(this,Zt):t,o=g(this,ze).members,a=o?.[r],s=new mc({category:this.category,doc:i,contributor:g(this,Zn),map:o,parentSymbol:g(this,ze),path:[...this.path,r],symbol:a,util:this.util});return n(s),this}onEach(t,r){for(let n of t)r.call(this,n,this);return this}forEachMember(t){return this.onEach(Object.keys(this.visibleMembers),r=>this.member(r,n=>t(r,n)))}getPath(){return`${this.category}.${this.path.join("/")}`}},wa=mc;Zt=new WeakMap,Cr=new WeakMap,fn=new WeakMap,Zn=new WeakMap,Ui=new WeakMap,Ht=new WeakMap,ur=new WeakMap,ze=new WeakMap;xa([Sa(e=>e.util)],wa.prototype,"_enter",null);var wr;(function(e){let t="+ ";function r(c,u){if(c!==u)throw new Error(`Assertion error: ${c} !== ${u}`)}function n(c){return c.map(u=>i(u)).join(`
------------
`)}e.stringifySymbolStack=n;function i(c,u=""){let p=[];for(let d of Object.keys(c)){let m=c[d];p.push([d,o(m,`${u}${t}`)])}return p.map(d=>`CATEGORY ${d[0]}
${d[1]}`).join(`
${u}------------
`)||"EMPTY TABLE"}e.stringifySymbolTable=i;function o(c,u=""){if(!c)return"undefined";let p=[];for(let d of Object.keys(c)){let m=c[d];r(d,m.identifier),p.push(a(m,u))}return p.join(`
${u}------------
`)}e.stringifySymbolMap=o;function a(c,u=""){if(!c)return"undefined";let p=[];r(c.path[c.path.length-1],c.identifier),p.push(`SYMBOL ${c.path.join(".")} {${c.category}${c.subcategory?` (${c.subcategory})`:""}} [${s(c.visibility,c.visibilityRestriction)}]`),c.data&&p.push(`${t}data: ${JSON.stringify(c.data)}`),c.desc&&p.push(`${t}description: ${c.desc}`);for(let d of cn)c[d]&&p.push(`${t}${d}:
${c[d].map(m=>`${u}${t.repeat(2)}${JSON.stringify(m)}`).join(`
${u}${t.repeat(2)}------------
`)}`);return c.relations&&p.push(`${t}relations: ${JSON.stringify(c.relations)}`),c.members&&p.push(`${t}members:
${o(c.members,`${u}${t.repeat(2)}`)}`),p.map(d=>`${u}${d}`).join(`
`)}e.stringifySymbol=a;function s(c,u){let p;switch(c){case 0:p="Block";break;case 1:p="File";break;case 3:p="Restricted";break;default:p="Public";break}return`${p}${u?` ${u.map(d=>`\u201C${d}\u201D`).join(", ")}`:""}`}e.stringifyVisibility=s;function l(c){return`parentSymbol:
${a(c.parentSymbol,t)}
parentMap:
${o(c.parentMap,t)}
symbol:
${a(c.symbol,t)}`}e.stringifyLookupResult=l})(wr||(wr={}));function Sa(e=t=>t){return(t,r,n)=>{let i=n.value;return n.value=function(...o){let a=e(this);a._inDelayMode?a._delayedOps.push(i.bind(this,...o)):i.apply(this,o)},n}}function dc(e){return!!e.doc}var oe;(function(e){function*t(R,A){for(let H of A)R.startsWith(H)&&(yield decodeURIComponent(R.slice(H.length)))}e.getRels=t;function r(R,A){return t(R,A).next().value}e.getRel=r;function n(R){return R.endsWith("/")}e.isRootUri=n;function i(R){return n(R)?R:`${R}/`}e.ensureEndingSlash=i;function o(R,A){return i(R)+(A.startsWith("/")?A.slice(1):A)}e.join=o;function a(R){return R.startsWith("file:")}e.isFileUri=a;function s(R){let A=R.lastIndexOf(".");return A>=0?R.slice(A):void 0}e.extname=s;function l(R){let A=R.lastIndexOf("/");return A>=0?R.slice(A+1):R}e.basename=l;function c(R,A){return new rt(".",A)}e.getParentOfFile=c;async function u(R,A,H=511){try{await R.fs.mkdir(A,{mode:H,recursive:!0})}catch(Y){if(!R.error.isKind(Y,"EEXIST"))throw Y}}e.ensureDir=u;async function p(R,A,H=511){return u(R,c(R,A),H)}e.ensureParentOfFile=p;async function d(R,A,H){return R.fs.chmod(A,H)}e.chmod=d;async function m(R,A){try{await d(R,A,438)}catch(H){if(!R.error.isKind(H,"ENOENT"))throw H}}e.ensureWritable=m;async function _(R,A){return d(R,A,292)}e.markReadOnly=_;async function T(R,A){return R.fs.readFile(A)}e.readFile=T;async function b(R,A,H,Y=438){return await p(R,A),await m(R,A),R.fs.writeFile(A,H,{mode:Y})}e.writeFile=b;async function S(R,A){return JSON.parse(wt(await T(R,A)))}e.readJson=S;async function z(R,A,H){return b(R,A,JSON.stringify(H))}e.writeJson=z;async function q(R,A){return R.archive.gunzip(await T(R,A))}e.readGzippedFile=q;async function $(R,A,H){return typeof H=="string"&&(H=new TextEncoder().encode(H)),b(R,A,await R.archive.gzip(H))}e.writeGzippedFile=$;async function J(R,A){return JSON.parse(wt(await q(R,A)))}e.readGzippedJson=J;async function pe(R,A,H){return $(R,A,JSON.stringify(H))}e.writeGzippedJson=pe})(oe||(oe={}));var hc=1,Ca;(function(e){function t(){return{files:{},roots:{},symbolRegistrars:{}}}e.create=t})(Ca||(Ca={}));var Hn,Ra,Na=class{constructor(t,r){re(this,"cacheRoot");re(this,"project");re(this,"checksums",Ca.create());P(this,Hn,!1);P(this,Ra,void 0);this.cacheRoot=t,this.project=r,this.project.on("documentUpdated",async({doc:n})=>{if(!!g(this,Hn))try{this.checksums.files[n.uri]=await this.project.externals.crypto.getSha1(n.getText())}catch(i){this.project.externals.error.isKind(i,"EISDIR")||this.project.logger.error(`[CacheService#hash-file] ${n.uri}`)}}),this.project.on("rootsUpdated",async({roots:n})=>{if(!!g(this,Hn))for(let i of n)try{this.checksums.roots[i]=await this.project.fs.hash(i)}catch(o){this.project.externals.error.isKind(o,"EISDIR")||this.project.logger.error(`[CacheService#hash-root] ${i}`)}}),this.project.on("symbolRegistrarExecuted",({id:n,checksum:i})=>{i!==void 0&&(this.checksums.symbolRegistrars[n]=i)})}async getCacheFileUri(){return g(this,Ra)??U(this,Ra,new rt(`symbols/${await this.project.externals.crypto.getSha1(this.project.projectRoot)}.json.gz`,this.cacheRoot).toString())}async load(){let t=this.project.profilers.get("cache#load"),r={symbols:{}},n;try{n=await this.getCacheFileUri(),this.project.logger.info(`[CacheService#load] symbolCachePath = \u201C${n}\u201D`);let i=await oe.readGzippedJson(this.project.externals,n);t.task("Read File"),i.version===hc?(this.checksums=i.checksums,r.symbols=Mi.link(i.symbols),t.task("Link Symbols")):this.project.logger.info(`[CacheService#load] Unsupported cache format ${i.version}; expected ${hc}`)}catch(i){this.project.externals.error.isKind(i,"ENOENT")||this.project.logger.error("[CacheService#load] ",i)}return t.finalize(),r}async validate(){let t={addedFiles:[],changedFiles:[],removedFiles:[],unchangedFiles:[]},r=[];for(let[n,i]of Object.entries(this.checksums.roots))try{await this.project.fs.hash(n)===i&&r.push(n)}catch(o){this.project.externals.error.isKind(o,"EISDIR")||this.project.logger.error(`[CacheService#hash-file] ${n}`)}for(let[n,i]of Object.entries(this.checksums.files)){if(r.some(o=>n.startsWith(o))){t.unchangedFiles.push(n);continue}try{await this.project.fs.hash(n)===i?t.unchangedFiles.push(n):t.changedFiles.push(n)}catch(o){this.project.externals.error.isKind(o,"ENOENT")||this.project.externals.error.isKind(o,"EISDIR")?t.removedFiles.push(n):(this.project.logger.error(`[CacheService#validate] ${n}`,o),t.changedFiles.push(n))}}for(let n of this.project.getTrackedFiles())n in this.checksums.files||t.addedFiles.push(n);return U(this,Hn,!0),t}async save(){let t=this.project.profilers.get("cache#save"),r;try{r=await this.getCacheFileUri();let n={checksums:this.checksums,projectRoot:this.project.projectRoot,symbols:Mi.unlink(this.project.symbols.global),version:hc};return t.task("Unlink Symbols"),await oe.writeGzippedJson(this.project.externals,r,n),t.task("Write File").finalize(),!0}catch(n){this.project.logger.error(`[CacheService#save] path = \u201C${r}\u201D`,n)}return!1}reset(){this.checksums=Ca.create()}};Hn=new WeakMap,Ra=new WeakMap;var tf=Vt(pa(),1);var Nr;(function(e){function t(n){return n==="hint"||n==="information"||n==="warning"||n==="error"}e.is=t;function r(n){switch(n){case"error":return 3;case"hint":return 0;case"information":return 1;case"warning":return 2}}e.toErrorSeverity=r})(Nr||(Nr={}));var Gn;(function(e){function t(r){if(r!=null)return Nr.is(r)?{ruleSeverity:Nr.toErrorSeverity(r),ruleValue:!0}:Array.isArray(r)&&Nr.is(r[0])?{ruleSeverity:Nr.toErrorSeverity(r[0]),ruleValue:r[1]}:{ruleSeverity:2,ruleValue:r}}e.destruct=t})(Gn||(Gn={}));var Rr;(function(e){function t(o){return ye.is(o,r.is)||i.is(o)}e.is=t;let r;(function(o){function a(s){if(!s||typeof s!="object")return!1;let l=s;return(l.if===void 0||ye.is(l.if,n.is))&&(l.then===void 0||i.is(l.then))&&(l.override===void 0||ye.is(l.override,o.is))}o.is=a})(r=e.Complex||(e.Complex={}));let n;(function(o){function a(s){if(!s||typeof s!="object")return!1;let l=s;return(l.category===void 0||ye.is(l.category,kr.isString))&&(l.pattern===void 0||ye.is(l.pattern,kr.isString))&&(l.excludePattern===void 0||ye.is(l.excludePattern,kr.isString))&&(l.namespace===void 0||ye.is(l.namespace,kr.isString))&&(l.excludeNamespace===void 0||ye.is(l.excludeNamespace,kr.isString))}o.is=a})(n=e.Condition||(e.Condition={}));let i;(function(o){function a(c){return c!==void 0&&["block","file","public"].includes(c.declare)}o.isDeclare=a;function s(c){return c!==void 0&&["inherit","hint","information","warning","error"].includes(c.report)}o.isReport=s;function l(c){if(!c||typeof c!="object")return!1;let u=c;return a(u)||s(u)}o.is=l})(i=e.Action||(e.Action={}))})(Rr||(Rr={}));var gc={env:{dataSource:"GitHub",dependencies:["@vanilla-mcdoc"],feature:{codeActions:!0,colors:!0,completions:!0,documentHighlighting:!0,documentLinks:!0,foldingRanges:!0,formatting:!0,hover:!0,inlayHint:{enabledNodes:["mcfunction:command_child/unknown"]},semanticColoring:!0,selectionRanges:!0,signatures:!0},gameVersion:"Auto",language:"Default",permissionLevel:2,plugins:[],mcmetaSummaryOverrides:{}},format:{blockStateBracketSpacing:{inside:0},blockStateCommaSpacing:{before:0,after:1},blockStateEqualSpacing:{before:0,after:0},blockStateTrailingComma:!1,eol:"auto",nbtArrayBracketSpacing:{inside:0},nbtArrayCommaSpacing:{before:0,after:1},nbtArraySemicolonSpacing:{after:1},nbtArrayTrailingComma:!1,nbtByteSuffix:"b",nbtCompoundBracketSpacing:{inside:0},nbtCompoundColonSpacing:{before:0,after:1},nbtCompoundCommaSpacing:{before:0,after:1},nbtCompoundTrailingComma:!1,nbtDoubleOmitSuffix:!1,nbtDoubleSuffix:"d",nbtFloatSuffix:"f",nbtListBracketSpacing:{inside:0},nbtListCommaSpacing:{before:0,after:1},nbtListTrailingComma:!1,nbtLongSuffix:"L",nbtShortSuffix:"s",selectorBracketSpacing:{inside:0},selectorCommaSpacing:{before:0,after:1},selectorEqualSpacing:{before:0,after:0},selectorTrailingComma:!1,timeOmitTickUnit:!1},lint:{blockStateSortKeys:null,nbtCompoundSortKeys:null,selectorSortKeys:null,commandStringQuote:null,nbtKeyQuote:null,nbtPathQuote:null,nbtStringQuote:null,selectorKeyQuote:null,idOmitDefaultNamespace:null,nameOfNbtKey:null,nameOfObjective:null,nameOfScoreHolder:null,nameOfTag:null,nameOfTeam:null,nbtArrayLengthCheck:!0,nbtBoolean:null,nbtListLengthCheck:null,nbtTypeCheck:"loosely",undeclaredSymbol:[{if:[{category:lr,namespace:"minecraft"},{category:[...qn,"bossbar","objective","team"]}],then:{report:"warning"}},{then:{declare:"block"}}]},snippet:{executeIfScoreSet:"execute if score ${1:score_holder} ${2:objective} = ${1:score_holder} ${2:objective} $0",summonAec:'summon minecraft:area_effect_cloud ~ ~ ~ {Age: -2147483648, Duration: -1, WaitTime: -2147483648, Tags: ["${1:tag}"]}'}},pn,Kn=class{constructor(t,r=gc){re(this,"project");re(this,"defaultConfig");P(this,pn,void 0);this.project=t,this.defaultConfig=r,U(this,pn,new t.externals.event.EventEmitter);let n=async({uri:i})=>{Kn.isConfigFile(i)&&this.emit("changed",{config:await this.load()})};t.on("fileCreated",n),t.on("fileModified",n),t.on("fileDeleted",n)}on(t,r){return g(this,pn).on(t,r),this}once(t,r){return g(this,pn).once(t,r),this}emit(t,...r){return g(this,pn).emit(t,...r)}async load(){let t=this.defaultConfig;for(let r of Kn.ConfigFileNames){let n=this.project.projectRoot+r;try{t=JSON.parse(wt(await this.project.externals.fs.readFile(n)))}catch(i){if(this.project.externals.error.isKind(i,"ENOENT"))continue;this.emit("error",{error:i,uri:n})}break}return Kn.merge(this.defaultConfig,t)}static isConfigFile(t){return Kn.ConfigFileNames.some(r=>t.endsWith(`/${r}`))}static merge(t,...r){let n=(0,tf.default)()(t);for(let i of r)for(let o of["env","format","lint","snippet"])n[o]=k(k({},n[o]),i[o]);return n}},dn=Kn;pn=new WeakMap,re(dn,"ConfigFileNames",Object.freeze(["spyglass.json",".spyglassrc.json"]));var it={};ar(it,{any:()=>yg,attempt:()=>nf,dispatchSync:()=>vg,fallback:()=>kg,noop:()=>bg,registerCheckers:()=>wg,resourceLocation:()=>of,symbol:()=>af});function Kt(e,t,r,n){rf(e,t,r,n,[])}function rf(e,t,r,n,i){if(r(e,i)&&n(e,i),!(!e.children||!t(e,i)))for(let o of e.children??[])i.unshift(e),rf(o,t,r,n,i),i.shift()}function nf(e,t,r){let n=O(k({},r),{err:new ft,ops:new Tr,symbols:r.symbols.clone()});e(t,n),n.ops.undo();let i=n.err.errors.map(o=>o.range.end-o.range.start).reduce((o,a)=>o+a,0);return{errorAmount:n.err.errors.length,totalErrorSpan:i,updateNodeAndCtx:()=>{r.err.absorb(n.err),n.ops.redo(),n.symbols.applyDelayedEdits()}}}function yg(e){if(e.length===0)throw new Error("Expected at least one checker");return(t,r)=>{e.map(i=>nf(i,t,r)).sort((i,o)=>i.errorAmount-o.errorAmount||i.totalErrorSpan-o.totalErrorSpan)[0].updateNodeAndCtx()}}var bg=()=>{},kg=async(e,t)=>{let r=[];Kt(e,n=>!t.meta.hasChecker(n.type),n=>t.meta.hasChecker(n.type),n=>{let o=t.meta.getChecker(n.type)(n,t);o instanceof Promise&&r.push(o)}),await Promise.allSettled(r)},vg=(e,t)=>{for(let r of e.children??[])t.meta.hasChecker(r.type)&&t.meta.getChecker(r.type)(r,t)},of=(e,t)=>{let r=Q.toString(e,"full");if(e.options.pool){e.options.pool.includes(r)||t.err.report(h("expected",e.options.pool),e,3);return}},af=(e,t)=>{};function wg(e){e.registerChecker("resource_location",of),e.registerChecker("symbol",af)}var Ue;(function(e){e.NamedColors=new Map([["aqua",5636095],["black",0],["blue",5592575],["dark_aqua",43690],["dark_blue",170],["dark_gray",5592405],["dark_green",43520],["dark_purple",11141290],["dark_red",11141120],["gold",16755200],["gray",11184810],["green",5635925],["light_purple",16733695],["red",16733525],["white",16777215],["yellow",16777045]]),e.ColorNames=[...e.NamedColors.keys()];function t(a,s,l,c){return[a,s,l,c]}e.fromDecRGBA=t;function r(a,s,l){return t(a,s,l,1)}e.fromDecRGB=r;function n(a,s,l,c){return t(a/255,s/255,l/255,c/255)}e.fromIntRGBA=n;function i(a,s,l){return n(a,s,l,255)}e.fromIntRGB=i;function o(a){if(a<0)return r(1,1,1);let s=a%256;a>>=8;let l=a%256;a>>=8;let c=a%256;return i(c,l,s)}e.fromCompositeInt=o})(Ue||(Ue={}));var ot;(function(e){e[e.DecRGBA=0]="DecRGBA",e[e.DecRGB=1]="DecRGB",e[e.IntRGBA=2]="IntRGBA",e[e.IntRGB=3]="IntRGB",e[e.HexRGBA=4]="HexRGBA",e[e.HexRGB=5]="HexRGB",e[e.CompositeInt=6]="CompositeInt"})(ot||(ot={}));var Ta;(function(e){function t(n,i,o){let a=r(n,i);return{label:a,text:a,range:o}}e.fromColorFormat=t;function r(n,i){let o=a=>parseFloat(a.toFixed(3));switch(n){case ot.DecRGBA:return i.map(a=>o(a)).join(" ");case ot.DecRGB:return i.slice(0,3).map(a=>o(a)).join(" ");case ot.IntRGBA:return i.map(a=>Math.round(a*255)).join(" ");case ot.IntRGB:return i.slice(0,3).map(a=>Math.round(a*255)).join(" ");case ot.HexRGBA:return`#${Math.round((i[0]*255<<24)+(i[1]*255<<16)+i[2]*255<<8+i[3]*255).toString(16).padStart(8,"0")}`;case ot.HexRGB:return`#${Math.round((i[0]*255<<16)+(i[1]*255<<8)+i[2]*255).toString(16).padStart(6,"0")}`;case ot.CompositeInt:return`${Math.round((i[0]*255<<16)+(i[1]*255<<8)+i[2]*255)}`}}})(Ta||(Ta={}));var Oe={};ar(Oe,{boolean:()=>sf,comment:()=>cf,error:()=>lf,fallback:()=>xg,literal:()=>uf,number:()=>ja,registerColorizers:()=>Sg,resourceLocation:()=>ff,string:()=>pf,symbol:()=>df});var Ce;(function(e){function t(n,i,o){return{range:y.get(n),type:i,modifiers:o}}e.create=t;function r(n,i,o,a){let s=[],l=Math.min(i.start,n[0]?.range.start??1/0);for(let c of n)c.range.start>l&&s.push(e.create(y.create(l,c.range.start),o,a)),s.push(c),l=c.range.end;return l<i.end&&s.push(e.create(y.create(l,i.end),o,a)),s}e.fillGap=r})(Ce||(Ce={}));var ax=Object.freeze(["comment","enum","enumMember","function","keyword","modifier","number","operator","property","string","struct","type","type","variable","error","literal","operator","resourceLocation","vector"]),sx=Object.freeze(["declaration","defaultLibrary","definition","deprecated","documentation","modification","readonly"]);var xg=(e,t)=>{let r=[];return Kt(e,n=>!t.meta.hasColorizer(n.type)&&(!t.range||y.intersects(n.range,t.range)),n=>t.meta.hasColorizer(n.type),n=>{let o=t.meta.getColorizer(n.type)(n,t);r.push(...o)}),Object.freeze(r)},sf=e=>[Ce.create(e,"literal")],cf=e=>[Ce.create(e,"comment")],lf=e=>[Ce.create(e,"error")],uf=e=>[Ce.create(e,e.options.colorTokenType??"literal")],ja=e=>[Ce.create(e,"number")],ff=(e,t)=>{let r;switch(e.options.category){case"function":case"tag/function":r="function";break;default:r="resourceLocation";break}return[Ce.create(e,r)]},pf=(e,t)=>{if(e.children){let n=t.meta.getColorizer(e.children[0].type)(e.children[0],t);return Ce.fillGap(n,e.range,e.options.colorTokenType??"string")}else return[Ce.create(e,e.options.colorTokenType??"string")]},df=e=>[Ce.create(e,"variable")];function Sg(e){e.registerColorizer("boolean",sf),e.registerColorizer("comment",cf),e.registerColorizer("error",lf),e.registerColorizer("float",ja),e.registerColorizer("integer",ja),e.registerColorizer("long",ja),e.registerColorizer("literal",uf),e.registerColorizer("resource_location",ff),e.registerColorizer("string",pf),e.registerColorizer("symbol",df)}var ue={};ar(ue,{boolean:()=>hf,dispatch:()=>_c,fallback:()=>Cg,file:()=>Ng,literal:()=>gf,noop:()=>Vi,record:()=>Rg,registerCompleters:()=>Tg,resourceLocation:()=>_f,string:()=>yf,symbol:()=>bf});var mf=Vt(fa(),1);var be;(function(e){function t(i,o,a){let s=a?.insertText===void 0&&r(i);return k(O(k({},a),{label:i,range:y.get(o)}),s?{insertText:n(i)}:{})}e.create=t;function r(i){return/[\\$}]/.test(i)}e.needsEscape=r;function n(i){return i.replace(/([\\$}])/g,"\\$1")}e.escape=n})(be||(be={}));var fr,mn,Bi=class{constructor(){P(this,fr,"");P(this,mn,1)}literal(t){return U(this,fr,g(this,fr)+be.escape(t)),this}placeholder(...t){return t.length===0?U(this,fr,g(this,fr)+`\${${g(this,mn)}}`):t.length===1?U(this,fr,g(this,fr)+`\${${g(this,mn)}:${be.escape(t[0])}}`):U(this,fr,g(this,fr)+`\${${g(this,mn)}|${t.map(r=>r.replace(/([\\$},|])/g,"\\$1")).join(",")}|}`),U(this,mn,g(this,mn)+1),this}exitPlace(){return U(this,fr,g(this,fr)+"$0"),this}build(){return g(this,fr)}if(t,r){return t&&r(this),this}};fr=new WeakMap,mn=new WeakMap;var _c=(e,t)=>{let r=Ie.findShallowestChild({node:e,needle:t.offset,endInclusive:!0,predicate:n=>t.meta.hasCompleter(n.type)});return r?t.meta.getCompleter(r.type)(r,t):[]},Cg=_c,hf=(e,t)=>[be.create("false",e,{kind:21}),be.create("true",e,{kind:21})],Ng=(e,t)=>t.meta.getCompleterForLanguageID(t.doc.languageId)(e.children[0],t),gf=e=>{let t=new Map([["enum",13],["enumMember",20],["function",3],["keyword",14],["literal",14],["number",21],["operator",24],["property",10],["resourceLocation",17],["variable",6]]).get(e.options.colorTokenType??"keyword")??14;return e.options.pool.map(r=>be.create(r,e,{kind:t}))??[]},Vi=()=>[];function Rg(e){return(t,r)=>{if(!y.contains(y.translate(t,1,-1),r.offset,!0))return[];let n=d=>e.key(t,d,r,d?.key??r.offset,!1,!1,o),i=d=>e.key(t,d,r,d??r.offset,!0,l||!!d?.end,o),o=t.children.filter(d=>!!d.key).map(d=>d.key),a=(0,mf.default)(t.children,r.offset,(d,m)=>d.end?y.compareOffset(y.translate(d,0,-1),m,!0):y.compareOffset(d.range,m,!0)),s=a>=0?t.children[a]:void 0,l=!!t.children.find(d=>d.range.start>r.offset);if(!s)return i(void 0);let{key:c,sep:u,value:p}=s;return!c&&!u&&!p?i(void 0):c&&y.contains(c,r.offset,!0)||u&&r.offset<=u.start||p&&r.offset<p.range.start?!p||y.isEmpty(p.range)?i(s):n(s):p&&y.contains(p,r.offset,!0)||u&&r.offset>=u.end||c&&r.offset>c.range.end?e.value(t,s,r):[]}}var _f=(e,t)=>{let r=Gn.destruct(t.config.lint.idOmitDefaultNamespace),n=!e.options.isPredicate&&e.namespace==="",i=e.options.isPredicate||r?.ruleValue!==!0,o=!e.options.isPredicate&&r?.ruleValue!==!1,a=c=>s(Object.keys(t.symbols.getVisibleSymbols(c,t.doc.uri))),s=c=>{let u=`${W.DefaultNamespace}${W.NamespacePathSep}`,p=[],d=[];for(let _ of c)_.startsWith(u)?p.push(_):d.push(_);let m=[...d,...i?p:[],...o?p.map(_=>_.slice(u.length)):[],...n?p.map(_=>_.slice(W.DefaultNamespace.length)):[]];return e.options.namespacePathSep==="."?m.map(_=>_.replace(W.NamespacePathSep,".")):m};return(e.options.pool?s(e.options.pool):[...a(e.options.category),...e.options.allowTag?a(`tag/${e.options.category}`).map(c=>`${W.TagPrefix}${c}`):[]]).map(c=>be.create(c,e,{kind:3}))},yf=(e,t)=>e.children?.length?_c(e.children[0],t):e.options.quotes&&e.value===""?e.options.quotes.map(r=>be.create(`${r}${r}`,e,{insertText:`${r}$1${r}`,kind:12})):[],bf=(e,t)=>Object.keys(t.symbols.query(t.doc,e.options.category,...e.options.parentPath??[]).visibleMembers).map(r=>be.create(r,e,{kind:6}));function Tg(e){e.registerCompleter("boolean",hf),e.registerCompleter("comment",Vi),e.registerCompleter("float",Vi),e.registerCompleter("integer",Vi),e.registerCompleter("long",Vi),e.registerCompleter("literal",gf),e.registerCompleter("resource_location",_f),e.registerCompleter("string",yf),e.registerCompleter("symbol",bf)}var Gt={};ar(Gt,{boolean:()=>vf,comment:()=>wf,fallback:()=>jg,file:()=>kf,float:()=>xf,integer:()=>Sf,literal:()=>Cf,long:()=>Nf,registerFormatters:()=>Eg,resourceLocation:()=>Rf,string:()=>Tf});var jg=e=>{throw new Error(`No formatter registered for type ${e.type}`)},kf=(e,t)=>e.children.map(r=>t.meta.getFormatter(r.type)(r,t)).join(""),vf=e=>e.value?"true":"false",wf=e=>"#"+e.comment,xf=e=>e.value.toString(),Sf=e=>e.value.toFixed(),Cf=e=>e.value,Nf=e=>e.value.toString(),Rf=e=>Q.toString(e,"origin"),Tf=e=>`"${e.value}"`;function Eg(e){e.registerFormatter("file",kf),e.registerFormatter("boolean",vf),e.registerFormatter("comment",wf),e.registerFormatter("float",xf),e.registerFormatter("integer",Sf),e.registerFormatter("long",Nf),e.registerFormatter("literal",Cf),e.registerFormatter("resource_location",Rf),e.registerFormatter("string",Tf)}function yc(e,t=0){let r=e.indentLevel+t;return e.insertSpaces?" ".repeat(r*e.tabSize):"	".repeat(r)}function bc(e,t=1){return O(k({},e),{indentLevel:e.indentLevel+t,indent(r){return yc(this,r)}})}var Er={};ar(Er,{configValidator:()=>jr,nameConvention:()=>qi,noop:()=>zg,quote:()=>Ag,registerLinters:()=>Lg});var jf=(e,t)=>{if(!e.symbol||Ae.isDeclared(e.symbol))return;let r=Og(t.ruleValue,e.symbol,t);if(Rr.Action.isDeclare(r)&&t.symbols.query({doc:t.doc,node:e},e.symbol.category,...e.symbol.path).amend({data:{visibility:$g(r.declare)},usage:{type:"declaration",node:e}}),Rr.Action.isReport(r)){let n=r.report==="inherit"?void 0:Nr.toErrorSeverity(r.report);t.err.lint(h("linter.undeclared-symbol.message",e.symbol.category,D(e.symbol.identifier)),e,void 0,n)}};function Og(e,t,r){if(Rr.Action.is(e))return e;function n(o){function a(s){let l=W.lengthen(t.identifier),c=l.slice(0,l.indexOf(W.NamespacePathSep));return(s.category?ye.toArray(s.category).includes(t.category):!0)&&(s.namespace?ye.toArray(s.namespace).includes(c):!0)&&(s.excludeNamespace?!ye.toArray(s.excludeNamespace).includes(c):!0)&&(s.pattern?ye.toArray(s.pattern).some(u=>new RegExp(u).test(t.identifier)):!0)&&(s.excludePattern?!ye.toArray(s.excludePattern).some(u=>new RegExp(u).test(t.identifier)):!0)}try{return ye.toArray(o).some(a)}catch(s){return r.logger.error("[undeclaredSymbol#getAction] Likely encountered an illegal regular expression in the config",s),!1}}function i(o){for(let a of ye.toArray(o))if(!(a.if&&!n(a.if)))return a.override?i(a.override)??a.then:a.then}return i(e)}function $g(e){switch(e){case"block":return 0;case"file":return 1;case"public":return 2}}var zg=()=>{};function qi(e){return(t,r)=>{if(typeof t[e]!="string")throw new Error(`Trying to access property "${e}" of node type "${t.type}"`);let n=t[e];try{let i=new RegExp(r.ruleValue);n.match(i)||r.err.lint(h("linter.name-convention.illegal",D(n),D(r.ruleValue)),t)}catch(i){r.logger.error(`[nameConvention linter] The value \u201C${r.ruleValue}\u201D set for rule \u201C${r.ruleName}\u201D is not a valid regular expression.`,i)}}}var Ag=(e,t)=>{let r=t.ruleValue,n=e.options.unquotable?[...e.value].some(l=>!kc(l,e.options.unquotable)):!0,i=r.always||n,o=r.always===!1&&!n,a=t.src.slice(e.range.start,e.range.start+1),s=!!e.options.quotes?.includes(a);i&&s&&(r.avoidEscape,r.type)},jr;(function(e){function t(o){return`https://spyglassmc.com/user/lint/${o}`}function r(o,a){return`[Invalid Linter Config] [${o}] ${h("linter-config-validator.wrapper",a,t(o))}`}function n(o,a,s){if(typeof a!="string")return s.error(r(o,h("linter-config-validator.name-convention.type"))),!1;try{new RegExp(a)}catch(l){return s.error(r(o,h("")),l),!1}return!0}e.nameConvention=n;function i(o,a,s){return Rr.is(a)}e.symbolLinterConfig=i})(jr||(jr={}));function Lg(e){e.registerLinter("nameOfObjective",{configValidator:jr.nameConvention,linter:qi("value"),nodePredicate:t=>t.symbol&&t.symbol.category==="objective"}),e.registerLinter("nameOfScoreHolder",{configValidator:jr.nameConvention,linter:qi("value"),nodePredicate:t=>t.symbol&&t.symbol.category==="score_holder"}),e.registerLinter("nameOfTag",{configValidator:jr.nameConvention,linter:qi("value"),nodePredicate:t=>t.symbol&&t.symbol.category==="tag"}),e.registerLinter("nameOfTeam",{configValidator:jr.nameConvention,linter:qi("value"),nodePredicate:t=>t.symbol&&t.symbol.category==="team"}),e.registerLinter("undeclaredSymbol",{configValidator:jr.symbolLinterConfig,linter:jf,nodePredicate:t=>t.symbol&&!uc.includes(t.symbol.category)})}var ft=class{errors=[];constructor(){}report(t,r,n=3,i){this.errors.push(da.create(t,y.get(r),n,i))}dump(){let t=Object.freeze(this.errors);return this.errors=[],t}absorb(t){this.errors.push(...t.errors)}},Wn=class extends ft{ruleName;ruleSeverity;constructor(t,r){super(),this.ruleName=t,this.ruleSeverity=r}lint(t,r,n,i){return this.report(h("linter.diagnostic-message-wrapper",t,this.ruleName),r,i??this.ruleSeverity,n)}static fromErrorReporter(t,r,n){let i=new Wn(r,n);return i.errors=t.errors,i}};var Tr=class{undoOps=[];redoOps=[];set(t,r,n){let i=t[r],o=()=>{t[r]=n};this.redoOps.push(o),this.undoOps.push(()=>{t[r]=i}),o()}undo(){for(let t=this.undoOps.length-1;t>=0;t--)this.undoOps[t]()}redo(){this.redoOps.forEach(t=>t())}};var Zi;(function(e){function t(r){return{fs:r.fs,getDocAndNode:r.get.bind(r),global:r.symbols.global,logger:r.logger,meta:r.meta,profilers:r.profilers,roots:r.roots,project:r.ctx}}e.create=t})(Zi||(Zi={}));var Ea;(function(e){function t(r,n){return O(k({},Zi.create(r)),{config:r.config,doc:n.doc,err:n.err??new ft,symbols:r.symbols})}e.create=t})(Ea||(Ea={}));var Wt;(function(e){function t(r,n){return O(k({},Zi.create(r)),{config:r.config,doc:n.doc,src:n.src??new an(n.doc.getText()),symbols:r.symbols})}e.create=t})(Wt||(Wt={}));var vc;(function(e){function t(r,n){return O(k({},Wt.create(r,n)),{range:n.range})}e.create=t})(vc||(vc={}));var wc;(function(e){function t(r,n){return O(k({},Wt.create(r,n)),{offset:n.offset})}e.create=t})(wc||(wc={}));var Oa;(function(e){function t(r,n){return O(k({},Wt.create(r,n)),{err:n.err??new ft,ops:n.ops??new Tr,ensureChecked:r.ensureParsedAndChecked?.bind(r)})}e.create=t})(Oa||(Oa={}));var $a;(function(e){function t(r,n){return O(k({},Wt.create(r,n)),{err:n.err,ruleName:n.ruleName,ruleValue:n.ruleValue})}e.create=t})($a||($a={}));var za;(function(e){function t(r,n){return O(k(k({},Wt.create(r,n)),n),{indentLevel:0,indent(i){return yc(this,i)}})}e.create=t})(za||(za={}));var Aa;(function(e){function t(r,n){return vc.create(r,n)}e.create=t})(Aa||(Aa={}));var La;(function(e){function t(r,n){return O(k({},Wt.create(r,n)),{offset:n.offset,triggerCharacter:n.triggerCharacter})}e.create=t})(La||(La={}));var Ia;(function(e){function t(r,n){return wc.create(r,n)}e.create=t})(Ia||(Ia={}));var Pa;(function(e){function t(r){return O(k({},Zi.create(r)),{symbols:r.symbols})}e.create=t})(Pa||(Pa={}));var Da;(function(e){function t(r){return r.startsWith("@")}e.is=t})(Da||(Da={}));var Or,Ma=class{constructor(t,r,n){re(this,"cacheRoot");re(this,"externals");re(this,"logger");P(this,Or,new Map);this.cacheRoot=t,this.externals=r,this.logger=n}async download(t,r={}){let{id:n,cache:i,uri:o,options:a,transformer:s,ttl:l}=t;if(l&&g(this,Or).has(o)){let{buffer:d,time:m}=g(this,Or).get(o);if(m<=performance.now()+l)return this.logger.info(`[Downloader] [${n}] Skipped thanks to valid cache in memory`),await s(d);g(this,Or).delete(o)}let c,u,p;if(i){let{checksumJob:d,checksumExtension:m}=i;r.cacheUri=u=new rt(`downloader/${n}`,this.cacheRoot).toString(),p=new rt(`downloader/${n}${m}`,this.cacheRoot).toString();try{r.checksum=c=await this.download(O(k({},d),{id:n+m}));try{let _=wt(await oe.readFile(this.externals,p)).slice(0,-1);if(c===_)try{let T=await oe.readFile(this.externals,u);l&&g(this,Or).set(o,{buffer:T,time:performance.now()});let b=i.deserializer??(z=>z),S=await s(b(T));return this.logger.info(`[Downloader] [${n}] Skipped downloading thanks to cache ${_}`),S}catch(T){if(this.logger.error(`[Downloader] [${n}] Loading cached file \u201C${u}\u201D`,T),this.externals.error.isKind(T,"ENOENT"))try{await this.externals.fs.unlink(p)}catch(b){this.logger.error(`[Downloader] [${n}] Removing invalid cache checksum \u201C${p}\u201D`,b)}}}catch(_){this.externals.error.isKind(_,"ENOENT")||this.logger.error(`[Downloader] [${n}] Loading cache checksum \u201C${p}\u201D`,_)}}catch(_){this.logger.error(`[Downloader] [${n}] Fetching latest checksum \u201C${d.uri}\u201D`,_)}}try{let d=await this.externals.downloader.get(o,a);if(l&&g(this,Or).set(o,{buffer:d,time:performance.now()}),i&&u&&p){if(c)try{await oe.writeFile(this.externals,p,`${c}
`)}catch(m){this.logger.error(`[Downloader] [${n}] Saving cache checksum \u201C${p}\u201D`,m)}try{let m=i.serializer??(_=>_);await oe.writeFile(this.externals,u,m(d))}catch(m){this.logger.error(`[Downloader] [${n}] Caching file \u201C${u}\u201D`,m)}}return this.logger.info(`[Downloader] [${n}] Downloaded from \u201C${o}\u201D`),await s(d)}catch(d){if(this.logger.error(`[Downloader] [${n}] Downloading \u201C${o}\u201D`,d),i&&u)try{let m=await oe.readFile(this.externals,u),_=i.deserializer??(b=>b),T=await s(_(m));return this.logger.warn(`[Downloader] [${n}] Fell back to cached file \u201C${u}\u201D`),T}catch(m){this.logger.error(`[Downloader] [${n}] Fallback: loading cached file \u201C${u}\u201D`,m)}}}};Or=new WeakMap;var Fa=class{_map=new Map;_reversedMap=new Map;constructor(t=[]){for(let[r,n]of t)this._map.set(r,n),this._reversedMap.set(n,r)}get size(){return this._map.size}clear(){this._map.clear(),this._reversedMap.clear()}delete(t){let r=this._map.get(t),n=this._map.delete(t);return r!==void 0&&this._reversedMap.delete(r),n}deleteValue(t){let r=this._reversedMap.get(t),n=this._reversedMap.delete(t);return r!==void 0&&this._map.delete(r),n}get(t){return this._map.get(t)}getKey(t){return this._reversedMap.get(t)}has(t){return this._map.has(t)}hasValue(t){return this._reversedMap.has(t)}set(t,r){return this._map.set(t,r),this._reversedMap.set(r,t),this}forEach(t,r){for(let[n,i]of this._map)t.apply(r,[i,n,this])}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.values()}[Symbol.iterator](){return this._map.entries()}[Symbol.toStringTag]="TwoWayMap"};var Hi;(function(e){function t(r,n){let i=oe.ensureEndingSlash(new rt("virtual-uris/",n).toString());return new xc(r,i)}e.create=t})(Hi||(Hi={}));var xc=class{externals;virtualUrisRoot;supporters=new Map;map=new Fa;constructor(t,r){this.externals=t,this.virtualUrisRoot=r}register(t,r,n=!1){if(!n&&this.supporters.has(t))throw new Error(`The protocol \u201C${t}\u201D is already associated with another supporter.`);this.supporters.set(t,r)}unregister(t){this.supporters.delete(t)}getSupportedProtocol(t){let r=new rt(t).protocol;if(!this.supporters.has(r))throw new Error(`The protocol \u201C${r}\u201D is unsupported.`);return r}async hash(t){let r=this.getSupportedProtocol(t);return this.supporters.get(r).hash(t)}readFile(t){let r=this.getSupportedProtocol(t);return this.supporters.get(r).readFile(t)}*listFiles(){for(let t of this.supporters.values())yield*t.listFiles()}*listRoots(){for(let t of this.supporters.values())yield*t.listRoots()}async mapToDisk(t){if(oe.isFileUri(t))return t;if(!!this.virtualUrisRoot)try{let r=this.map.getKey(t);if(r===void 0){r=`${this.virtualUrisRoot}${await this.externals.crypto.getSha1(t)}/${oe.basename(t)}`;let n=await this.readFile(t);await oe.writeFile(this.externals,r,n,292),this.map.set(r,t)}return r}catch{}}mapFromDisk(t){return this.virtualUrisRoot?this.map.get(t)??t:t}},Jn=class{externals;roots;files;protocol="file:";constructor(t,r,n){this.externals=t,this.roots=r,this.files=n}async hash(t){return Sc(this.externals,t)}readFile(t){return this.externals.fs.readFile(t)}*listFiles(){for(let t of this.files.values())yield*t}listRoots(){return this.roots}async mapToDisk(t){return t}static async create(t,r,n){let i=[],o=new Map;for(let{uri:a}of t)try{oe.isFileUri(a)&&(await r.fs.stat(a)).isDirectory()&&(a=oe.ensureEndingSlash(a),i.push(a),o.set(a,await r.fs.getAllFiles(a)))}catch(s){n.error(`[FileUriSupporter#create] Bad dependency \u201C${a}\u201D`,s)}return new Jn(r,i,o)}},pt=class{externals;entries;protocol=pt.Protocol;constructor(t,r){this.externals=t,this.entries=r}async hash(t){let{archiveUri:r,pathInArchive:n}=pt.decodeUri(new rt(t));return n?this.externals.crypto.getSha1(this.getDataInArchive(r,n)):Sc(this.externals,r)}async readFile(t){let{archiveUri:r,pathInArchive:n}=pt.decodeUri(new rt(t));return this.getDataInArchive(r,n)}getDataInArchive(t,r){let n=this.entries.get(t);if(!n)throw new Error(`Archive \u201C${t}\u201D has not been loaded into the memory`);let i=n.get(r);if(!i)throw new Error(`Path \u201C${r}\u201D does not exist in archive \u201C${t}\u201D`);if(i.type!=="file")throw new Error(`Path \u201C${r}\u201D in archive \u201C${t}\u201D is not a file`);return i.data}*listFiles(){for(let[t,r]of this.entries.entries())for(let n of r.values())yield pt.getUri(t,n.path)}*listRoots(){for(let t of this.entries.keys())yield pt.getUri(t)}static getUri(t,r=""){return`${pt.Protocol}//${encodeURIComponent(t)}/${r.replace(/\\/g,"/")}`}static decodeUri(t){if(t.protocol!==pt.Protocol)throw new Error(`Expected protocol \u201C${pt.Protocol}\u201D in \u201C${t}\u201D`);return{archiveUri:decodeURIComponent(t.hostname),pathInArchive:t.pathname.charAt(0)==="/"?t.pathname.slice(1):t.pathname}}static async create(t,r,n,i){let o=new Map;for(let{uri:a,info:s}of t)try{if(a.startsWith("file:")&&pt.SupportedArchiveExtnames.some(l=>a.endsWith(l))&&(await r.fs.stat(a)).isFile()){let l=pt.getUri(a),c=i[l];if(c!==void 0){let p=await Sc(r,a);if(c===p){n.info(`[SpyglassUriSupporter#create] Skipped decompressing \u201C${a}\u201D thanks to cache ${p}`);continue}}let u=await r.archive.decompressBall(await r.fs.readFile(a),{stripLevel:typeof s?.startDepth=="number"?s.startDepth:0});o.set(a,new Map(u.map(p=>[p.path.replace(/\\/g,"/"),p])))}}catch(l){n.error(`[SpyglassUriSupporter#create] Bad dependency \u201C${a}\u201D`,l)}return new pt(r,o)}},hn=pt;re(hn,"Protocol","archive:"),re(hn,"SupportedArchiveExtnames",[".tar",".tar.bz2",".tar.gz",".zip"]);async function Sc(e,t){return e.crypto.getSha1(await e.fs.readFile(t))}var Ki;(function(e){function t(r,n){return{range:y.get(r),markdown:n}}e.create=t})(Ki||(Ki={}));var Yn;(function(e){function t(){return console}e.create=t;function r(){return new Cc}e.noop=r})(Yn||(Yn={}));var Cc=class{error(){}info(){}log(){}warn(){}};var dt,Xn,Qn,ei,Gi,ti,Wi,Ji,ri,Yi,Xi,Qi,Ua=class{constructor(){P(this,dt,new Map);P(this,Xn,new Map);P(this,Qn,new Map);P(this,ei,new Map);P(this,Gi,new Map);P(this,ti,new Map);P(this,Wi,new Set);P(this,Ji,new Map);P(this,ri,new Map);P(this,Yi,new Set);P(this,Xi,new Map);P(this,Qi,new Set);it.registerCheckers(this),Oe.registerColorizers(this),ue.registerCompleters(this),Gt.registerFormatters(this),Er.registerLinters(this)}registerLanguage(t,r){g(this,dt).set(t,r)}getLanguages(){return Array.from(g(this,dt).keys())}isSupportedLanguage(t){return g(this,dt).has(t)}getSupportedFileExtensions(){return[...g(this,dt).values()].flatMap(t=>t.extensions)}getTriggerCharacters(){return Array.from(g(this,dt).values()).flatMap(t=>t.triggerCharacters??[])}getLanguageID(t){for(let[r,{extensions:n}]of g(this,dt))if(n.includes(t))return r}hasChecker(t){return g(this,Xn).has(t)}getChecker(t){return g(this,Xn).get(t)??it.fallback}registerChecker(t,r){g(this,Xn).set(t,r)}hasColorizer(t){return g(this,Qn).has(t)}getColorizer(t){return g(this,Qn).get(t)??Oe.fallback}registerColorizer(t,r){g(this,Qn).set(t,r)}hasCompleter(t){return g(this,ei).has(t)}getCompleter(t){return g(this,ei).get(t)??ue.fallback}registerCompleter(t,r){g(this,ei).set(t,r)}shouldComplete(t,r){let n=g(this,dt).get(t);return!r||!!n?.triggerCharacters?.includes(r)}getCompleterForLanguageID(t){return g(this,dt).get(t)?.completer??ue.fallback}getDependencyProvider(t){return g(this,Gi).get(t)}registerDependencyProvider(t,r){g(this,Gi).set(t,r)}hasFormatter(t){return g(this,ti).has(t)}getFormatter(t){return g(this,ti).get(t)??Gt.fallback}registerFormatter(t,r){g(this,ti).set(t,r)}registerInlayHintProvider(t){g(this,Wi).add(t)}get inlayHintProviders(){return g(this,Wi)}getLinter(t){return g(this,Ji).get(t)??{configValidator:()=>!1,linter:Er.noop,nodePredicate:()=>!1}}registerLinter(t,r){g(this,Ji).set(t,r)}hasParser(t){return g(this,ri).has(t)}getParser(t){let r=g(this,ri).get(t);if(!r)throw new Error(`There is no parser '${t}'`);return r}getParserLazily(t){return vr.create(()=>this.getParser(t))}registerParser(t,r){g(this,ri).set(t,r)}getParserForLanguageId(t){if(g(this,dt).has(t))return g(this,dt).get(t).parser;throw new Error(`There is no parser registered for language ID '${t}'`)}registerSignatureHelpProvider(t){g(this,Yi).add(t)}get signatureHelpProviders(){return g(this,Yi)}registerSymbolRegistrar(t,r){g(this,Xi).set(t,r)}get symbolRegistrars(){return g(this,Xi)}registerUriBinder(t){g(this,Qi).add(t)}get uriBinders(){return g(this,Qi)}};dt=new WeakMap,Xn=new WeakMap,Qn=new WeakMap,ei=new WeakMap,Gi=new WeakMap,ti=new WeakMap,Wi=new WeakMap,Ji=new WeakMap,ri=new WeakMap,Yi=new WeakMap,Xi=new WeakMap,Qi=new WeakMap;var Ef="Total",eo,to,gn,ni,$r,Nc=class{constructor(t,r){re(this,"id");re(this,"logger");P(this,eo,!1);P(this,to,void 0);P(this,gn,void 0);P(this,ni,[]);P(this,$r,0);this.id=t,this.logger=r,U(this,to,U(this,gn,performance.now()))}task(t){if(g(this,eo))throw new Error("The profiler is finalized.");let r=performance.now();return g(this,ni).push([t,r-g(this,gn)]),U(this,gn,r),U(this,$r,Math.max(g(this,$r),t.length)),this.logger.info(`[Profiler: ${this.id}] Done: ${t}`),this}finalize(){U(this,eo,!0),g(this,ni).push([Ef,g(this,gn)-g(this,to)]),U(this,$r,Math.max(g(this,$r),Ef.length)),this.logger.info(`[Profiler: ${this.id}] == Summary ==`);for(let[t,r]of g(this,ni))this.logger.info(`[Profiler: ${this.id}] ${t}${" ".repeat(g(this,$r)-t.length)} - ${r} ms`)}};eo=new WeakMap,to=new WeakMap,gn=new WeakMap,ni=new WeakMap,$r=new WeakMap;var Rc=class{task(){return this}finalize(){}},ro,Tc=class{constructor(t,r){re(this,"logger");P(this,ro,void 0);this.logger=t,U(this,ro,new Set(r))}get(t){return g(this,ro).has(t)?new Nc(t,this.logger):new Rc}static noop(){return new Tc(Yn.noop(),[])}},zr=Tc;ro=new WeakMap;var Ba=Vt(va(),1);var so=function(e,t,r,n){var i=arguments.length,o=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},Ig=6e5,no,Ar,oi,Jt,_n,ai,io,oo,Lr,si,Ir,pr,ao,yn,ci,li,bn,ii=class{constructor({cacheRoot:t,defaultConfig:r,downloader:n,externals:i,fs:o=Hi.create(i,t),initializers:a=[],logger:s=Yn.create(),profilers:l=zr.noop(),projectRoot:c}){P(this,no,void 0);re(this,"cacheService");P(this,Ar,new Set);P(this,oi,void 0);P(this,Jt,new Map);P(this,_n,void 0);P(this,ai,void 0);P(this,io,void 0);P(this,oo,void 0);P(this,Lr,new Set);P(this,si,void 0);P(this,Ir,!1);P(this,pr,!1);re(this,"config");re(this,"downloader");re(this,"externals");re(this,"fs");re(this,"logger");re(this,"meta",new Ua);re(this,"profilers");re(this,"projectRoot");re(this,"symbols");P(this,ao,void 0);P(this,yn,void 0);P(this,ci,[]);P(this,li,void 0);P(this,bn,void 0);U(this,bn,t),U(this,_n,new i.event.EventEmitter),this.externals=i,this.fs=o,U(this,ai,a),this.logger=s,this.profilers=l,this.projectRoot=c,this.cacheService=new Na(t,this),U(this,oi,new dn(this,r)),this.downloader=n??new Ma(t,i,s),this.symbols=new Ae({},i.event.EventEmitter),U(this,li,{}),this.logger.info(`[Project] [init] cacheRoot = \u201C${t}\u201D`),g(this,oi).on("changed",({config:u})=>{this.config=u,this.logger.info("[Project] [Config] Changed")}).on("error",({error:u,uri:p})=>this.logger.error(`[Project] [Config] Failed loading \u201C${p}\u201D`,u)),this.setInitPromise(),this.setReadyPromise(),U(this,no,setInterval(()=>this.cacheService.save(),Ig)),this.on("documentUpdated",({doc:u,node:p})=>{!g(this,pr)||this.emit("documentErrorred",{doc:u,errors:ga.getErrors(p),node:p})}).on("fileCreated",async({uri:u})=>(u.endsWith(ii.RootSuffix)&&this.updateRoots(),this.bind(u),this.ensureParsedAndChecked(u))).on("fileModified",async({uri:u})=>{this.isOnlyWatched(u)&&(g(this,Jt).delete(u),await this.ensureParsedAndChecked(u))}).on("fileDeleted",({uri:u})=>{u.endsWith(ii.RootSuffix)&&this.updateRoots(),this.symbols.clear({uri:u}),this.tryClearingCache(u)}).on("ready",()=>{U(this,pr,!0);let u=[];for(let p of g(this,Ar)){let d=g(this,Jt).get(p);d&&u.push(this.check(d.doc,d.node))}Promise.all(u).catch(p=>this.logger.error("[Project#ready] Error occurred when rechecking client managed files after ready",p))})}get isReady(){return g(this,pr)}get roots(){return g(this,ci)}get ctx(){return g(this,li)}get cacheRoot(){return g(this,bn)}updateRoots(){let t=[...g(this,ao),this.projectRoot],r=new Set(t);for(let n of this.getTrackedFiles())n.endsWith(ii.RootSuffix)&&t.some(i=>n.startsWith(i))&&r.add(n.slice(0,1-ii.RootSuffix.length));U(this,ci,[...r].sort((n,i)=>i.length-n.length)),this.emit("rootsUpdated",{roots:g(this,ci)})}on(t,r){return g(this,_n).on(t,r),this}once(t,r){return g(this,_n).once(t,r),this}emit(t,...r){return g(this,_n).emit(t,...r)}getTrackedFiles(){let t=this.meta.getSupportedFileExtensions();return[...g(this,yn),...g(this,Lr)].filter(r=>t.includes(oe.extname(r)??""))}setInitPromise(){let t=async()=>{this.config=await g(this,oi).load()},r=async()=>{let i={cacheRoot:this.cacheRoot,config:this.config,downloader:this.downloader,externals:this.externals,logger:this.logger,meta:this.meta,projectRoot:this.projectRoot},o=await Promise.allSettled(g(this,ai).map(s=>s(i))),a={};o.forEach(async(s,l)=>{s.status==="rejected"?this.logger.error(`[Project] [callInitializers] [${l}] \u201C${g(this,ai)[l].name}\u201D`,s.reason):s.value&&(a=k(k({},a),s.value))}),U(this,li,a)};U(this,io,(async()=>{let i=this.profilers.get("project#init"),{symbols:o}=await this.cacheService.load();this.symbols=new Ae(o,this.externals.event.EventEmitter),this.symbols.buildCache(),i.task("Load Cache"),await t(),i.task("Load Config"),await r(),i.task("Initialize").finalize()})())}setReadyPromise(){let t=async()=>{let o=[];for(let a of this.config.env.dependencies)if(Da.is(a)){let s=this.meta.getDependencyProvider(a);if(s)try{o.push(await s()),this.logger.info(`[Project] [getDependencies] Executed provider \u201C${a}\u201D`)}catch(l){this.logger.error(`[Project] [getDependencies] Bad provider \u201C${a}\u201D`,l)}else this.logger.error(`[Project] [getDependencies] Bad dependency \u201C${a}\u201D: no associated provider`)}else o.push({uri:a});return o},r=async()=>{let o=await t(),a=await Jn.create(o,this.externals,this.logger),s=await hn.create(o,this.externals,this.logger,this.cacheService.checksums.roots);this.fs.register("file:",a,!0),this.fs.register(hn.Protocol,s,!0)},n=()=>new Promise(o=>{U(this,Ir,!1),U(this,si,this.externals.fs.watch(this.projectRoot).once("ready",()=>{U(this,Ir,!0),o()}).on("add",a=>{g(this,Lr).add(a),g(this,Ir)&&this.emit("fileCreated",{uri:a})}).on("change",a=>{g(this,Ir)&&this.emit("fileModified",{uri:a})}).on("unlink",a=>{g(this,Lr).delete(a),g(this,Ir)&&this.emit("fileDeleted",{uri:a})}).on("error",a=>{this.logger.error("[Project] [chokidar]",a)}))});U(this,oo,(async()=>{await this.init();let o=this.profilers.get("project#ready"),a=this.ensureParsed.bind(this),s=this.ensureChecked.bind(this);await Promise.all([r(),n()]),U(this,yn,new Set(this.fs.listFiles())),U(this,ao,new Set(this.fs.listRoots())),this.updateRoots(),o.task("List Files");for(let[m,{checksum:_,registrar:T}]of this.meta.symbolRegistrars){let b=this.cacheService.checksums.symbolRegistrars[m];b===void 0||_!==b?(this.symbols.clear({contributor:`symbol_registrar/${m}`}),this.symbols.contributeAs(`symbol_registrar/${m}`,()=>{T(this.symbols,{logger:this.logger})}),this.emit("symbolRegistrarExecuted",{id:m,checksum:_})):this.logger.info(`[SymbolRegistrar] Skipped \u201C${m}\u201D thanks to cache ${_}`)}o.task("Register Symbols");let{addedFiles:l,changedFiles:c,removedFiles:u}=await this.cacheService.validate();for(let m of u)this.symbols.clear({uri:m});o.task("Validate Cache"),l.length>0&&this.bind(l),o.task("Bind URIs");let p=[...l,...c],d=(await Promise.all(p.map(m=>a(m)))).filter(m=>!!m);o.task("Parse Files"),await Promise.all(d.map(({doc:m,node:_})=>s(m,_))),o.task("Check Files").finalize(),this.emit("ready",{})})())}async init(){return await g(this,io),this}async ready(){return await g(this,oo),this}async close(){clearInterval(g(this,no)),await g(this,si).close(),await this.cacheService.save()}async restart(){try{await g(this,si).close(),this.setReadyPromise(),await this.ready()}catch(t){this.logger.error("[Project#reset]",t)}}resetCache(){return this.cacheService.reset()}normalizeUri(t){return this.fs.mapFromDisk(this.externals.uri.normalize(t))}getLanguageID(t){t=this.normalizeUri(t);let r=oe.extname(t)??".plaintext";return this.meta.getLanguageID(r)??r.slice(1)}get(t){return t=this.normalizeUri(t),g(this,Jt).get(t)}async ensureParsed(t){if(t=this.normalizeUri(t),g(this,Jt).has(t))return g(this,Jt).get(t);let r=this.getLanguageID(t);if(!!this.meta.isSupportedLanguage(r))try{let n=wt(await this.fs.readFile(t)),i=Ba.TextDocument.create(t,r,-1,n);return this.parseAndCache(i)}catch(n){this.logger.warn(`[Project] [ensureParsed] Failed for \u201C${t}\u201D`,n);return}}parseAndCache(t){let r=this.parse(t);return this.cache(t,r)}parse(t){let r=Ea.create(this,{doc:t}),n=new Se(t.getText()),i;return r.symbols.clear({contributor:"parser",uri:t.uri}),r.symbols.contributeAs("parser",()=>i=Of()(n,r)),i}cache(t,r){let n={doc:t,node:r};return g(this,Jt).set(t.uri,n),this.emit("documentUpdated",n),n}async check(t,r){let n=this.meta.getChecker(r.type),i=Oa.create(this,{doc:t});i.symbols.clear({contributor:"checker",uri:t.uri}),await i.symbols.contributeAsAsync("checker",async()=>{await n(r,i),r.checkerErrors=i.err.dump(),this.cache(t,r),this.ensureLinted(t,r)})}async ensureChecked(t,r){if(!r.checkerErrors)try{return this.check(t,r)}catch(n){this.logger.error(`[Project] [ensuredChecked] Failed for \u201C${t.uri}\u201D #${t.version}`,n)}}lint(t,r){r.linterErrors=[];for(let[n,i]of Object.entries(this.config.lint)){let o=Gn.destruct(i);if(!o)continue;let{ruleSeverity:a,ruleValue:s}=o,{configValidator:l,linter:c,nodePredicate:u}=this.meta.getLinter(n);if(!l(n,s,this.logger))continue;let p=$a.create(this,{doc:t,err:new Wn(n,a),ruleName:n,ruleValue:s});Kt(r,()=>!0,()=>!0,d=>{u(d)&&c(d,p)}),r.linterErrors.push(...p.err.dump())}this.cache(t,r)}ensureLinted(t,r){if(!r.linterErrors)try{this.lint(t,r)}catch(n){this.logger.error(`[Project] [ensureLinted] Failed for \u201C${t.uri}\u201D #${t.version}`,n)}}async ensureParsedAndChecked(t){let r=await this.ensureParsed(t);return r&&await this.ensureChecked(r.doc,r.node),r}async ensureParsedAndCheckedOnlyWhenReady(t){let r=await this.ensureParsed(t);return g(this,pr)&&r&&await this.ensureChecked(r.doc,r.node),r}bind(t){let r=Pa.create(this);typeof t=="string"&&r.symbols.clear({contributor:"uri_binder",uri:t}),r.symbols.contributeAs("uri_binder",()=>{let n=Array.isArray(t)?t:[t];for(let i of this.meta.uriBinders)i(n,r)})}onDidOpen(t,r,n,i){if(t=this.normalizeUri(t),!oe.isFileUri(t))return;g(this,Ar).add(t);let o=Ba.TextDocument.create(t,r,n,i),{node:a}=this.parseAndCache(o);g(this,pr)&&this.check(o,a)}onDidChange(t,r,n){if(t=this.normalizeUri(t),!oe.isFileUri(t))return;let i=this.get(t);if(!i)throw new Error(`Document for \u201C${t}\u201D is not cached. This should not happen. Did the language client send a didChange notification without sending a didOpen one?`);Ba.TextDocument.update(i.doc,r,n);let{node:o}=this.parseAndCache(i.doc);g(this,pr)&&this.check(i.doc,o)}onDidClose(t){t=this.normalizeUri(t),oe.isFileUri(t)&&(g(this,Ar).delete(t),this.tryClearingCache(t))}async showCacheRoot(){if(!!g(this,bn))try{await this.externals.fs.showFile(g(this,bn))}catch(t){this.logger.error("[Service#showCacheRoot]",t)}}tryClearingCache(t){this.shouldRemove(t)&&(g(this,Jt).delete(t),this.emit("documentRemoved",{uri:t}))}shouldRemove(t){return!g(this,Ar).has(t)&&!g(this,yn).has(t)&&!g(this,Lr).has(t)}isOnlyWatched(t){return g(this,Lr).has(t)&&!g(this,Ar).has(t)&&!g(this,yn).has(t)}},Yt=ii;no=new WeakMap,Ar=new WeakMap,oi=new WeakMap,Jt=new WeakMap,_n=new WeakMap,ai=new WeakMap,io=new WeakMap,oo=new WeakMap,Lr=new WeakMap,si=new WeakMap,Ir=new WeakMap,pr=new WeakMap,ao=new WeakMap,yn=new WeakMap,ci=new WeakMap,li=new WeakMap,bn=new WeakMap,re(Yt,"RootSuffix","/pack.mcmeta");so([Mn()],Yt.prototype,"ensureParsed",null);so([Mn()],Yt.prototype,"check",null);so([Mn()],Yt.prototype,"ensureChecked",null);so([Mn()],Yt.prototype,"ensureParsedAndChecked",null);so([Mn()],Yt.prototype,"ensureParsedAndCheckedOnlyWhenReady",null);var Va;(function(e){function t(r,n){return{range:y.get(r),locations:n}}e.create=t})(Va||(Va={}));var qa=class{isDebugging;logger;profilers;project;constructor({isDebugging:t=!1,logger:r,profilers:n=zr.noop(),project:i}){this.isDebugging=t,this.logger=r,this.profilers=n,this.project=new Yt(k({logger:r,profilers:n},i))}debug(t){this.isDebugging&&this.logger.info(`[DEBUG] ${t}`)}colorize(t,r,n){try{return this.debug(`Colorizing '${r.uri}' # ${r.version}`),this.project.meta.getColorizer(t.type)(t,Aa.create(this.project,{doc:r,range:n}))}catch(i){this.logger.error(`[Service] [colorize] Failed for \u201C${r.uri}\u201D #${r.version}`,i)}return[]}getColorInfo(t,r){try{this.debug(`Getting color info for '${r.uri}' # ${r.version}`);let n=[];return Kt(t,i=>!0,i=>i.color,i=>n.push({color:Array.isArray(i.color)?i.color:i.color.value,range:Array.isArray(i.color)?i.range:i.color.range??i.range})),n}catch(n){this.logger.error(`[Service] [getColorInfo] Failed for \u201C${r.uri}\u201D #${r.version}`,n)}return[]}getColorPresentation(t,r,n,i){try{this.debug(`Getting color presentation for '${r.uri}' # ${r.version} @ ${y.toString(n)}`);let o=Ie.findDeepestChild({node:t,needle:n.start});for(;o;){let a=o.color;if(a&&!Array.isArray(a)){let s=a.range??o.range;return a.format.map(l=>Ta.fromColorFormat(l,i,s))}o=o.parent}}catch(o){this.logger.error(`[Service] [getColorPresentation] Failed for \u201C${r.uri}\u201D #${r.version}`,o)}return[]}complete(t,r,n,i){try{if(this.debug(`Getting completion for '${r.uri}' # ${r.version} @ ${n}`),this.project.meta.shouldComplete(r.languageId,i))return ue.file(t,La.create(this.project,{doc:r,offset:n,triggerCharacter:i}))}catch(o){this.logger.error(`[Service] [complete] Failed for \u201C${r.uri}\u201D #${r.version}`,o)}return[]}dataHackPubify(t){let r=[["ata","ack","ub","elper","lus"],["ah","uh","ew","elpa","lush"]],n=r[Math.floor(Math.random()*r.length)];return[...t].map((i,o)=>`${i.toUpperCase()}${n[o%n.length]}`).join(" ")}format(t,r,n,i){try{return this.debug(`Formatting '${r.uri}' # ${r.version}`),this.project.meta.getFormatter(t.type)(t,za.create(this.project,{doc:r,tabSize:n,insertSpaces:i}))}catch(o){throw this.logger.error(`[Service] [format] Failed for \u201C${r.uri}\u201D #${r.version}`,o),o}}getHover(t,r,n){try{this.debug(`Getting hover for '${r.uri}' # ${r.version} @ ${n}`);let i=Ie.findDeepestChild({node:t,needle:n});for(;i;){let o=this.project.symbols.resolveAlias(i.symbol);if(o){let a=`\`\`\`typescript
(${o.category}${o.subcategory?`/${o.subcategory}`:""}) ${o.identifier}
\`\`\``+(o.desc?`
******
${o.desc}`:"");return Ki.create(i.range,a)}if(i.hover)return Ki.create(i.range,i.hover);i=i.parent}}catch(i){this.logger.error(`[Service] [getHover] Failed for \u201C${r.uri}\u201D #${r.version}`,i)}}getInlayHints(t,r,n){try{this.debug(`Getting inlay hints for '${r.uri}' # ${r.version}`);let i=[],o=Wt.create(this.project,{doc:r});for(let a of this.project.meta.inlayHintProviders)i.push(...a(t,o));return i}catch(i){this.logger.error(`[Service] [getInlayHints] Failed for \u201C${r.uri}\u201D #${r.version}`,i)}return[]}getSignatureHelp(t,r,n){try{this.debug(`Getting signature help for '${r.uri}' # ${r.version} @ ${n}`);let i=Ia.create(this.project,{doc:r,offset:n});for(let o of this.project.meta.signatureHelpProviders){let a=o(t,i);if(a)return a}}catch(i){this.logger.error(`[Service] [getSignatureHelp] Failed for \u201C${r.uri}\u201D #${r.version}`,i)}}async getSymbolLocations(t,r,n,i=cn,o=!1){try{this.debug(`Getting symbol locations of usage '${i.join(",")}' for '${r.uri}' # ${r.version} @ ${n} with currentFileOnly=${o}`);let a=Ie.findDeepestChild({node:t,needle:n});for(;a;){let s=this.project.symbols.resolveAlias(a.symbol);if(s){let l=[];for(let u of i){let p=s[u]??[];o&&(p=p.filter(d=>d.uri===r.uri)),l.push(...p)}let c=[];for(let u of l){let p=oe.isFileUri(u.uri)?u.uri:await this.project.fs.mapToDisk(u.uri);p&&c.push(O(k({},u),{uri:p}))}return Va.create(a.range,c.length?c:void 0)}a=a.parent}}catch(a){this.logger.error(`[Service] [getSymbolLocations] Failed for \u201C${r.uri}\u201D #${r.version}`,a)}}};var G=Symbol("Failure");function mt(e,t,r){let n=t.clone(),i=O(k({},r),{err:new ft,symbols:r.symbols.clone()});return{result:e(n,i),endCursor:n.cursor,errorAmount:i.err.errors.length,updateSrcAndCtx:()=>{t.innerCursor=n.innerCursor,r.err.absorb(i.err),i.symbols.applyDelayedEdits()}}}function ve(e,t){return(r,n)=>{let i={[Pi]:!0,children:[],range:y.create(r)};for(let[o,a]of e.entries()){let s=typeof a=="function"?a:a.get(i);if(s===void 0)continue;o>0&&t&&i.children.push(...t(r,n));let l=s(r,n);if(l===G)return G;if(l===void 0)continue;Ii.is(l)?i.children.push(...l.children):i.children.push(l)}return i.range.end=r.cursor,i}}function ui(e,t){return(r,n)=>{let i={[Pi]:!0,children:[],range:y.create(r)};for(;r.canRead();){t&&i.children.push(...t(r,n));let{result:o,updateSrcAndCtx:a}=mt(e,r,n);if(o===G)break;a(),Ii.is(o)?i.children.push(...o.children):i.children.push(o)}return i.range.end=r.cursor,i}}function Ct(e,t){return(r,n)=>{let i=e.map((o,a)=>({attempt:mt(o,r,n),index:a})).filter(({attempt:o})=>o.result!==G).sort((o,a)=>a.attempt.endCursor-o.attempt.endCursor||o.attempt.errorAmount-a.attempt.errorAmount);return i.length===0?(t&&(t.index=-1),G):(i[0].attempt.updateSrcAndCtx(),t&&(t.index=i[0].index),i[0].attempt.result)}}function de(e){return(t,r)=>{let n=t.cursor,{endCursor:i,updateSrcAndCtx:o,result:a}=mt(e,t,r);return i-n>0?(o(),a):G}}function fi(e){return(t,r)=>{let n=t.cursor,{errorAmount:i,updateSrcAndCtx:o,result:a}=mt(e,t,r);return i?G:(o(),a)}}function _e(e){return(t,r)=>{let{result:n,updateSrcAndCtx:i}=mt(e,t,r);if(n!==G)return i(),n}}function me(e){return(t,r)=>{for(let{predicate:n,prefix:i,parser:o}of e)if(n?.(t)??(i!==void 0?t.tryPeek(i):void 0)??!0)return(typeof o=="object"?o.get():o)(t,r);throw new Error("The select parser util was called with non-exhaustive cases")}}function ie(e,t){return(r,n)=>{let i=e(r,n);return i===G?G:t(i,r,n)}}function he(e,t){return ie(t,r=>{let a=r,{type:n}=a,i=$u(a,["type"]),o=k({type:e},i);return delete o[Pi],o})}function co(e,t,r,n){return ie(e,(i,o,a)=>(t(i,o,a)||a.err.report(r,i.range,n),i))}function dr(e,...t){let r=t.flat();return(n,i)=>{let o=n.clone();o.string=o.string.slice(0,r.reduce((s,l)=>{let c=o.string.indexOf(l,o.innerCursor);return Math.min(s,c===-1?1/0:c)},1/0));let a=e(o,i);return n.cursor=o.cursor,a}}var Za=ie(Ee("false","true"),e=>({type:"boolean",range:e.range,value:e.value===""?void 0:e.value==="true"}));function lo({singleLinePrefixes:e,includesEol:t}){return(r,n)=>{let i=r.cursor,o={type:"comment",range:y.create(i),comment:""};for(let a of e)if(r.peek(a.length)===a)return t?r.nextLine():r.skipLine(),o.range.end=r.cursor,o.comment=r.sliceToCursor(i+a.length),o;return G}}var $f=(e,t)=>{if(!e.canRead())return;let r={type:"error",range:y.create(e,()=>e.skipRemaining())};return t.err.report(h("error.unparseable-content"),r),r};function Of(){return(e,t)=>{let r=y.create(e,e.string.length),n={type:"file",range:r,children:[],locals:Object.create(null),parserErrors:[]};e.skipWhitespace();let o=t.meta.getParserForLanguageId(t.doc.languageId)(e,t);return o&&o!==G&&n.children.push(o),e.skipWhitespace().canRead()&&n.children.push($f(e,t)),Ie.setParents(n),n.parserErrors=t.err.dump(),n}}var Pg=(e,t,r,n)=>{r.err.report(h("expected",h("float.between",n.min??"-\u221E",n.max??"+\u221E")),e,3)};function Xt(e){return(t,r)=>{let n={type:"float",range:y.create(t),value:0};for((t.peek()==="-"||t.peek()==="+")&&t.skip();t.canRead()&&Se.isDigit(t.peek());)t.skip();if(t.trySkip("."))for(;t.canRead()&&Se.isDigit(t.peek());)t.skip();if(t.peek().toLowerCase()==="e")for(t.skip(),(t.peek()==="-"||t.peek()==="+")&&t.skip();t.canRead()&&Se.isDigit(t.peek());)t.skip();n.range.end=t.cursor;let i=t.sliceToCursor(n.range.start);if(n.value=parseFloat(i)||0,i)e.pattern.test(i)?(e.min&&n.value<e.min||e.max&&n.value>e.max)&&(e.onOutOfRange??Pg)(n,t,r,e):r.err.report(h("parser.float.illegal",e.pattern),n);else{if(e.failsOnEmpty)return G;r.err.report(h("expected",h("float")),n)}return n}}var Dg=(e,t,r,n)=>{r.err.report(h("expected",h("integer.between",n.min??"-\u221E",n.max??"+\u221E")),e,3)};function At(e){return(t,r)=>{let n={type:"integer",range:y.create(t),value:0};for((t.peek()==="-"||t.peek()==="+")&&t.skip();t.canRead()&&Se.isDigit(t.peek());)t.skip();n.range.end=t.cursor;let i=t.sliceToCursor(n.range.start),o=i==="-"||i==="+";if(o||(n.value=Number(i)),i)!e.pattern.test(i)||o?r.err.report(h("parser.integer.illegal",e.pattern),n):(e.min!==void 0&&n.value<e.min||e.max!==void 0&&n.value>e.max)&&(e.onOutOfRange??Dg)(n,t,r,e);else{if(e.failsOnEmpty)return G;r.err.report(h("expected",h("integer")),n)}return n}}function Pr({start:e,value:t,sep:r,trailingSep:n,end:i}){return(o,a)=>{let s={type:"list",range:y.create(o),children:[]};if(o.trySkip(e)){o.skipWhitespace();let l=!1,c=!1;for(;o.canRead()&&o.peek(i.length)!==i;){let u=o.cursor,p;l&&!c&&a.err.report(h("expected",D(r)),o),o.skipWhitespace();let{result:d,endCursor:m,updateSrcAndCtx:_}=mt(t,o,a);d===G||m===o.cursor?a.err.report(h("expected",h("parser.list.value")),y.create(o,()=>o.skipUntilOrEnd(r,i,"\r",`
`))):(_(),p=d);let T;o.skipWhitespace(),l=!0,(c=o.peek(r.length)===r)&&(T=y.create(o,()=>o.skip(r.length))),s.children.push(O(k({type:"item",range:y.create(u,o)},p?{children:[p]}:{}),{value:p,sep:T})),o.skipWhitespace()}c&&!n&&a.err.report(h("parser.list.trailing-sep"),s.children[s.children.length-1].sep),o.trySkip(i)||a.err.report(h("expected",D(i)),o)}else a.err.report(h("expected",D(e)),o);return s.range.end=o.cursor,s}}var Mg=(e,t,r,n)=>{r.err.report(h("expected",h("long.between",n.min??"-\u221E",n.max??"+\u221E")),e,3)};function uo(e){return(t,r)=>{let n={type:"long",range:y.create(t),value:0n};for((t.peek()==="-"||t.peek()==="+")&&t.skip();t.canRead()&&Se.isDigit(t.peek());)t.skip();n.range.end=t.cursor;let i=t.sliceToCursor(n.range.start),o=!1;try{n.value=BigInt(i)}catch{o=!0}if(i)!e.pattern.test(i)||o?r.err.report(h("parser.long.illegal",e.pattern),n):(e.min&&n.value<e.min||e.max&&n.value>e.max)&&(e.onOutOfRange??Mg)(n,t,r,e);else{if(e.failsOnEmpty)return G;r.err.report(h("expected",h("long")),n)}return n}}function Lt({start:e,pair:t,end:r}){return(n,i)=>{let o={type:"record",range:y.create(n),children:[]};if(n.trySkip(e)){n.skipWhitespace();let a=!1,s=!1;for(;n.canRead()&&n.peek(r.length)!==r;){let l=n.cursor,c,u;a&&!s&&i.err.report(h("expected",D(t.end)),n);let p=n.cursor,{result:d,updateSrcAndCtx:m,endCursor:_}=mt(t.key,n,i);d===G||_-p===0&&![t.sep,t.end,r,"\r",`
`,"	"," "].includes(n.peek())?i.err.report(h("expected",h("parser.record.key")),y.create(n,()=>n.skipUntilOrEnd(t.sep,t.end,r,"\r",`
`))):(m(),c=d);let T;n.skipWhitespace(),n.peek(t.sep.length)===t.sep?T=y.create(n,()=>n.skip(t.sep.length)):i.err.report(h("expected",D(t.sep)),n),n.skipWhitespace();let b=typeof t.value=="function"?t.value:t.value.get(o,c),S=n.cursor,{result:z,updateSrcAndCtx:q,endCursor:$}=mt(b,n,i);z===G||$-S===0&&![t.sep,t.end,r,"\r",`
`,"	"," "].includes(n.peek())?i.err.report(h("expected",h("parser.record.value")),y.create(n,()=>n.skipUntilOrEnd(t.sep,t.end,r,"\r",`
`))):(q(),u=z);let J;n.skipWhitespace(),a=!0,(s=n.peek(t.end.length)===t.end)&&(J=y.create(n,()=>n.skip(t.end.length))),o.children.push(O(k({type:"pair",range:y.create(l,n)},c||u?{children:[c,u].filter(pe=>!!pe)}:{}),{key:c,sep:T,value:u,end:J})),n.skipWhitespace()}s&&!t.trailingEnd&&i.err.report(h("parser.record.trailing-end"),o.children[o.children.length-1].end),n.trySkip(r)||i.err.report(h("expected",D(r)),n)}else i.err.report(h("expected",D(e)),n);return o.range.end=n.cursor,o}}var Fg=new Set([" ","\r",`
`,"=",",",'"',"'","{","}","[","]","(",")",";"]),zf=new Set(["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","_","-","."]);function Te(e){return(t,r)=>{let n={type:"resource_location",range:y.create(t),options:e};t.trySkip(W.TagPrefix)&&(n.isTag=!0);let i=t.cursor;for(;t.canReadInLine()&&!Fg.has(t.peek());)t.skip();let o=t.sliceToCursor(i);if(n.range.end=t.cursor,o.length===0)r.err.report(h("expected",h("resource-location")),n);else{let a=o.indexOf(e.namespacePathSep??W.NamespacePathSep);a>=0&&(n.namespace=o.slice(0,a));let s=o.slice(a+1);n.path=s.split(W.PathSep);let l=[...new Set([...[...n.namespace??[]].filter(c=>!zf.has(c)),...[...s].filter(c=>c!=="/"&&!zf.has(c))])];if(l.length&&r.err.report(h("parser.resource-location.illegal",cr(l,!0,"and")),n),n.isTag&&!e.allowTag&&r.err.report(h("parser.resource-location.tag-diallowed"),n),!n.namespace&&e.isPredicate&&r.err.report(h("parser.resource-location.namespace-expected"),n),e.category){let c=W.lengthen(e.namespacePathSep==="."?o.replace(".",W.NamespacePathSep):o);r.symbols.query(r.doc,n.isTag?`tag/${e.category}`:e.category,c).enter({usage:{type:e.usageType,node:n,accessType:e.accessType}})}}return n}}var Af=Vt(va(),1);function Ke(e){return(t,r)=>{let n={type:"string",range:y.create(t),options:e,value:"",valueMap:[]},i=t.cursor;if(e.quotes?.length&&(t.peek()==='"'||t.peek()==="'")){let o=t.read(),a=t.cursor;for(;t.canRead()&&t.peek()!==o;){let s=t.peek();if(e.escapable&&s==="\\"){let l=t.cursor;t.skip();let c=t.read();if(c==="\\"||c===o||ya.is(e.escapable.characters,c))n.valueMap.push({inner:y.create(n.value.length,n.value.length+1),outer:y.create(l,t)}),n.value+=Hu.get(c);else if(e.escapable.unicode&&c==="u"){let u=t.peek(4);/^[0-9a-f]{4}$/i.test(u)?(t.skip(4),n.valueMap.push({inner:y.create(n.value.length,n.value.length+1),outer:y.create(l,t)}),n.value+=String.fromCharCode(parseInt(u,16))):(r.err.report(h("parser.string.illegal-unicode-escape"),y.create(t,t.getCharRange(3).end)),n.valueMap.push({inner:y.create(n.value.length,n.value.length+1),outer:y.create(l,t)}),n.value+=c)}else e.escapable.allowUnknown||r.err.report(h("parser.string.illegal-escape",D(c)),t.getCharRange(-1)),n.valueMap.push({inner:y.create(n.value.length,n.value.length+1),outer:y.create(l,t)}),n.value+=c}else t.skip(),n.value+=s}t.trySkip(o)||r.err.report(h("expected",D(o)),t),e.quotes.includes(o)||r.err.report(h("parser.string.illegal-quote",e.quotes),n),i=a}else if(e.unquotable){for(;t.canRead()&&kc(t.peek(),e.unquotable);)n.value+=t.read();!n.value&&!e.unquotable.allowEmpty&&r.err.report(h("expected",h("string")),t)}else r.err.report(h("expected",e.quotes),t);if(n.valueMap.unshift({inner:y.create(0),outer:y.create(i)}),e.value?.parser){let o=kn(e.value.parser,n.value,n.valueMap,r);o!==G&&(n.children=[o])}return n.range.end=t.cursor,n}}function kn(e,t,r,n){let i=new Se(t,r),o=O(k({},n),{doc:Af.TextDocument.create(n.doc.uri,n.doc.languageId,n.doc.version,t)});return e(i,o)}var Ug=Object.freeze(["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","_",".","+","-"]),Bg=new Set(Ug),Lf=/^[0-9A-Za-z_\.\+\-]*$/,fo={allowEmpty:!0,allowList:Bg},Dr={escapable:{},quotes:['"',"'"],unquotable:fo},vn=Ke(Dr);function kc(e,t){return t.allowList?.has(e)??!t.blockList?.has(e)}function pi(e){let t=Vg(e);return(r,n)=>{let i={type:"symbol",range:y.create(r),options:t,value:r.readRemaining()};if(i.value){let o=t.parentPath?[...t.parentPath,i.value]:[i.value];n.symbols.query(n.doc,t.category,...o).enter({usage:{type:t.usageType,node:i,accessType:t.accessType}})}return i.range.end=r.cursor,i}}function Vg(e){return typeof e=="string"?{category:e}:e}var us=Vt(Pf(),1);function gi(e){let t=e.length;for(;--t>=0;)e[t]=0}var qg=0,wp=1,Zg=2,Hg=3,Kg=258,Kc=29,Ro=256,bo=Ro+1+Kc,hi=30,Gc=19,xp=2*bo+1,wn=15,jc=16,Gg=7,Wc=256,Sp=16,Cp=17,Np=18,Vc=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Xa=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Wg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Rp=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jg=512,hr=new Array((bo+2)*2);gi(hr);var go=new Array(hi*2);gi(go);var ko=new Array(Jg);gi(ko);var vo=new Array(Kg-Hg+1);gi(vo);var Jc=new Array(Kc);gi(Jc);var rs=new Array(hi);gi(rs);function Ec(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}var Tp,jp,Ep;function Oc(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}var Op=e=>e<256?ko[e]:ko[256+(e>>>7)],wo=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},at=(e,t,r)=>{e.bi_valid>jc-r?(e.bi_buf|=t<<e.bi_valid&65535,wo(e,e.bi_buf),e.bi_buf=t>>jc-e.bi_valid,e.bi_valid+=r-jc):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},er=(e,t,r)=>{at(e,r[t*2],r[t*2+1])},$p=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},Yg=e=>{e.bi_valid===16?(wo(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Xg=(e,t)=>{let r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length,c,u,p,d,m,_,T=0;for(d=0;d<=wn;d++)e.bl_count[d]=0;for(r[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<xp;c++)u=e.heap[c],d=r[r[u*2+1]*2+1]+1,d>l&&(d=l,T++),r[u*2+1]=d,!(u>n)&&(e.bl_count[d]++,m=0,u>=s&&(m=a[u-s]),_=r[u*2],e.opt_len+=_*(d+m),o&&(e.static_len+=_*(i[u*2+1]+m)));if(T!==0){do{for(d=l-1;e.bl_count[d]===0;)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,T-=2}while(T>0);for(d=l;d!==0;d--)for(u=e.bl_count[d];u!==0;)p=e.heap[--c],!(p>n)&&(r[p*2+1]!==d&&(e.opt_len+=(d-r[p*2+1])*r[p*2],r[p*2+1]=d),u--)}},zp=(e,t,r)=>{let n=new Array(wn+1),i=0,o,a;for(o=1;o<=wn;o++)n[o]=i=i+r[o-1]<<1;for(a=0;a<=t;a++){let s=e[a*2+1];s!==0&&(e[a*2]=$p(n[s]++,s))}},Qg=()=>{let e,t,r,n,i,o=new Array(wn+1);for(r=0,n=0;n<Kc-1;n++)for(Jc[n]=r,e=0;e<1<<Vc[n];e++)vo[r++]=n;for(vo[r-1]=n,i=0,n=0;n<16;n++)for(rs[n]=i,e=0;e<1<<Xa[n];e++)ko[i++]=n;for(i>>=7;n<hi;n++)for(rs[n]=i<<7,e=0;e<1<<Xa[n]-7;e++)ko[256+i++]=n;for(t=0;t<=wn;t++)o[t]=0;for(e=0;e<=143;)hr[e*2+1]=8,e++,o[8]++;for(;e<=255;)hr[e*2+1]=9,e++,o[9]++;for(;e<=279;)hr[e*2+1]=7,e++,o[7]++;for(;e<=287;)hr[e*2+1]=8,e++,o[8]++;for(zp(hr,bo+1,o),e=0;e<hi;e++)go[e*2+1]=5,go[e*2]=$p(e,5);Tp=new Ec(hr,Vc,Ro+1,bo,wn),jp=new Ec(go,Xa,0,hi,wn),Ep=new Ec(new Array(0),Wg,0,Gc,Gg)},Ap=e=>{let t;for(t=0;t<bo;t++)e.dyn_ltree[t*2]=0;for(t=0;t<hi;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Gc;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Wc*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Lp=e=>{e.bi_valid>8?wo(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},e_=(e,t,r,n)=>{Lp(e),n&&(wo(e,r),wo(e,~r)),e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},Df=(e,t,r,n)=>{let i=t*2,o=r*2;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},$c=(e,t,r)=>{let n=e.heap[r],i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Df(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Df(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},Mf=(e,t,r)=>{let n,i,o=0,a,s;if(e.last_lit!==0)do n=e.pending_buf[e.d_buf+o*2]<<8|e.pending_buf[e.d_buf+o*2+1],i=e.pending_buf[e.l_buf+o],o++,n===0?er(e,i,t):(a=vo[i],er(e,a+Ro+1,t),s=Vc[a],s!==0&&(i-=Jc[a],at(e,i,s)),n--,a=Op(n),er(e,a,r),s=Xa[a],s!==0&&(n-=rs[a],at(e,n,s)));while(o<e.last_lit);er(e,Wc,t)},qc=(e,t)=>{let r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems,a,s,l=-1,c;for(e.heap_len=0,e.heap_max=xp,a=0;a<o;a++)r[a*2]!==0?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):r[a*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,r[c*2]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=n[c*2+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)$c(e,r,a);c=o;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$c(e,r,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,r[c*2]=r[a*2]+r[s*2],e.depth[c]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,r[a*2+1]=r[s*2+1]=c,e.heap[1]=c++,$c(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Xg(e,t),zp(r,l,e.bl_count)},Ff=(e,t,r)=>{let n,i=-1,o,a=t[0*2+1],s=0,l=7,c=4;for(a===0&&(l=138,c=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)o=a,a=t[(n+1)*2+1],!(++s<l&&o===a)&&(s<c?e.bl_tree[o*2]+=s:o!==0?(o!==i&&e.bl_tree[o*2]++,e.bl_tree[Sp*2]++):s<=10?e.bl_tree[Cp*2]++:e.bl_tree[Np*2]++,s=0,i=o,a===0?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4))},Uf=(e,t,r)=>{let n,i=-1,o,a=t[0*2+1],s=0,l=7,c=4;for(a===0&&(l=138,c=3),n=0;n<=r;n++)if(o=a,a=t[(n+1)*2+1],!(++s<l&&o===a)){if(s<c)do er(e,o,e.bl_tree);while(--s!==0);else o!==0?(o!==i&&(er(e,o,e.bl_tree),s--),er(e,Sp,e.bl_tree),at(e,s-3,2)):s<=10?(er(e,Cp,e.bl_tree),at(e,s-3,3)):(er(e,Np,e.bl_tree),at(e,s-11,7));s=0,i=o,a===0?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4)}},t_=e=>{let t;for(Ff(e,e.dyn_ltree,e.l_desc.max_code),Ff(e,e.dyn_dtree,e.d_desc.max_code),qc(e,e.bl_desc),t=Gc-1;t>=3&&e.bl_tree[Rp[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},r_=(e,t,r,n)=>{let i;for(at(e,t-257,5),at(e,r-1,5),at(e,n-4,4),i=0;i<n;i++)at(e,e.bl_tree[Rp[i]*2+1],3);Uf(e,e.dyn_ltree,t-1),Uf(e,e.dyn_dtree,r-1)},n_=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(r=32;r<Ro;r++)if(e.dyn_ltree[r*2]!==0)return 1;return 0},Bf=!1,i_=e=>{Bf||(Qg(),Bf=!0),e.l_desc=new Oc(e.dyn_ltree,Tp),e.d_desc=new Oc(e.dyn_dtree,jp),e.bl_desc=new Oc(e.bl_tree,Ep),e.bi_buf=0,e.bi_valid=0,Ap(e)},Ip=(e,t,r,n)=>{at(e,(qg<<1)+(n?1:0),3),e_(e,t,r,!0)},o_=e=>{at(e,wp<<1,3),er(e,Wc,hr),Yg(e)},a_=(e,t,r,n)=>{let i,o,a=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=n_(e)),qc(e,e.l_desc),qc(e,e.d_desc),a=t_(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&t!==-1?Ip(e,t,r,n):e.strategy===4||o===i?(at(e,(wp<<1)+(n?1:0),3),Mf(e,hr,go)):(at(e,(Zg<<1)+(n?1:0),3),r_(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Mf(e,e.dyn_ltree,e.dyn_dtree)),Ap(e),n&&Lp(e)},s_=(e,t,r)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=r&255,e.last_lit++,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(vo[r]+Ro+1)*2]++,e.dyn_dtree[Op(t)*2]++),e.last_lit===e.lit_bufsize-1),c_=i_,l_=Ip,u_=a_,f_=s_,p_=o_,d_={_tr_init:c_,_tr_stored_block:l_,_tr_flush_block:u_,_tr_tally:f_,_tr_align:p_},m_=(e,t,r,n)=>{let i=e&65535|0,o=e>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do i=i+t[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0},xo=m_,h_=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},g_=new Uint32Array(h_()),__=(e,t,r,n)=>{let i=g_,o=n+r;e^=-1;for(let a=n;a<o;a++)e=e>>>8^i[(e^t[a])&255];return e^-1},Pe=__,Sn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Tn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:y_,_tr_stored_block:b_,_tr_flush_block:k_,_tr_tally:Vr,_tr_align:v_}=d_,{Z_NO_FLUSH:jn,Z_PARTIAL_FLUSH:w_,Z_FULL_FLUSH:x_,Z_FINISH:qr,Z_BLOCK:Vf,Z_OK:tr,Z_STREAM_END:qf,Z_STREAM_ERROR:Nt,Z_DATA_ERROR:S_,Z_BUF_ERROR:zc,Z_DEFAULT_COMPRESSION:C_,Z_FILTERED:N_,Z_HUFFMAN_ONLY:Ka,Z_RLE:R_,Z_FIXED:T_,Z_DEFAULT_STRATEGY:j_,Z_UNKNOWN:E_,Z_DEFLATED:os}=Tn,O_=9,$_=15,z_=8,A_=29,L_=256,Zc=L_+1+A_,I_=30,P_=19,D_=2*Zc+1,M_=15,ae=3,Ur=258,It=Ur+ae+1,F_=32,as=42,Hc=69,Qa=73,es=91,ts=103,xn=113,mo=666,Le=1,To=2,Cn=3,_i=4,U_=3,Br=(e,t)=>(e.msg=Sn[t],t),Zf=e=>(e<<1)-(e>4?9:0),Fr=e=>{let t=e.length;for(;--t>=0;)e[t]=0},B_=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,Zr=B_,Mr=e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Be=(e,t)=>{k_(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Mr(e.strm)},fe=(e,t)=>{e.pending_buf[e.pending++]=t},po=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},V_=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),e.state.wrap===1?e.adler=xo(e.adler,t,i,r):e.state.wrap===2&&(e.adler=Pe(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},Pp=(e,t)=>{let r=e.max_chain_length,n=e.strstart,i,o,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-It?e.strstart-(e.w_size-It):0,c=e.window,u=e.w_mask,p=e.prev,d=e.strstart+Ur,m=c[n+a-1],_=c[n+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do if(i=t,!(c[i+a]!==_||c[i+a-1]!==m||c[i]!==c[n]||c[++i]!==c[n+1])){n+=2,i++;do;while(c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&n<d);if(o=Ur-(d-n),n=d-Ur,o>a){if(e.match_start=t,a=o,o>=s)break;m=c[n+a-1],_=c[n+a]}}while((t=p[t&u])>l&&--r!==0);return a<=e.lookahead?a:e.lookahead},Nn=e=>{let t=e.w_size,r,n,i,o,a;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-It)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,n=e.hash_size,r=n;do i=e.head[--r],e.head[r]=i>=t?i-t:0;while(--n);n=t,r=n;do i=e.prev[--r],e.prev[r]=i>=t?i-t:0;while(--n);o+=t}if(e.strm.avail_in===0)break;if(n=V_(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=n,e.lookahead+e.insert>=ae)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=Zr(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=Zr(e,e.ins_h,e.window[a+ae-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<ae)););}while(e.lookahead<It&&e.strm.avail_in!==0)},q_=(e,t)=>{let r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Nn(e),e.lookahead===0&&t===jn)return Le;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;let n=e.block_start+r;if((e.strstart===0||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,Be(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-It&&(Be(e,!1),e.strm.avail_out===0))return Le}return e.insert=0,t===qr?(Be(e,!0),e.strm.avail_out===0?Cn:_i):(e.strstart>e.block_start&&(Be(e,!1),e.strm.avail_out===0),Le)},Ac=(e,t)=>{let r,n;for(;;){if(e.lookahead<It){if(Nn(e),e.lookahead<It&&t===jn)return Le;if(e.lookahead===0)break}if(r=0,e.lookahead>=ae&&(e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+ae-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-It&&(e.match_length=Pp(e,r)),e.match_length>=ae)if(n=Vr(e,e.strstart-e.match_start,e.match_length-ae),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ae){e.match_length--;do e.strstart++,e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+ae-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+1]);else n=Vr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Be(e,!1),e.strm.avail_out===0))return Le}return e.insert=e.strstart<ae-1?e.strstart:ae-1,t===qr?(Be(e,!0),e.strm.avail_out===0?Cn:_i):e.last_lit&&(Be(e,!1),e.strm.avail_out===0)?Le:To},di=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<It){if(Nn(e),e.lookahead<It&&t===jn)return Le;if(e.lookahead===0)break}if(r=0,e.lookahead>=ae&&(e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+ae-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ae-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-It&&(e.match_length=Pp(e,r),e.match_length<=5&&(e.strategy===N_||e.match_length===ae&&e.strstart-e.match_start>4096)&&(e.match_length=ae-1)),e.prev_length>=ae&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-ae,n=Vr(e,e.strstart-1-e.prev_match,e.prev_length-ae),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+ae-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ae-1,e.strstart++,n&&(Be(e,!1),e.strm.avail_out===0))return Le}else if(e.match_available){if(n=Vr(e,0,e.window[e.strstart-1]),n&&Be(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Le}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Vr(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ae-1?e.strstart:ae-1,t===qr?(Be(e,!0),e.strm.avail_out===0?Cn:_i):e.last_lit&&(Be(e,!1),e.strm.avail_out===0)?Le:To},Z_=(e,t)=>{let r,n,i,o,a=e.window;for(;;){if(e.lookahead<=Ur){if(Nn(e),e.lookahead<=Ur&&t===jn)return Le;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ae&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+Ur;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=Ur-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ae?(r=Vr(e,1,e.match_length-ae),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Vr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Be(e,!1),e.strm.avail_out===0))return Le}return e.insert=0,t===qr?(Be(e,!0),e.strm.avail_out===0?Cn:_i):e.last_lit&&(Be(e,!1),e.strm.avail_out===0)?Le:To},H_=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Nn(e),e.lookahead===0)){if(t===jn)return Le;break}if(e.match_length=0,r=Vr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Be(e,!1),e.strm.avail_out===0))return Le}return e.insert=0,t===qr?(Be(e,!0),e.strm.avail_out===0?Cn:_i):e.last_lit&&(Be(e,!1),e.strm.avail_out===0)?Le:To};function Qt(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}var ho=[new Qt(0,0,0,0,q_),new Qt(4,4,8,4,Ac),new Qt(4,5,16,8,Ac),new Qt(4,6,32,32,Ac),new Qt(4,4,16,16,di),new Qt(8,16,32,32,di),new Qt(8,16,128,128,di),new Qt(8,32,128,256,di),new Qt(32,128,258,1024,di),new Qt(32,258,258,4096,di)],K_=e=>{e.window_size=2*e.w_size,Fr(e.head),e.max_lazy_match=ho[e.level].max_lazy,e.good_match=ho[e.level].good_length,e.nice_match=ho[e.level].nice_length,e.max_chain_length=ho[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ae-1,e.match_available=0,e.ins_h=0};function G_(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=os,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(D_*2),this.dyn_dtree=new Uint16Array((2*I_+1)*2),this.bl_tree=new Uint16Array((2*P_+1)*2),Fr(this.dyn_ltree),Fr(this.dyn_dtree),Fr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(M_+1),this.heap=new Uint16Array(2*Zc+1),Fr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Zc+1),Fr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Dp=e=>{if(!e||!e.state)return Br(e,Nt);e.total_in=e.total_out=0,e.data_type=E_;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?as:xn,e.adler=t.wrap===2?0:1,t.last_flush=jn,y_(t),tr},Mp=e=>{let t=Dp(e);return t===tr&&K_(e.state),t},W_=(e,t)=>!e||!e.state||e.state.wrap!==2?Nt:(e.state.gzhead=t,tr),Fp=(e,t,r,n,i,o)=>{if(!e)return Nt;let a=1;if(t===C_&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>O_||r!==os||n<8||n>15||t<0||t>9||o<0||o>T_)return Br(e,Nt);n===8&&(n=9);let s=new G_;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+ae-1)/ae),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=(1+2)*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,Mp(e)},J_=(e,t)=>Fp(e,t,os,$_,z_,j_),Y_=(e,t)=>{let r,n;if(!e||!e.state||t>Vf||t<0)return e?Br(e,Nt):Nt;let i=e.state;if(!e.output||!e.input&&e.avail_in!==0||i.status===mo&&t!==qr)return Br(e,e.avail_out===0?zc:Nt);i.strm=e;let o=i.last_flush;if(i.last_flush=t,i.status===as)if(i.wrap===2)e.adler=0,fe(i,31),fe(i,139),fe(i,8),i.gzhead?(fe(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),fe(i,i.gzhead.time&255),fe(i,i.gzhead.time>>8&255),fe(i,i.gzhead.time>>16&255),fe(i,i.gzhead.time>>24&255),fe(i,i.level===9?2:i.strategy>=Ka||i.level<2?4:0),fe(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(fe(i,i.gzhead.extra.length&255),fe(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Pe(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Hc):(fe(i,0),fe(i,0),fe(i,0),fe(i,0),fe(i,0),fe(i,i.level===9?2:i.strategy>=Ka||i.level<2?4:0),fe(i,U_),i.status=xn);else{let a=os+(i.w_bits-8<<4)<<8,s=-1;i.strategy>=Ka||i.level<2?s=0:i.level<6?s=1:i.level===6?s=2:s=3,a|=s<<6,i.strstart!==0&&(a|=F_),a+=31-a%31,i.status=xn,po(i,a),i.strstart!==0&&(po(i,e.adler>>>16),po(i,e.adler&65535)),e.adler=1}if(i.status===Hc)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Pe(e.adler,i.pending_buf,i.pending-r,r)),Mr(e),r=i.pending,i.pending===i.pending_buf_size));)fe(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(e.adler=Pe(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Qa)}else i.status=Qa;if(i.status===Qa)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Pe(e.adler,i.pending_buf,i.pending-r,r)),Mr(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,fe(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=Pe(e.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=es)}else i.status=es;if(i.status===es)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Pe(e.adler,i.pending_buf,i.pending-r,r)),Mr(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,fe(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=Pe(e.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=ts)}else i.status=ts;if(i.status===ts&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Mr(e),i.pending+2<=i.pending_buf_size&&(fe(i,e.adler&255),fe(i,e.adler>>8&255),e.adler=0,i.status=xn)):i.status=xn),i.pending!==0){if(Mr(e),e.avail_out===0)return i.last_flush=-1,tr}else if(e.avail_in===0&&Zf(t)<=Zf(o)&&t!==qr)return Br(e,zc);if(i.status===mo&&e.avail_in!==0)return Br(e,zc);if(e.avail_in!==0||i.lookahead!==0||t!==jn&&i.status!==mo){let a=i.strategy===Ka?H_(i,t):i.strategy===R_?Z_(i,t):ho[i.level].func(i,t);if((a===Cn||a===_i)&&(i.status=mo),a===Le||a===Cn)return e.avail_out===0&&(i.last_flush=-1),tr;if(a===To&&(t===w_?v_(i):t!==Vf&&(b_(i,0,0,!1),t===x_&&(Fr(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Mr(e),e.avail_out===0))return i.last_flush=-1,tr}return t!==qr?tr:i.wrap<=0?qf:(i.wrap===2?(fe(i,e.adler&255),fe(i,e.adler>>8&255),fe(i,e.adler>>16&255),fe(i,e.adler>>24&255),fe(i,e.total_in&255),fe(i,e.total_in>>8&255),fe(i,e.total_in>>16&255),fe(i,e.total_in>>24&255)):(po(i,e.adler>>>16),po(i,e.adler&65535)),Mr(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?tr:qf)},X_=e=>{if(!e||!e.state)return Nt;let t=e.state.status;return t!==as&&t!==Hc&&t!==Qa&&t!==es&&t!==ts&&t!==xn&&t!==mo?Br(e,Nt):(e.state=null,t===xn?Br(e,S_):tr)},Q_=(e,t)=>{let r=t.length;if(!e||!e.state)return Nt;let n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==as||n.lookahead)return Nt;if(i===1&&(e.adler=xo(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){i===0&&(Fr(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(t.subarray(r-n.w_size,r),0),t=l,r=n.w_size}let o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Nn(n);n.lookahead>=ae;){let l=n.strstart,c=n.lookahead-(ae-1);do n.ins_h=Zr(n,n.ins_h,n.window[l+ae-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=ae-1,Nn(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=ae-1,n.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,n.wrap=i,tr},ey=J_,ty=Fp,ry=Mp,ny=Dp,iy=W_,oy=Y_,ay=X_,sy=Q_,cy="pako deflate (from Nodeca project)",_o={deflateInit:ey,deflateInit2:ty,deflateReset:ry,deflateResetKeep:ny,deflateSetHeader:iy,deflate:oy,deflateEnd:ay,deflateSetDictionary:sy,deflateInfo:cy},ly=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),uy=function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let n in r)ly(r,n)&&(e[n]=r[n])}}return e},fy=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;let r=new Uint8Array(t);for(let n=0,i=0,o=e.length;n<o;n++){let a=e[n];r.set(a,i),i+=a.length}return r},ss={assign:uy,flattenChunks:fy},Up=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Up=!1}var So=new Uint8Array(256);for(let e=0;e<256;e++)So[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;So[254]=So[254]=1;var py=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|r&63):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|r&63):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|r&63);return t},dy=(e,t)=>{if(t<65534&&e.subarray&&Up)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},my=(e,t)=>{let r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i,o=new Array(r*2);for(i=0,n=0;n<r;){let a=e[n++];if(a<128){o[i++]=a;continue}let s=So[a];if(s>4){o[i++]=65533,n+=s-1;continue}for(a&=s===2?31:s===3?15:7;s>1&&n<r;)a=a<<6|e[n++]&63,s--;if(s>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return dy(o,i)},hy=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+So[e[r]]>t?r:t},Co={string2buf:py,buf2string:my,utf8border:hy};function gy(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Bp=gy,Vp=Object.prototype.toString,{Z_NO_FLUSH:_y,Z_SYNC_FLUSH:yy,Z_FULL_FLUSH:by,Z_FINISH:ky,Z_OK:ns,Z_STREAM_END:vy,Z_DEFAULT_COMPRESSION:wy,Z_DEFAULT_STRATEGY:xy,Z_DEFLATED:Sy}=Tn;function jo(e){this.options=ss.assign({level:wy,method:Sy,chunkSize:16384,windowBits:15,memLevel:8,strategy:xy},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bp,this.strm.avail_out=0;let r=_o.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==ns)throw new Error(Sn[r]);if(t.header&&_o.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Co.string2buf(t.dictionary):Vp.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=_o.deflateSetDictionary(this.strm,n),r!==ns)throw new Error(Sn[r]);this._dict_set=!0}}jo.prototype.push=function(e,t){let r=this.strm,n=this.options.chunkSize,i,o;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?ky:_y,typeof e=="string"?r.input=Co.string2buf(e):Vp.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===yy||o===by)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=_o.deflate(r,o),i===vy)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=_o.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===ns;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};jo.prototype.onData=function(e){this.chunks.push(e)};jo.prototype.onEnd=function(e){e===ns&&(this.result=ss.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Yc(e,t){let r=new jo(t);if(r.push(e,!0),r.err)throw r.msg||Sn[r.err];return r.result}function Cy(e,t){return t=t||{},t.raw=!0,Yc(e,t)}function Ny(e,t){return t=t||{},t.gzip=!0,Yc(e,t)}var Ry=jo,Ty=Yc,jy=Cy,Ey=Ny,Oy=Tn,$y={Deflate:Ry,deflate:Ty,deflateRaw:jy,gzip:Ey,constants:Oy},Ga=30,zy=12,Ay=function(t,r){let n,i,o,a,s,l,c,u,p,d,m,_,T,b,S,z,q,$,J,pe,R,A,H,Y,ne=t.state;n=t.next_in,H=t.input,i=n+(t.avail_in-5),o=t.next_out,Y=t.output,a=o-(r-t.avail_out),s=o+(t.avail_out-257),l=ne.dmax,c=ne.wsize,u=ne.whave,p=ne.wnext,d=ne.window,m=ne.hold,_=ne.bits,T=ne.lencode,b=ne.distcode,S=(1<<ne.lenbits)-1,z=(1<<ne.distbits)-1;e:do{_<15&&(m+=H[n++]<<_,_+=8,m+=H[n++]<<_,_+=8),q=T[m&S];t:for(;;){if($=q>>>24,m>>>=$,_-=$,$=q>>>16&255,$===0)Y[o++]=q&65535;else if($&16){J=q&65535,$&=15,$&&(_<$&&(m+=H[n++]<<_,_+=8),J+=m&(1<<$)-1,m>>>=$,_-=$),_<15&&(m+=H[n++]<<_,_+=8,m+=H[n++]<<_,_+=8),q=b[m&z];r:for(;;){if($=q>>>24,m>>>=$,_-=$,$=q>>>16&255,$&16){if(pe=q&65535,$&=15,_<$&&(m+=H[n++]<<_,_+=8,_<$&&(m+=H[n++]<<_,_+=8)),pe+=m&(1<<$)-1,pe>l){t.msg="invalid distance too far back",ne.mode=Ga;break e}if(m>>>=$,_-=$,$=o-a,pe>$){if($=pe-$,$>u&&ne.sane){t.msg="invalid distance too far back",ne.mode=Ga;break e}if(R=0,A=d,p===0){if(R+=c-$,$<J){J-=$;do Y[o++]=d[R++];while(--$);R=o-pe,A=Y}}else if(p<$){if(R+=c+p-$,$-=p,$<J){J-=$;do Y[o++]=d[R++];while(--$);if(R=0,p<J){$=p,J-=$;do Y[o++]=d[R++];while(--$);R=o-pe,A=Y}}}else if(R+=p-$,$<J){J-=$;do Y[o++]=d[R++];while(--$);R=o-pe,A=Y}for(;J>2;)Y[o++]=A[R++],Y[o++]=A[R++],Y[o++]=A[R++],J-=3;J&&(Y[o++]=A[R++],J>1&&(Y[o++]=A[R++]))}else{R=o-pe;do Y[o++]=Y[R++],Y[o++]=Y[R++],Y[o++]=Y[R++],J-=3;while(J>2);J&&(Y[o++]=Y[R++],J>1&&(Y[o++]=Y[R++]))}}else if(($&64)===0){q=b[(q&65535)+(m&(1<<$)-1)];continue r}else{t.msg="invalid distance code",ne.mode=Ga;break e}break}}else if(($&64)===0){q=T[(q&65535)+(m&(1<<$)-1)];continue t}else if($&32){ne.mode=zy;break e}else{t.msg="invalid literal/length code",ne.mode=Ga;break e}break}}while(n<i&&o<s);J=_>>3,n-=J,_-=J<<3,m&=(1<<_)-1,t.next_in=n,t.next_out=o,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=o<s?257+(s-o):257-(o-s),ne.hold=m,ne.bits=_},mi=15,Hf=852,Kf=592,Gf=0,Lc=1,Wf=2,Ly=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Iy=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Py=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Dy=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),My=(e,t,r,n,i,o,a,s)=>{let l=s.bits,c=0,u=0,p=0,d=0,m=0,_=0,T=0,b=0,S=0,z=0,q,$,J,pe,R,A=null,H=0,Y,ne=new Uint16Array(mi+1),tn=new Uint16Array(mi+1),oa=null,Tu=0,ju,aa,sa;for(c=0;c<=mi;c++)ne[c]=0;for(u=0;u<n;u++)ne[t[r+u]]++;for(m=l,d=mi;d>=1&&ne[d]===0;d--);if(m>d&&(m=d),d===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,s.bits=1,0;for(p=1;p<d&&ne[p]===0;p++);for(m<p&&(m=p),b=1,c=1;c<=mi;c++)if(b<<=1,b-=ne[c],b<0)return-1;if(b>0&&(e===Gf||d!==1))return-1;for(tn[1]=0,c=1;c<mi;c++)tn[c+1]=tn[c]+ne[c];for(u=0;u<n;u++)t[r+u]!==0&&(a[tn[t[r+u]]++]=u);if(e===Gf?(A=oa=a,Y=19):e===Lc?(A=Ly,H-=257,oa=Iy,Tu-=257,Y=256):(A=Py,oa=Dy,Y=-1),z=0,u=0,c=p,R=o,_=m,T=0,J=-1,S=1<<m,pe=S-1,e===Lc&&S>Hf||e===Wf&&S>Kf)return 1;for(;;){ju=c-T,a[u]<Y?(aa=0,sa=a[u]):a[u]>Y?(aa=oa[Tu+a[u]],sa=A[H+a[u]]):(aa=32+64,sa=0),q=1<<c-T,$=1<<_,p=$;do $-=q,i[R+(z>>T)+$]=ju<<24|aa<<16|sa|0;while($!==0);for(q=1<<c-1;z&q;)q>>=1;if(q!==0?(z&=q-1,z+=q):z=0,u++,--ne[c]===0){if(c===d)break;c=t[r+a[u]]}if(c>m&&(z&pe)!==J){for(T===0&&(T=m),R+=p,_=c-T,b=1<<_;_+T<d&&(b-=ne[_+T],!(b<=0));)_++,b<<=1;if(S+=1<<_,e===Lc&&S>Hf||e===Wf&&S>Kf)return 1;J=z&pe,i[J]=m<<24|_<<16|R-o|0}}return z!==0&&(i[R+z]=c-T<<24|64<<16|0),s.bits=m,0},yo=My,Fy=0,qp=1,Zp=2,{Z_FINISH:Jf,Z_BLOCK:Uy,Z_TREES:Wa,Z_OK:Rn,Z_STREAM_END:By,Z_NEED_DICT:Vy,Z_STREAM_ERROR:Rt,Z_DATA_ERROR:Hp,Z_MEM_ERROR:Kp,Z_BUF_ERROR:qy,Z_DEFLATED:Yf}=Tn,Gp=1,Xf=2,Qf=3,ep=4,tp=5,rp=6,np=7,ip=8,op=9,ap=10,is=11,mr=12,Ic=13,sp=14,Pc=15,cp=16,lp=17,up=18,fp=19,Ja=20,Ya=21,pp=22,dp=23,mp=24,hp=25,gp=26,Dc=27,_p=28,yp=29,we=30,Wp=31,Zy=32,Hy=852,Ky=592,Gy=15,Wy=Gy,bp=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Jy(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Jp=e=>{if(!e||!e.state)return Rt;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Gp,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Hy),t.distcode=t.distdyn=new Int32Array(Ky),t.sane=1,t.back=-1,Rn},Yp=e=>{if(!e||!e.state)return Rt;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Jp(e)},Xp=(e,t)=>{let r;if(!e||!e.state)return Rt;let n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?Rt:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Yp(e))},Qp=(e,t)=>{if(!e)return Rt;let r=new Jy;e.state=r,r.window=null;let n=Xp(e,t);return n!==Rn&&(e.state=null),n},Yy=e=>Qp(e,Wy),kp=!0,Mc,Fc,Xy=e=>{if(kp){Mc=new Int32Array(512),Fc=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(yo(qp,e.lens,0,288,Mc,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;yo(Zp,e.lens,0,32,Fc,0,e.work,{bits:5}),kp=!1}e.lencode=Mc,e.lenbits=9,e.distcode=Fc,e.distbits=5},ed=(e,t,r,n)=>{let i,o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},Qy=(e,t)=>{let r,n,i,o,a,s,l,c,u,p,d,m,_,T,b=0,S,z,q,$,J,pe,R,A,H=new Uint8Array(4),Y,ne,tn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Rt;r=e.state,r.mode===mr&&(r.mode=Ic),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,p=s,d=l,A=Rn;e:for(;;)switch(r.mode){case Gp:if(r.wrap===0){r.mode=Ic;break}for(;u<16;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(r.wrap&2&&c===35615){r.check=0,H[0]=c&255,H[1]=c>>>8&255,r.check=Pe(r.check,H,2,0),c=0,u=0,r.mode=Xf;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=we;break}if((c&15)!==Yf){e.msg="unknown compression method",r.mode=we;break}if(c>>>=4,u-=4,R=(c&15)+8,r.wbits===0)r.wbits=R;else if(R>r.wbits){e.msg="invalid window size",r.mode=we;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=c&512?ap:mr,c=0,u=0;break;case Xf:for(;u<16;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,(r.flags&255)!==Yf){e.msg="unknown compression method",r.mode=we;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=we;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&(H[0]=c&255,H[1]=c>>>8&255,r.check=Pe(r.check,H,2,0)),c=0,u=0,r.mode=Qf;case Qf:for(;u<32;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),r.flags&512&&(H[0]=c&255,H[1]=c>>>8&255,H[2]=c>>>16&255,H[3]=c>>>24&255,r.check=Pe(r.check,H,4,0)),c=0,u=0,r.mode=ep;case ep:for(;u<16;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&(H[0]=c&255,H[1]=c>>>8&255,r.check=Pe(r.check,H,2,0)),c=0,u=0,r.mode=tp;case tp:if(r.flags&1024){for(;u<16;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&(H[0]=c&255,H[1]=c>>>8&255,r.check=Pe(r.check,H,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=rp;case rp:if(r.flags&1024&&(m=r.length,m>s&&(m=s),m&&(r.head&&(R=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+m),R)),r.flags&512&&(r.check=Pe(r.check,n,m,o)),s-=m,o+=m,r.length-=m),r.length))break e;r.length=0,r.mode=np;case np:if(r.flags&2048){if(s===0)break e;m=0;do R=n[o+m++],r.head&&R&&r.length<65536&&(r.head.name+=String.fromCharCode(R));while(R&&m<s);if(r.flags&512&&(r.check=Pe(r.check,n,m,o)),s-=m,o+=m,R)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=ip;case ip:if(r.flags&4096){if(s===0)break e;m=0;do R=n[o+m++],r.head&&R&&r.length<65536&&(r.head.comment+=String.fromCharCode(R));while(R&&m<s);if(r.flags&512&&(r.check=Pe(r.check,n,m,o)),s-=m,o+=m,R)break e}else r.head&&(r.head.comment=null);r.mode=op;case op:if(r.flags&512){for(;u<16;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=we;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=mr;break;case ap:for(;u<32;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=bp(c),c=0,u=0,r.mode=is;case is:if(r.havedict===0)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,Vy;e.adler=r.check=1,r.mode=mr;case mr:if(t===Uy||t===Wa)break e;case Ic:if(r.last){c>>>=u&7,u-=u&7,r.mode=Dc;break}for(;u<3;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=c&1,c>>>=1,u-=1,c&3){case 0:r.mode=sp;break;case 1:if(Xy(r),r.mode=Ja,t===Wa){c>>>=2,u-=2;break e}break;case 2:r.mode=lp;break;case 3:e.msg="invalid block type",r.mode=we}c>>>=2,u-=2;break;case sp:for(c>>>=u&7,u-=u&7;u<32;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=we;break}if(r.length=c&65535,c=0,u=0,r.mode=Pc,t===Wa)break e;case Pc:r.mode=cp;case cp:if(m=r.length,m){if(m>s&&(m=s),m>l&&(m=l),m===0)break e;i.set(n.subarray(o,o+m),a),s-=m,o+=m,l-=m,a+=m,r.length-=m;break}r.mode=mr;break;case lp:for(;u<14;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=(c&31)+257,c>>>=5,u-=5,r.ndist=(c&31)+1,c>>>=5,u-=5,r.ncode=(c&15)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=we;break}r.have=0,r.mode=up;case up:for(;r.have<r.ncode;){for(;u<3;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}r.lens[tn[r.have++]]=c&7,c>>>=3,u-=3}for(;r.have<19;)r.lens[tn[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Y={bits:r.lenbits},A=yo(Fy,r.lens,0,19,r.lencode,0,r.work,Y),r.lenbits=Y.bits,A){e.msg="invalid code lengths set",r.mode=we;break}r.have=0,r.mode=fp;case fp:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[c&(1<<r.lenbits)-1],S=b>>>24,z=b>>>16&255,q=b&65535,!(S<=u);){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(q<16)c>>>=S,u-=S,r.lens[r.have++]=q;else{if(q===16){for(ne=S+2;u<ne;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=S,u-=S,r.have===0){e.msg="invalid bit length repeat",r.mode=we;break}R=r.lens[r.have-1],m=3+(c&3),c>>>=2,u-=2}else if(q===17){for(ne=S+3;u<ne;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}c>>>=S,u-=S,R=0,m=3+(c&7),c>>>=3,u-=3}else{for(ne=S+7;u<ne;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}c>>>=S,u-=S,R=0,m=11+(c&127),c>>>=7,u-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=we;break}for(;m--;)r.lens[r.have++]=R}}if(r.mode===we)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=we;break}if(r.lenbits=9,Y={bits:r.lenbits},A=yo(qp,r.lens,0,r.nlen,r.lencode,0,r.work,Y),r.lenbits=Y.bits,A){e.msg="invalid literal/lengths set",r.mode=we;break}if(r.distbits=6,r.distcode=r.distdyn,Y={bits:r.distbits},A=yo(Zp,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Y),r.distbits=Y.bits,A){e.msg="invalid distances set",r.mode=we;break}if(r.mode=Ja,t===Wa)break e;case Ja:r.mode=Ya;case Ya:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,Ay(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===mr&&(r.back=-1);break}for(r.back=0;b=r.lencode[c&(1<<r.lenbits)-1],S=b>>>24,z=b>>>16&255,q=b&65535,!(S<=u);){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(z&&(z&240)===0){for($=S,J=z,pe=q;b=r.lencode[pe+((c&(1<<$+J)-1)>>$)],S=b>>>24,z=b>>>16&255,q=b&65535,!($+S<=u);){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}c>>>=$,u-=$,r.back+=$}if(c>>>=S,u-=S,r.back+=S,r.length=q,z===0){r.mode=gp;break}if(z&32){r.back=-1,r.mode=mr;break}if(z&64){e.msg="invalid literal/length code",r.mode=we;break}r.extra=z&15,r.mode=pp;case pp:if(r.extra){for(ne=r.extra;u<ne;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=dp;case dp:for(;b=r.distcode[c&(1<<r.distbits)-1],S=b>>>24,z=b>>>16&255,q=b&65535,!(S<=u);){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if((z&240)===0){for($=S,J=z,pe=q;b=r.distcode[pe+((c&(1<<$+J)-1)>>$)],S=b>>>24,z=b>>>16&255,q=b&65535,!($+S<=u);){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}c>>>=$,u-=$,r.back+=$}if(c>>>=S,u-=S,r.back+=S,z&64){e.msg="invalid distance code",r.mode=we;break}r.offset=q,r.extra=z&15,r.mode=mp;case mp:if(r.extra){for(ne=r.extra;u<ne;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=we;break}r.mode=hp;case hp:if(l===0)break e;if(m=d-l,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=we;break}m>r.wnext?(m-=r.wnext,_=r.wsize-m):_=r.wnext-m,m>r.length&&(m=r.length),T=r.window}else T=i,_=a-r.offset,m=r.length;m>l&&(m=l),l-=m,r.length-=m;do i[a++]=T[_++];while(--m);r.length===0&&(r.mode=Ya);break;case gp:if(l===0)break e;i[a++]=r.length,l--,r.mode=Ya;break;case Dc:if(r.wrap){for(;u<32;){if(s===0)break e;s--,c|=n[o++]<<u,u+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?Pe(r.check,i,d,a-d):xo(r.check,i,d,a-d)),d=l,(r.flags?c:bp(c))!==r.check){e.msg="incorrect data check",r.mode=we;break}c=0,u=0}r.mode=_p;case _p:if(r.wrap&&r.flags){for(;u<32;){if(s===0)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=we;break}c=0,u=0}r.mode=yp;case yp:A=By;break e;case we:A=Hp;break e;case Wp:return Kp;case Zy:default:return Rt}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<we&&(r.mode<Dc||t!==Jf))&&ed(e,e.output,e.next_out,d-e.avail_out),p-=e.avail_in,d-=e.avail_out,e.total_in+=p,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?Pe(r.check,i,d,e.next_out-d):xo(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===mr?128:0)+(r.mode===Ja||r.mode===Pc?256:0),(p===0&&d===0||t===Jf)&&A===Rn&&(A=qy),A},eb=e=>{if(!e||!e.state)return Rt;let t=e.state;return t.window&&(t.window=null),e.state=null,Rn},tb=(e,t)=>{if(!e||!e.state)return Rt;let r=e.state;return(r.wrap&2)===0?Rt:(r.head=t,t.done=!1,Rn)},rb=(e,t)=>{let r=t.length,n,i,o;return!e||!e.state||(n=e.state,n.wrap!==0&&n.mode!==is)?Rt:n.mode===is&&(i=1,i=xo(i,t,r,0),i!==n.check)?Hp:(o=ed(e,t,r,r),o?(n.mode=Wp,Kp):(n.havedict=1,Rn))},nb=Yp,ib=Xp,ob=Jp,ab=Yy,sb=Qp,cb=Qy,lb=eb,ub=tb,fb=rb,pb="pako inflate (from Nodeca project)",gr={inflateReset:nb,inflateReset2:ib,inflateResetKeep:ob,inflateInit:ab,inflateInit2:sb,inflate:cb,inflateEnd:lb,inflateGetHeader:ub,inflateSetDictionary:fb,inflateInfo:pb};function db(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var mb=db,td=Object.prototype.toString,{Z_NO_FLUSH:hb,Z_FINISH:gb,Z_OK:No,Z_STREAM_END:Uc,Z_NEED_DICT:Bc,Z_STREAM_ERROR:_b,Z_DATA_ERROR:vp,Z_MEM_ERROR:yb}=Tn;function Eo(e){this.options=ss.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bp,this.strm.avail_out=0;let r=gr.inflateInit2(this.strm,t.windowBits);if(r!==No)throw new Error(Sn[r]);if(this.header=new mb,gr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Co.string2buf(t.dictionary):td.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=gr.inflateSetDictionary(this.strm,t.dictionary),r!==No)))throw new Error(Sn[r])}Eo.prototype.push=function(e,t){let r=this.strm,n=this.options.chunkSize,i=this.options.dictionary,o,a,s;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?gb:hb,td.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=gr.inflate(r,a),o===Bc&&i&&(o=gr.inflateSetDictionary(r,i),o===No?o=gr.inflate(r,a):o===vp&&(o=Bc));r.avail_in>0&&o===Uc&&r.state.wrap>0&&e[r.next_in]!==0;)gr.inflateReset(r),o=gr.inflate(r,a);switch(o){case _b:case vp:case Bc:case yb:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(r.avail_out===0||o===Uc))if(this.options.to==="string"){let l=Co.utf8border(r.output,r.next_out),c=r.next_out-l,u=Co.buf2string(r.output,l);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===No&&s===0)){if(o===Uc)return o=gr.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Eo.prototype.onData=function(e){this.chunks.push(e)};Eo.prototype.onEnd=function(e){e===No&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ss.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Xc(e,t){let r=new Eo(t);if(r.push(e),r.err)throw r.msg||Sn[r.err];return r.result}function bb(e,t){return t=t||{},t.raw=!0,Xc(e,t)}var kb=Eo,vb=Xc,wb=bb,xb=Xc,Sb=Tn,Cb={Inflate:kb,inflate:vb,inflateRaw:wb,ungzip:xb,constants:Sb},{Deflate:Nb,deflate:Rb,deflateRaw:Tb,gzip:jb}=$y,{Inflate:Eb,inflate:Ob,inflateRaw:$b,ungzip:zb}=Cb,Ab=Nb,Lb=Rb,Ib=Tb,Pb=jb,Db=Eb,Mb=Ob,Fb=$b,Ub=zb,Bb=Tn,Qc={Deflate:Ab,deflate:Lb,deflateRaw:Ib,gzip:Pb,Inflate:Db,inflate:Mb,inflateRaw:Fb,ungzip:Ub,constants:Bb};var rr,el=class{constructor(){P(this,rr,new Map)}emit(t,...r){let n=g(this,rr).get(t);if(!n?.all?.size)return!1;for(let i of n.all)i(...r),n.once.has(i)&&(n.all.delete(i),n.once.delete(i));return!1}on(t,r){return g(this,rr).has(t)||g(this,rr).set(t,{all:new Set,once:new Set}),g(this,rr).get(t).all.add(r),this}once(t,r){g(this,rr).has(t)||g(this,rr).set(t,{all:new Set,once:new Set});let n=g(this,rr).get(t);return n.all.add(r),n.once.add(r),this}};rr=new WeakMap;var tl=class{async get(t,r={}){let n=new Headers;for(let[o,a]of Object.entries(r?.headers??{})){let s=typeof a=="string"?[a]:a;for(let l of s)n.append(o,l)}let i=await fetch(t,{headers:n,redirect:"follow"});if(i.ok)return new Uint8Array(await i.arrayBuffer());throw new Error(`Status code ${i.status}: ${i.ok}`)}},rl=class{on(t,r){return t==="ready"&&r(),this}once(t,r){return t==="ready"&&r(),this}async close(){}},ls=class{states;constructor(){this.states=JSON.parse(localStorage.getItem(ls.LocalStorageKey)??"{}")}saveStates(){localStorage.setItem(ls.LocalStorageKey,JSON.stringify(this.states))}async chmod(t,r){}async getAllFiles(t){return[]}async mkdir(t,r){if(t=oe.ensureEndingSlash(t.toString()),this.states[t])throw new Error(`EEXIST: ${t}`);this.states[t]={type:"directory"},this.saveStates()}async readFile(t){t=t.toString();let r=this.states[t];if(r){if(r.type==="directory")throw new Error(`EISDIR: ${t}`)}else throw new Error(`ENOENT: ${t}`);return new Uint8Array((0,us.decode)(r.content))}async showFile(t){throw new Error("showFile not supported on browser")}async stat(t){t=t.toString();let r=this.states[t];if(!r)throw new Error(`ENOENT: ${t}`);return{isDirectory:()=>r.type==="directory",isFile:()=>r.type==="file"}}async unlink(t){if(t=t.toString(),!this.states[t])throw new Error(`ENOENT: ${t}`);delete this.states[t],this.saveStates()}watch(t){return new rl}async writeFile(t,r,n){t=t.toString(),typeof r=="string"&&(r=new TextEncoder().encode(r)),r=(0,us.encode)(r),this.states[t]={type:"file",content:r},this.saveStates()}},cs=ls;re(cs,"LocalStorageKey","spyglassmc-browser-fs");var nl={archive:{decompressBall(e,t){throw new Error("decompressBall not supported on browser.")},async gunzip(e){return Qc.inflate(e)},async gzip(e){return Qc.gzip(e)}},crypto:{async getSha1(e){typeof e=="string"&&(e=new TextEncoder().encode(e));let t=await crypto.subtle.digest("SHA-1",e);return Vb(new Uint8Array(t))}},downloader:new tl,error:{isKind(e,t){return e instanceof Error&&e.message.startsWith(t)}},event:{EventEmitter:el},fs:new cs,uri:{normalize(e){return new rt(e).toString()}}};function Vb(e){let t="";for(let r of e)t+=r.toString(16).padStart(2,"0");return t}Object.freeze(nl);function rd(e){return`::${e.join("::")}`}var nd=".mcdoc",id="mcdoc/",od=(e,t)=>{let r=[];for(let n of e){if(!n.endsWith(nd))continue;let i=oe.getRel(n,t.roots);!i||(i=i.slice(0,-nd.length).replace(/(^|\/)mod$/,""),r.push([n,i]))}r.every(([n,i])=>i.startsWith(id))&&(r=r.map(([n,i])=>[n,i.slice(id.length)]));for(let[n,i]of r)t.symbols.query(n,"mcdoc",rd(i.split("/"))).ifKnown(()=>{}).elseEnter({data:{subcategory:"module"},usage:{type:"implementation"}})};var ad=async(e,t)=>{};var Zb=e=>[Ce.create(e,"variable")],Hb=e=>[Ce.create(e,e.colorTokenType??"literal")];function cd(e){e.registerColorizer("mcdoc:literal",Hb),e.registerColorizer("mcdoc:identifier",Zb)}var _d=co(lo({singleLinePrefixes:new Set(["//"])}),(e,t)=>!t.slice(e).startsWith("///"),h("mcdoc.parser.syntax.doc-comment-unexpected"));function yd(e=!1){return(t,r)=>{let n=[];for(t.skipWhitespace();t.canRead()&&t.peek(2)==="//"&&(!e||t.peek(3)!=="///");){let i=_d(t,r);n.push(i),t.skipWhitespace()}return n}}function B(e,t=!1){return(r,n)=>{r.skipWhitespace();let i=ve(e,yd(t))(r,n);return r.skipWhitespace(),i}}function Pt(e,t=!1){return ui(e,yd(t))}function ht(e,t){return(r,n)=>{let i={type:"mcdoc:literal",range:y.create(r),value:"",colorTokenType:t?.colorTokenType};return i.value=r.readIf(o=>t?.allowedChars?.has(o)??(t?.specialChars?.has(o)||/[a-z]/i.test(o))),i.range.end=r.cursor,ye.toArray(e).every(o=>o!==i.value)&&n.err.report(h("expected-got",cr(e),D(i.value)),i),i}}function ct(e,t={colorTokenType:"keyword"}){return(r,n)=>{let i=ht(e,t)(r,n);return ye.toArray(e).includes(i.value)?i:G}}function se(e){return(t,r)=>{t.skipWhitespace(),t.trySkip(e)||r.err.report(h("expected-got",D(e),D(t.peek())),t)}}function ge(e){return(t,r)=>{if(t.skipWhitespace(),!t.trySkip(e))return G}}function il(e){return co(Te(e),t=>t.namespace!==void 0,h("mcdoc.parser.resource-location.colon-expected",D(W.NamespacePathSep)))}var Kb=Object.freeze(["\0","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","","","\x7F"]),yi=dr(Ke({escapable:{characters:["b","f","n","r","t","\\",'"'],unicode:!0},quotes:['"']}),...Kb),Tt=(e,t)=>{let r=/^[\p{L}\p{Nl}]$/u,n=/^[\p{L}\p{Nl}\u200C\u200D\p{Mn}\p{Mc}\p{Nd}\p{Pc}]$/u,i=new Set(["any","boolean","byte","double","enum","false","float","int","long","short","string","struct","super","true"]),o={type:"mcdoc:identifier",range:y.create(e),options:{category:"mcdoc"},value:""},a=e.innerCursor;if(r.test(e.peek()))for(e.skip();n.test(e.peek());)e.skip();else t.err.report(h("expected",h("mcdoc.node.identifier")),e);return o.value=e.string.slice(a,e.innerCursor),o.range.end=e.cursor,i.has(o.value)&&t.err.report(h("mcdoc.parser.identifier.reserved-word",D(o.value)),o),o};function ol(e){let t=me([{prefix:"%",parser:ht(["%key","%parent"],{specialChars:new Set(["%"])})},{prefix:'"',parser:yi},{parser:Tt}]),r=he("mcdoc:dynamic_index",B([se("["),t,ui(ve([ge("."),t])),se("]")])),n=me([{prefix:"%",parser:ht(["%fallback","%none","%unknown"],{specialChars:new Set(["%"])})},{prefix:'"',parser:yi},{prefix:"[",parser:r},{parser:Ct([il({category:"mcdoc/dispatcher",accessType:e?.accessType}),Tt])}]);return he("mcdoc:index_body",B([se("["),n,Pt(B([ge(","),de(n)])),_e(ge(",")),se("]")]))}var ud=me([{prefix:"super",parser:ht("super")},{parser:Tt}]),$o=(e,t)=>{let r;return e.trySkip("::")&&(r=!0),ie(ve([ud,ui(ve([ge("::"),ud]))]),n=>({type:"mcdoc:path",children:n.children,range:n.range,isAbsolute:r}))(e,t)},fd=he("mcdoc:attribute/tree/pos",B([{get:()=>fs},Pt(B([ge(","),{get:()=>de(fs)}],!0),!0)],!0)),pd=B([me([{prefix:'"',parser:yi},{parser:Tt}]),me([{prefix:"=",parser:B([se("="),{get:()=>fs}],!0)},{parser:{get:()=>al}}])],!0),dd=he("mcdoc:attribute/tree/named",B([pd,Pt(B([ge(","),de(pd)],!0),!0)],!0)),Gb=Ct([B([dd,_e(ge(","))]),B([fd,se(","),dd,_e(ge(","))]),B([fd,_e(ge(","))])]),Wb=Object.freeze({"(":")","[":"]","{":"}"}),al=(e,t)=>{let r=e.trySkip("(")?"(":e.trySkip("[")?"[":e.trySkip("{")?"{":void 0;if(!r)return G;let n=Gb(e,t),i={type:"mcdoc:attribute/tree",range:n.range,children:n.children,delim:r};return e.trySkip(Wb[r]),i},fs=me([{predicate:e=>["(","[","{"].includes(e.peek()),parser:al},{parser:{get:()=>st}}]),Jb=he("mcdoc:attribute",B([ge("#["),Tt,me([{prefix:"=",parser:B([se("="),fs,se("]")],!0)},{predicate:e=>["(","[","{"].includes(e.peek()),parser:B([al,se("]")],!0)},{parser:se("]")}])],!0)),ps=ui(Jb),Yb=he("mcdoc:dispatch_statement",B([ps,ct("dispatch"),il({category:"mcdoc/dispatcher",accessType:1}),ol({noDynamic:!0}),ht("to"),{get:()=>st}],!0)),Xb=lo({singleLinePrefixes:new Set(["///"]),includesEol:!0}),Qb=he("mcdoc:doc_comments",ui(Xb,e=>(e.skipWhitespace(),[]))),zo=B([_e(de(Qb)),ps]),bd=ht(["byte","short","int","long","string","float","double"],{colorTokenType:"type"}),kd=Xt({pattern:/^[-+]?(?:[0-9]+(?:[eE][-+]?[0-9]+)?|[0-9]*\.[0-9]+(?:[eE][-+]?[0-9]+)?)$/}),vd=he("mcdoc:typed_number",ve([kd,_e(ct(["b","B","d","D","f","F","l","L","s","S"],{colorTokenType:"keyword"}))])),e0=me([{prefix:'"',parser:yi},{parser:vd}]),md=he("mcdoc:enum/field",B([zo,Tt,se("="),e0],!0)),wd=he("mcdoc:enum/block",B([se("{"),me([{prefix:"}",parser:se("}")},{parser:B([md,Pt(B([ge(","),de(md)],!0),!0),_e(ge(",")),se("}")],!0)}])],!0)),xd=he("mcdoc:enum",B([zo,ct("enum"),se("("),bd,se(")"),_e(fi(Tt)),wd],!0)),hd=he("mcdoc:type_param",B([Tt,_e(B([fi(ht("extends")),$o]))])),t0=he("mcdoc:type_param_block",B([se("<"),me([{prefix:">",parser:se(">")},{parser:B([hd,Pt(B([ge(","),de(hd)])),_e(ge(",")),se(">")])}])])),sl=()=>{},cl=me([{prefix:"<",parser:t0},{parser:sl}]),r0=he("mcdoc:struct/map_key",B([se("["),{get:()=>st},se("]")],!0)),n0=me([{prefix:'"',parser:yi},{prefix:"[",parser:r0},{parser:Tt}]),i0=(e,t)=>{let r,n=B([zo,n0],!0)(e,t);e.trySkip("?")&&(r=!0);let i=B([se(":"),{get:()=>st}],!0)(e,t);return{type:"mcdoc:struct/field/pair",children:[...n.children,...i.children],range:y.span(n,i),isOptional:r}},o0=he("mcdoc:struct/field/spread",B([ps,ge("..."),{get:()=>st}],!0)),gd=Ct([o0,i0]),Sd=he("mcdoc:struct/block",B([se("{"),me([{prefix:"}",parser:se("}")},{parser:B([gd,Pt(B([ge(","),de(gd)],!0),!0),_e(ge(",")),se("}")],!0)}])],!0)),Cd=he("mcdoc:struct",B([zo,ct("struct"),_e(de(Tt)),cl,Sd],!0)),a0=he("mcdoc:injection/enum",B([ht("enum"),se("("),bd,se(")"),$o,wd])),s0=he("mcdoc:injection/struct",B([ht("struct"),$o,cl,Sd])),c0=he("mcdoc:injection",B([ct("inject"),me([{prefix:"enum",parser:a0},{parser:s0}])])),l0=he("mcdoc:type_alias",B([zo,ct("type"),Tt,cl,se("="),{get:()=>st}],!0)),u0=he("mcdoc:use_statement",B([ct("use"),$o,me([{prefix:"as",parser:B([ht("as"),Tt])},{parser:sl}])],!0)),f0=Ct([_d,Yb,xd,c0,Cd,l0,u0]),Nd=he("mcdoc:module",Pt(f0,!0));function Dt(e,t){return he(e,B([ps,t,Pt(fi(ol()))],!0))}var p0=Dt("mcdoc:type/any",ct("any",{colorTokenType:"type"})),d0=Dt("mcdoc:type/boolean",ct("boolean",{colorTokenType:"type"})),m0=At({pattern:/^(?:0|[-+]?[1-9][0-9]*)$/});function Rd(e,t){return he(e,me([{prefix:"..",parser:ve([ht("..",{allowedChars:new Set(".")}),t])},{parser:ve([dr(t,".."),me([{prefix:"..",parser:ve([ht("..",{allowedChars:new Set(".")}),_e(de(t))])},{parser:sl}])])}]))}var h0=Rd("mcdoc:int_range",m0),Oo=_e((e,t)=>e.trySkip("@")?(e.skipWhitespace(),h0(e,t)):G),g0=Dt("mcdoc:type/string",B([ct("string",{colorTokenType:"type"}),Oo])),_0=Dt("mcdoc:type/literal",me([{predicate:e=>e.tryPeek("false")||e.tryPeek("true"),parser:ct(["false","true"],{colorTokenType:"type"})},{prefix:'"',parser:de(yi)},{parser:fi(vd)}])),y0=Rd("mcdoc:float_range",kd),b0=_e((e,t)=>e.trySkip("@")?(e.skipWhitespace(),y0(e,t)):G),k0=Dt("mcdoc:type/numeric_type",me([{predicate:e=>e.tryPeek("float")||e.tryPeek("double"),parser:B([ct(["float","double"],{colorTokenType:"type"}),b0])},{parser:B([ct(["byte","short","int","long"],{colorTokenType:"type"}),Oo])}])),v0=Dt("mcdoc:type/primitive_array",B([ht(["byte","int","long"]),Oo,ct("[]",{allowedChars:new Set(["[","]"]),colorTokenType:"type"}),Oo])),w0=Dt("mcdoc:type/list",B([ge("["),{get:()=>st},se("]"),Oo],!0)),x0=Dt("mcdoc:type/tuple",B([ge("["),{get:()=>st},ge(","),me([{prefix:"]",parser:se("]")},{parser:B([{get:()=>st},Pt(B([ge(","),{get:()=>de(st)}],!0),!0),_e(ge(",")),se("]")],!0)}])],!0)),S0=Dt("mcdoc:type/dispatcher",B([fi(il({category:"mcdoc/dispatcher"})),ol()])),C0=Dt("mcdoc:type/union",B([ge("("),me([{prefix:")",parser:se(")")},{parser:B([{get:()=>st},Pt(B([ge("|"),{get:()=>de(st)}],!0),!0),_e(ge("|")),se(")")],!0)}])])),N0=Dt("mcdoc:type/path",B([$o,_e(B([ge("<"),me([{prefix:">",parser:se(">")},{parser:B([{get:()=>st},Pt(B([ge(","),{get:()=>de(st)}],!0),!0),_e(ge(",")),se(">")],!0)}])]))])),st=Ct([p0,d0,S0,xd,w0,_0,k0,v0,g0,Cd,x0,C0,N0]);var oN=Object.freeze({is(e){return e?.type==="mcdoc:module"}}),aN=Object.freeze({is(e){return Un.is(e)||T0.is(e)||jd.is(e)||J0.is(e)||Ed.is(e)||Y0.is(e)||X0.is(e)}}),T0=Object.freeze({is(e){return e?.type==="mcdoc:dispatch_statement"}}),Td=Object.freeze({is(e){return e?.type==="mcdoc:literal"}}),sN=Object.freeze({is(e){return e?.type==="mcdoc:index_body"}}),cN=Object.freeze({is(e){return j0.is(e)||E0.is(e)}}),j0=Object.freeze({is(e){return Td.is(e)||ll.is(e)||Qe.is(e)||Q.is(e)}}),ll=Object.freeze({is(e){return e?.type==="mcdoc:identifier"}}),E0=Object.freeze({is(e){return e?.type==="mcdoc:dynamic_index"}}),lN=Object.freeze({is(e){return Td.is(e)||ll.is(e)||Qe.is(e)}}),O0=Object.freeze({is(e){return A0.is(e)||L0.is(e)||I0.is(e)||P0.is(e)||M0.is(e)||F0.is(e)||U0.is(e)||B0.is(e)||jd.is(e)||Ed.is(e)||q0.is(e)||G0.is(e)||W0.is(e)},asType(e){throw"// TODO"}}),$0=Object.freeze({is(e){return e?.type==="mcdoc:attribute"}}),uN=Object.freeze({is(e){return O0.is(e)||z0.is(e)}}),z0=Object.freeze({is(e){return e?.type==="mcdoc:attribute/tree"}}),fN=Object.freeze({is(e){return e?.type==="mcdoc:attribute/tree/pos"}}),pN=Object.freeze({is(e){return e?.type==="mcdoc:attribute/tree/named"}}),A0=Object.freeze({is(e){return e?.type==="mcdoc:type/any"}}),L0=Object.freeze({is(e){return e?.type==="mcdoc:type/boolean"}}),I0=Object.freeze({is(e){return e?.type==="mcdoc:type/string"}}),dN=Object.freeze({is(e){return e?.type==="mcdoc:int_range"}}),P0=Object.freeze({is(e){return e?.type==="mcdoc:type/literal"}}),D0=Object.freeze({is(e){return e?.type==="mcdoc:typed_number"}}),M0=Object.freeze({is(e){return e?.type==="mcdoc:type/numeric_type"}}),mN=Object.freeze({is(e){return e?.type==="mcdoc:float_range"}}),F0=Object.freeze({is(e){return e?.type==="mcdoc:type/primitive_array"}}),U0=Object.freeze({is(e){return e?.type==="mcdoc:type/list"}}),B0=Object.freeze({is(e){return e?.type==="mcdoc:type/tuple"}}),jd=Object.freeze({is(e){return e?.type==="mcdoc:enum"},kinds:new Set(["byte","short","int","long","float","double","string"])}),V0=Object.freeze({is(e){return e?.type==="mcdoc:doc_comments"}}),hN=Object.freeze({is(e){return e?.type==="mcdoc:enum/block"}}),gN=Object.freeze({is(e){return e?.type==="mcdoc:enum/field"}}),_N=Object.freeze({is(e){return D0.is(e)||Qe.is(e)}}),yN=Object.freeze({is(e){return $0.is(e)||V0.is(e)}}),Ed=Object.freeze({is(e){return e?.type==="mcdoc:struct"}}),bN=Object.freeze({is(e){return e?.type==="mcdoc:type/path"}}),kN=Object.freeze({is(e){return e?.type==="mcdoc:type_param_block"}}),vN=Object.freeze({is(e){return e?.type==="mcdoc:type_param"}}),q0=Object.freeze({is(e){return e?.type==="mcdoc:path"}}),wN=Object.freeze({is(e){return e?.type==="mcdoc:struct/block"}}),Od=Object.freeze({is(e){return Z0.is(e)||K0.is(e)}}),Z0=Object.freeze({is(e){return e?.type==="mcdoc:struct/field/pair"}}),$d=Object.freeze({is(e){return Qe.is(e)||ll.is(e)||H0.is(e)}}),H0=Object.freeze({is(e){return e?.type==="mcdoc:struct/map_key"}}),K0=Object.freeze({is(e){return e?.type==="mcdoc:struct/field/spread"}}),G0=Object.freeze({is(e){return e?.type==="mcdoc:type/dispatcher"}}),W0=Object.freeze({is(e){return e?.type==="mcdoc:type/union"}}),J0=Object.freeze({is(e){return e?.type==="mcdoc:injection"}}),xN=Object.freeze({is(e){return e?.type==="mcdoc:injection/enum"}}),SN=Object.freeze({is(e){return e?.type==="mcdoc:injection/struct"}}),Y0=Object.freeze({is(e){return e?.type==="mcdoc:type_alias"}}),X0=Object.freeze({is(e){return e?.type==="mcdoc:use_statement"}});var TN=Object.freeze({kind:"union",members:[]});var ds;(function(e){function t(r){let n=o=>{if(!o)return"";let[a,s]=o;return a===s?` @ ${a}`:` @ ${a??""}..${s??""}`},i=o=>{let a=[];for(let s of ye.toArray(o))s===void 0?a.push("()"):a.push(s.kind==="static"?`[${s.value}]`:`[[${s.accessor.map(l=>typeof l=="string"?l:l.keyword).join(".")}]]`);return`[${a.join(", ")}]`};if(r===void 0)return"<unknown>";switch(r.kind){case"any":case"boolean":return r.kind;case"byte":return`byte${n(r.valueRange)}`;case"byte_array":return`byte${n(r.valueRange)}[]${n(r.lengthRange)}`;case"dispatcher":return`${r.registry??"spyglass:unknown"}[${i(r.index)}]`;case"double":return`double${n(r.valueRange)}`;case"enum":return"<anonymous_enum>";case"float":return`float${n(r.valueRange)}`;case"int":return`int${n(r.valueRange)}`;case"int_array":return`int${n(r.valueRange)}[]${n(r.lengthRange)}`;case"list":return`[${t(r.item)}]${n(r.lengthRange)}`;case"literal":return`${r.value}`;case"long":return`long${n(r.valueRange)}`;case"long_array":return`long${n(r.valueRange)}[]${n(r.lengthRange)}`;case"reference":return r.symbol?.path.join("::")??"<unknown_reference>";case"short":return`short${n(r.valueRange)}`;case"string":return`string${n(r.lengthRange)}`;case"struct":return"<anonymous_compound>";case"tuple":return`[${r.items.map(o=>t(o)).join(",")}${r.items.length===1?",":""}]`;case"union":return`(${r.members.map(t).join(" | ")})`}}e.toString=t})(ds||(ds={}));var Ve;(function(e){e[e.Nah=0]="Nah",e[e.Assignable=1]="Assignable",e[e.StrictlyAssignable=3]="StrictlyAssignable"})(Ve||(Ve={}));var Ao=(e,t)=>{if(!t)return!0;if(!e)return!1;let[r,n]=e,[i,o]=t;return(i===void 0||r!==void 0&&r>=i)&&(o===void 0||n!==void 0&&n<=o)},ms=e=>{let t=new Set,r=n=>{for(let i of t){if((bi(n,i)&Ve.StrictlyAssignable)===Ve.StrictlyAssignable)return;(bi(i,n)&Ve.StrictlyAssignable)===Ve.StrictlyAssignable&&t.delete(i)}t.add(n)};for(let n of e.members)n.kind==="union"?ms(n).members.forEach(r):r(n);return{kind:"union",members:[...t]}};var Q0=e=>(e=ms(e),e.members.length===1?e.members[0]:e),fl=e=>k({kind:"list",item:ul(e.item)},e.lengthRange?{lengthRange:[...e.lengthRange]}:{}),ul=e=>(e.kind==="union"?e=Q0(e):e.kind==="list"&&(e=fl(e)),e),bi=(e,t,r=[])=>{let n=a=>a?Ve.StrictlyAssignable:Ve.Nah,i=a=>a?Ve.Assignable:Ve.Nah,o;return e=ul(e),t=ul(t),e.kind==="any"||e.kind==="reference"||t.kind==="reference"?o=Ve.Assignable:t.kind==="any"?o=Ve.StrictlyAssignable:e.kind==="union"?o=i(e.members.every(a=>bi(a,t,r))):t.kind==="union"?o=i(t.members.some(a=>bi(e,a))):e.kind==="boolean"?o=n(t.kind==="boolean"||t.kind==="byte"):e.kind==="byte"?t.kind==="boolean"?o=bi(e,{kind:"byte",valueRange:[0,1]},r):t.kind==="byte"?o=n(Ao(e.valueRange,t.valueRange)):t.kind==="enum"?o=i(!t.enumKind||t.enumKind==="byte"):o=Ve.Nah:e.kind==="byte_array"||e.kind==="int_array"||e.kind==="long_array"?o=n(t.kind===e.kind&&Ao(e.lengthRange,t.lengthRange)&&Ao(e.valueRange,t.valueRange)):e.kind==="struct"||e.kind==="dispatcher"?o=i(t.kind==="struct"||t.kind==="dispatcher"):e.kind==="enum"?o=i((t.kind==="byte"||t.kind==="float"||t.kind==="double"||t.kind==="int"||t.kind==="long"||t.kind==="short"||t.kind==="string")&&(!e.enumKind||e.enumKind===t.kind)):e.kind==="float"||e.kind==="double"||e.kind==="int"||e.kind==="long"||e.kind==="short"?t.kind===e.kind?o=n(Ao(e.valueRange,t.valueRange)):t.kind==="enum"?o=i(!t.enumKind||t.enumKind===e.kind):o=Ve.Nah:e.kind==="list"?t.kind==="list"&&Ao(e.lengthRange,t.lengthRange)?o=bi(e.item,t.item,r):o=Ve.Nah:e.kind==="string"?t.kind==="string"?o=Ve.StrictlyAssignable:o=i(t.kind==="enum"&&(!t.enumKind||t.enumKind==="string")):o=Ve.Nah,o||r.push(h("mcdoc.checker.type-not-assignable",D(ds.toString(e)),D(ds.toString(t)))),o};var zd=({meta:e})=>{e.registerLanguage("mcdoc",{extensions:[".mcdoc"],parser:Nd}),e.registerChecker("mcdoc:module",ad),e.registerUriBinder(od),cd(e)};function Ad(e){e.registerColorizer("nbt:byte",Oe.number),e.registerColorizer("nbt:short",Oe.number),e.registerColorizer("nbt:int",Oe.number),e.registerColorizer("nbt:long",Oe.number),e.registerColorizer("nbt:float",Oe.number),e.registerColorizer("nbt:double",Oe.number)}var nr={};ar(nr,{byteArray:()=>hl,compound:()=>Hr,entry:()=>Kr,intArray:()=>gl,list:()=>ml,longArray:()=>_l,path:()=>yl,primitive:()=>En,string:()=>dl});function jt(e){return h(`nbt.node.${e.replace(/^nbt:/,"")}`)}var Hr=(e,t)=>he("nbt:compound",Lt({start:"{",pair:{key:de(Ke(O(k({},Dr),{colorTokenType:"property"}))),sep:":",value:Kr,end:",",trailingEnd:!1},end:"}"}))(e,t);var Id=(2-2**-23)*2**127,ek=[{pattern:/^[-+]?(?:0|[1-9][0-9]*)b$/i,type:"nbt:byte",hasSuffix:!0,group:2,min:-128,max:127},{pattern:/^[-+]?(?:0|[1-9][0-9]*)s$/i,type:"nbt:short",hasSuffix:!0,group:2,min:-32768,max:32767},{pattern:/^[-+]?(?:0|[1-9][0-9]*)$/,type:"nbt:int",hasSuffix:!1,group:2,min:-2147483648,max:2147483647},{pattern:/^[-+]?(?:0|[1-9][0-9]*)l$/i,type:"nbt:long",hasSuffix:!0,group:3,min:-9223372036854775808n,max:9223372036854775807n},{pattern:/^[-+]?(?:[0-9]+\.?|[0-9]*\.[0-9]+)(?:e[-+]?[0-9]+)?f$/i,type:"nbt:float",hasSuffix:!0,group:1,min:-Id,max:Id},{pattern:/^[-+]?(?:[0-9]+\.|[0-9]*\.[0-9]+)(?:e[-+]?[0-9]+)?$/i,type:"nbt:double",hasSuffix:!1,group:1,min:-Number.MAX_VALUE,max:Number.MAX_VALUE},{pattern:/^[-+]?(?:[0-9]+\.?|[0-9]*\.[0-9]+)(?:e[-+]?[0-9]+)?d$/i,type:"nbt:double",hasSuffix:!0,group:1,min:-Number.MAX_VALUE,max:Number.MAX_VALUE},{pattern:/^true$/i,type:"nbt:byte",value:1,group:0},{pattern:/^false$/i,type:"nbt:byte",value:0,group:0}],dl=vn,En=(e,t)=>{if(Se.isBrigadierQuote(e.peek()))return dl(e,t);let{result:r,updateSrcAndCtx:n}=mt(dl,e,t);for(let i of ek)if(i.pattern.test(r.value)){if(i.group===0){let u={type:"nbt:byte",range:r.range,value:i.value};return n(),u}let o=!1,a=()=>o=!0,s=i.group===2?At({pattern:/./,min:i.min,max:i.max,onOutOfRange:a}):i.group===3?uo({pattern:/./,min:i.min,max:i.max,onOutOfRange:a}):Xt({pattern:/./,min:i.min,max:i.max,onOutOfRange:a}),{result:l,updateSrcAndCtx:c}=mt(s,e,t);if(o){t.err.report(h("nbt.parser.number.out-of-range",jt(i.type),h("nbt.node.string"),i.min,i.max),r,2);break}return c(),i.hasSuffix&&(e.skip(),l.range.end++),O(k({},l),{type:i.type})}return n(),r};var Kr=(e,t)=>de(me([{predicate:r=>r.tryPeek("[B;"),parser:hl},{predicate:r=>r.tryPeek("[I;"),parser:gl},{predicate:r=>r.tryPeek("[L;"),parser:_l},{predicate:r=>r.tryPeek("["),parser:ml},{predicate:r=>r.tryPeek("{"),parser:Hr},{parser:En}]))(e,t);var ml=(e,t)=>{let n=Pr({start:"[",value:Kr,sep:",",trailingSep:!1,end:"]"})(e,t);if(n.type="nbt:list",n.valueType=n.children[0]?.value?.type,n.valueType)for(let{value:i}of n.children)i&&i.type!==n.valueType&&t.err.report(h("expected-got",jt(n.valueType),jt(i.type)),i);return n},hl=(e,t)=>{let n=Pr({start:"[B;",value:En,sep:",",trailingSep:!1,end:"]"})(e,t);n.type="nbt:byte_array";for(let{value:i}of n.children)i&&i.type!=="nbt:byte"&&t.err.report(h("expected-got",h("nbt.node.byte"),jt(i.type)),i);return n},gl=(e,t)=>{let n=Pr({start:"[I;",value:En,sep:",",trailingSep:!1,end:"]"})(e,t);n.type="nbt:int_array";for(let{value:i}of n.children)i&&i.type!=="nbt:int"&&t.err.report(h("expected-got",h("nbt.node.int"),jt(i.type)),i);return n},_l=(e,t)=>{let n=Pr({start:"[L;",value:En,sep:",",trailingSep:!1,end:"]"})(e,t);n.type="nbt:long_array";for(let{value:i}of n.children)i&&i.type!=="nbt:long"&&t.err.report(h("expected-got",h("nbt.node.long"),jt(i.type)),i);return n};var yl=(e,t)=>{let r={type:"nbt:path",children:[],range:y.create(e)},n=["filter","key"],i=Pd(e),o;for(;o!==e.cursor&&(n.includes(i)||t.err.report(h("expected-got",cr(n.map(Dd),!1,"or"),Dd(i)),e),i!=="end");)o=e.cursor,n=ik[i](r.children,e,t),i=Pd(e);return r.range.end=e.cursor,r},tk=(e,t,r)=>(e.push(Hr(t,r)),t.trySkip(".")?["key"]:["end"]),rk=(e,t,r)=>{let n={type:"nbt:path/index",children:void 0,range:y.create(t)};if(!t.trySkip("["))throw new Error(`NBT path index parser called at illegal position: \u201C${t.peek()}\u201D at ${t.cursor}`);t.skipSpace();let i=t.peek();return i==="{"?n.children=[Hr(t,r)]:i!=="]"&&(n.children=[At({pattern:/^-?\d+$/})(t,r)]),t.skipSpace(),t.trySkip("]")||r.err.report(h("expected-got",D("]"),D(t.peek())),t),n.range.end=t.cursor,e.push(n),t.trySkip(".")?["index","key"]:["end","index"]},nk=(e,t,r)=>{let n=Ke({colorTokenType:"property",escapable:{},quotes:['"'],unquotable:{blockList:new Set([`
`,"\r","	"," ",'"',"[","]",".","{","}"])}})(t,r);return e.push(n),t.trySkip(".")?["index","key"]:["end","filter","index"]};function Pd(e){switch(e.peek()){case"":case" ":case`
`:case"\r":return"end";case"{":return"filter";case"[":return"index";default:return"key"}}function Dd(e){return h(`nbt.node.path.${e}`)}var ik={filter:tk,index:rk,key:nk};var qe={};ar(qe,{blockStates:()=>Al,compound:()=>ck,definition:()=>sk,enum_:()=>lk,fieldValue:()=>hs,index:()=>qd,path:()=>uk});var Md;(function(e){function t(r){return bl.is(r)||Mt.is(r)||jl.is(r)}e.is=t})(Md||(Md={}));var bl;(function(e){function t(r){return kl.is(r)||Qe.is(r)}e.is=t})(bl||(bl={}));var kl;(function(e){function t(r){return vl.is(r)||Nl.is(r)}e.is=t})(kl||(kl={}));var vl;(function(e){function t(r){return wl.is(r)||xl.is(r)||Sl.is(r)||Cl.is(r)}e.is=t})(vl||(vl={}));var wl;(function(e){function t(r){return r?.type==="nbt:byte"}e.is=t})(wl||(wl={}));var xl;(function(e){function t(r){return r?.type==="nbt:short"}e.is=t})(xl||(xl={}));var Sl;(function(e){function t(r){return r?.type==="nbt:int"}e.is=t})(Sl||(Sl={}));var Cl;(function(e){function t(r){return r?.type==="nbt:long"}e.is=t})(Cl||(Cl={}));var Nl;(function(e){function t(r){return Rl.is(r)||Tl.is(r)}e.is=t})(Nl||(Nl={}));var Rl;(function(e){function t(r){return r?.type==="nbt:float"}e.is=t})(Rl||(Rl={}));var Tl;(function(e){function t(r){return r?.type==="nbt:double"}e.is=t})(Tl||(Tl={}));var Mt;(function(e){function t(r){return r?.type==="nbt:compound"}e.is=t})(Mt||(Mt={}));var jl;(function(e){function t(r){return Lo.is(r)||El.is(r)}e.is=t})(jl||(jl={}));var Lo;(function(e){function t(r){return r?.type==="nbt:list"}e.is=t})(Lo||(Lo={}));var El;(function(e){function t(r){return Ol.is(r)||$l.is(r)||zl.is(r)}e.is=t})(El||(El={}));var Ol;(function(e){function t(r){return r?.type==="nbt:byte_array"}e.is=t})(Ol||(Ol={}));var $l;(function(e){function t(r){return r?.type==="nbt:int_array"}e.is=t})($l||($l={}));var zl;(function(e){function t(r){return r?.type==="nbt:long_array"}e.is=t})(zl||(zl={}));var ki;(function(e){function t(r){return r?.type==="nbt:path"}e.is=t})(ki||(ki={}));var Fd;(function(e){function t(r){return r?.type==="nbt:path/index"}e.is=t})(Fd||(Fd={}));var ok={"minecraft:brain_coral_fan":["minecraft:brain_coral_fan","minecraft:brain_coral_wall_fan"],"minecraft:bubble_coral_fan":["minecraft:bubble_coral_fan","minecraft:bubble_coral_wall_fan"],"minecraft:fire_coral_fan":["minecraft:fire_coral_fan","minecraft:fire_coral_wall_fan"],"minecraft:horn_coral_fan":["minecraft:horn_coral_fan","minecraft:horn_coral_wall_fan"],"minecraft:tube_coral_fan":["minecraft:tube_coral_fan","minecraft:tube_coral_wall_fan"],"minecraft:creeper_head":["minecraft:creeper_head","minecraft:creeper_wall_head"],"minecraft:dragon_head":["minecraft:dragon_head","minecraft:dragon_wall_head"],"minecraft:player_head":["minecraft:player_head","minecraft:player_wall_head"],"minecraft:skeleton_skull":["minecraft:skeleton_skull","minecraft:skeleton_wall_skull"],"minecraft:wither_skeleton_skull":["minecraft:wither_skeleton_skull","minecraft:wither_skeleton_wall_skull"],"minecraft:dead_brain_coral_fan":["minecraft:dead_brain_coral_fan","minecraft:dead_brain_coral_wall_fan"],"minecraft:dead_bubble_coral_fan":["minecraft:dead_bubble_coral_fan","minecraft:dead_bubble_coral_wall_fan"],"minecraft:dead_fire_coral_fan":["minecraft:dead_fire_coral_fan","minecraft:dead_fire_coral_wall_fan"],"minecraft:dead_horn_coral_fan":["minecraft:dead_horn_coral_fan","minecraft:dead_horn_coral_wall_fan"],"minecraft:dead_tube_coral_fan":["minecraft:dead_tube_coral_fan","minecraft:dead_tube_coral_wall_fan"],"minecraft:torch":["minecraft:torch","minecraft:wall_torch"],"minecraft:soul_torch":["minecraft:soul_torch","minecraft:soul_wall_torch"],"minecraft:redstone_torch":["minecraft:redstone_torch","minecraft:redstone_wall_torch"],"minecraft:beetroot_seeds":["minecraft:beetroots"],"minecraft:carrot":["minecraft:carrots"],"minecraft:cocoa_beans":["minecraft:cocoa"],"minecraft:glow_berries":["minecraft:cave_vines"],"minecraft:melon_seeds":["minecraft:melon_stem"],"minecraft:potato":["minecraft:potatoes"],"minecraft:pumpkin_seeds":["minecraft:pumpkin_stem"],"minecraft:redstone":["minecraft:redstone_wire"],"minecraft:string":["minecraft:tripwire"],"minecraft:sweat_berries":["minecraft:sweat_berry_bush"],"minecraft:wheat_seeds":["minecraft:wheat"]};function Ud(e){return ok[e]}function Bd(e){if(e==="minecraft:armor_stand")return e;let t=e.match(/^minecraft:([a-z0-9_]+)_spawn_egg$/);if(t)return`minecraft:${t[1]}`}var ak={"::minecraft::block::banner::Banner.CustomName":"mcfunction:component","::minecraft::block::brewingstand::BrewingStand.CustomName":"mcfunction:component","::minecraft::block::commandblock::CommandBlock.Command":"mcfunction:command","::minecraft::block::commandblock::CommandBlock.CustomName":"mcfunction:component","::minecraft::block::container::ContainerBase.CustomName":"mcfunction:component","::minecraft::block::enchantingtable::EnchantingTable.CustomName":"mcfunction:component","::minecraft::block::furnace::Furnace.CustomName":"mcfunction:component","::minecraft::block::hopper::Hopper.CustomName":"mcfunction:component","::minecraft::block::sign::Sign.Text1":"mcfunction:component","::minecraft::block::sign::Sign.Text2":"mcfunction:component","::minecraft::block::sign::Sign.Text3":"mcfunction:component","::minecraft::block::sign::Sign.Text4":"mcfunction:component","::minecraft::entity::effectcloud::EffectCloud.Particle":"mcfunction:particle","::minecraft::entity::minecart::CommandMinecart.Command":"mcfunction:command","::minecraft::entity::mob::LivingEntity.Team":"mcfunction:team","::minecraft::entity::EntityBase.Tags[]":"mcfunction:tag","::minecraft::item::blockitem::BlockItem.CanPlaceOn[]":"mcfunction:block_predicate","::minecraft::item::book::WrittenBook.pages[]":"mcfunction:component","::minecraft::item::ItemBase.CanDestroy[]":"mcfunction:block_predicate"};function Vd(e){return ak[e]}function qd(e,t,r={}){switch(e){case"custom:blockitemstates":let n=Ud(t);return n?Al(n,r):it.noop;case"custom:blockstates":return Al([t],r);case"custom:spawnitemtag":let i=Bd(t);return i?qd("entity_type",i,r):it.noop;default:return(o,a)=>{}}}function sk(e,t={}){let r=e.lastIndexOf("::"),n=e.slice(0,r),i=e.slice(r+2),o={category:"mcdoc",path:[n,i]};return(a,s)=>{}}function Al(e,t={}){return(r,n)=>{let i=rn("block",e,n);for(let{key:o,value:a}of r.children)if(!(!o||!a)){if(a.type==="nbt:byte"&&(n.src.slice(a.range).toLowerCase()==="false"||n.src.slice(a.range).toLowerCase()==="true")){n.err.report(h("nbt.checker.block-states.fake-boolean"),a,2);continue}else if(a.type!=="string"&&a.type!=="nbt:int"){n.err.report(h("nbt.checker.block-states.unexpected-value-type"),a,2);continue}if(Object.keys(i).includes(o.value)){let s=i[o.value];s.includes(a.value.toString())||n.err.report(h("expected-got",s,D(a.value.toString())),a,2)}else n.err.report(h("nbt.checker.block-states.unknown-state",D(o.value),e),o,2)}}}function ck(e,t={}){return(r,n)=>{for(let{key:i,value:o}of r.children){if(!i||!o)continue;let a=i.value,s=e[a];s?(s.query.enter({usage:{type:"reference",node:i}}),hs(s.data,t)(o,n)):t.allowUnknownKey||n.err.report(h("unknown-key",D(a)),i,2)}}}function lk(e,t={}){return e?(r,n)=>{}:it.noop}function uk(e,t){return(r,n)=>{}}function hs(e,t){let r=(i,[o,a])=>(o??-1/0)<=i&&i<=(a??1/0),n={boolean:"nbt:byte",byte:"nbt:byte",byte_array:"nbt:byte_array",double:"nbt:double",float:"nbt:float",int:"nbt:int",int_array:"nbt:int_array",list:"nbt:list",long:"nbt:long",long_array:"nbt:long_array",short:"nbt:short",string:"string",struct:"nbt:compound",tuple:"nbt:list"};return(i,o)=>{if(e.kind!=="any"&&e.kind!=="dispatcher"&&e.kind!=="enum"&&e.kind!=="literal"&&e.kind!=="reference"&&e.kind!=="union"&&i.type!==n[e.kind]){o.err.report(h("expected",jt(n[e.kind])),i,2);return}switch(e.kind){case"boolean":i=i,i.value!==0&&i.value!==1&&o.err.report(h("nbt.checker.boolean.out-of-range",D("0b"),D("1b")),i,2);break;case"byte_array":case"int_array":case"long_array":if(i=i,e.lengthRange&&!r(i.children.length,e.lengthRange)&&o.err.report(h("expected",h("nbt.checker.collection.length-between",jt(i.type),e.lengthRange[0]??"-\u221E",e.lengthRange[1]??"+\u221E")),i,2),e.valueRange)for(let{value:l}of i.children)l&&!r(Number(l.value),e.valueRange)&&o.err.report(h("number.between",e.valueRange[0]??"-\u221E",e.valueRange[1]??"+\u221E"),i,2);break;case"byte":case"short":case"int":case"long":case"float":case"double":i=i,e.valueRange&&!r(Number(i.value),e.valueRange)&&o.err.report(h("number.between",e.valueRange[0]??"-\u221E",e.valueRange[1]??"+\u221E"),i,2);break;case"dispatcher":i=i;break;case"list":i=i,e=fl(e),e.lengthRange&&!r(i.children.length,e.lengthRange)&&o.err.report(h("expected",h("nbt.checker.collection.length-between",jt(i.type),e.lengthRange[0]??"-\u221E",e.lengthRange[1]??"+\u221E")),i,2);for(let{value:l}of i.children)l&&hs(e.item,t)(l,o);break;case"string":i=i;let a="",s=i;if(_a.is(i.parent)&&Lo.is(i.parent.parent)&&(a="[]",s=i.parent.parent),sn.is(s.parent)){let l=s.parent.key?.symbol?.parentSymbol?.path.join("::"),c=s.parent.key?.value,u=`${l}.${c}${a}`,p=Vd(u);if(p)try{let d=o.meta.getParser(p),m=kn(d,i.value,i.valueMap,o);m!==G&&(o.ops.set(i,"children",[m]),m.parent=i)}catch(d){o.logger.error("[nbt.checker.fieldValue#string]",d)}}break;case"reference":i=i;break;case"union":e=ms(e),e.members.length===0?o.err.report(h("nbt.checker.compound.field.union-empty-members"),sn.is(i.parent)?i.parent.key??i.parent:i,2):it.any(e.members.map(l=>hs(l,t)))(i,o);break}}}var Zd=({meta:e})=>{e.registerLanguage("nbt",{extensions:[".snbt"],parser:Kr}),e.registerParser("nbt:entry",Kr),e.registerParser("nbt:compound",Hr),e.registerParser("nbt:path",yl),Ad(e)};var gt;(function(e){function t(r,n){return Math.sign(Number(r.slice(2))-Number(n.slice(2)))}e.cmp=t})(gt||(gt={}));var Il={5:/^1\.15.*$/,6:/^1\.16.*$/,7:/^1\.17.*$/,8:/^1\.18(\.1)?$/,9:/^1\.18.*$/,10:/^1\.19.*$/},gs;(function(e){function t(r){let n=r?.pack?.pack_format?.toString();if(!n)throw new Error("\u201Cpack.pack_format\u201D undefined");if(!Object.keys(Il).includes(n))throw new Error(`Unknown pack_format \u201C${n}\u201D`)}e.assert=t})(gs||(gs={}));function Hd(e,{packMcmeta:t,versions:r}){function n(i){i<0&&(i=0);let o=r[i];return{id:o.id,name:o.name,release:o.release_target,isLatest:i===0}}if(r.length===0)throw new Error("mcmeta version list is empty");if(e=e.toLowerCase(),r=r.sort((i,o)=>o.data_version-i.data_version),e==="auto"){if(t){let i=Il[t.pack.pack_format];if(i)return n(r.findIndex(o=>i.test(o.release_target)))}return n(0)}else{if(e==="latest release")return n(r.findIndex(i=>i.type==="release"));if(e==="latest snapshot")return n(r.findIndex(i=>i.type==="snapshot"))}return n(r.findIndex(i=>e===i.id.toLowerCase()||e===i.name.toLowerCase()))}var fk={fastly:"https://fastly.jsdelivr.net/gh/${user}/${repo}@${tag}/${path}",github:"https://raw.githubusercontent.com/${user}/${repo}/${tag}/${path}",jsdelivr:"https://cdn.jsdelivr.net/gh/${user}/${repo}@${tag}/${path}"};function Kd(e,t,r){let n=t?"summary":`${e}-summary`;function i(o){let s=(fk[r.toLowerCase()]??r).replace(/\${user}/g,"misode").replace(/\${repo}/g,"mcmeta").replace(/\${tag}/g,n).replace(/\${path}/g,o);if(!Au.is(s))throw new Error(`Expected a remote URI from data source template but got ${s}`);return s}return{blocks:i("blocks/data.json.gz"),commands:i("commands/data.json.gz"),registries:i("registries/data.json.gz")}}function Gd(e){let t="mcmeta://summary/registries.json";function r(i,o,a){let s=`${i[0].toUpperCase()}${i.slice(1)}`;for(let[l,[c,u]]of Object.entries(o)){let p=t;a.query(p,i,W.lengthen(l)).onEach(Object.entries(c),([d,m],_)=>{let T=u[d];_.member(`${p}#${s}_states`,d,b=>{b.enter({data:{subcategory:"state"},usage:{type:"declaration"}}).onEach(m,S=>{b.member(S,z=>{z.enter({data:{subcategory:"state_value"},usage:{type:"declaration"}}),S===T&&b.amend({data:{relations:{default:{category:i,path:z.path}}}})})})})})}}function n(i,o){function a(s){return qn.includes(s)||lr.includes(s)}for(let[s,l]of Object.entries(i))if(a(s))for(let c of l)o.query(t,s,W.lengthen(c)).enter({usage:{type:"declaration"}})}return i=>{n(e.registries,i),r("block",e.blocks,i),r("fluid",e.fluids,i)}}var Wd={flowing_lava:[{falling:["false","true"],level:["1","2","3","4","5","6","7","8"]},{falling:"false",level:"1"}],flowing_water:[{falling:["false","true"],level:["1","2","3","4","5","6","7","8"]},{falling:"false",level:"1"}],lava:[{falling:["false","true"]},{falling:"false"}],water:[{falling:["false","true"]},{falling:"false"}]};var _s=15e3;async function Jd(e,t){return t.download({id:"mc-je/versions.json.gz",uri:"https://raw.githubusercontent.com/misode/mcmeta/summary/versions/data.json.gz",transformer:r=>sc(e,r),cache:Pl("misode","mcmeta","refs/heads/summary"),ttl:_s})}async function Yd(e,t,r,n,i,o,a={}){let s=Xd({defaultBranch:"summary",getTag:b=>`${b}-summary`,isLatest:i,version:n}),l=Kd(n,i,o),c;async function u(b,S){if(S)try{let z=await oe.readJson(e,S.path);return S.replace?z:Ai(b,z)}catch(z){r.error(`[je] [mcmeta-overrides] Failed loading customized mcmeta summary file \u201C${S.path}\u201D`,z)}return b}let p=async(b,S)=>{let z={},q=await t.download({id:`mc-je/${n}/${b}.json.gz`,uri:l[b],transformer:$=>sc(e,$),cache:Pl("misode","mcmeta",s),ttl:_s},z);return c||=z.checksum,u(q,S)},[d,m,_,T]=[await p("blocks",a.blocks),await p("commands",a.commands),await u(Wd,a.fluids),await p("registries",a.registries)];return{blocks:d,commands:m,fluids:_,registries:T,checksum:c}}function Xd({defaultBranch:e,getTag:t,isLatest:r,version:n}){return r?`refs/heads/${e}`:`refs/tags/${t(n)}`}var Qd={headers:{Accept:"application/vnd.github.v3+json","User-Agent":"SpyglassMC"}};function Pl(e,t,r){return{checksumExtension:".commit-sha",checksumJob:{uri:`https://api.github.com/repos/${e}/${t}/git/${r}`,transformer:n=>{let i=JSON.parse(wt(n));if(Array.isArray(i))return i[0].object.sha;if(i.message===void 0)return i.object.sha;throw new Error(i.message)},options:Qd,ttl:_s}}}async function pk({defaultBranch:e,downloader:t,externals:r,getTag:n,repo:i,isLatest:o,owner:a,version:s}){let l=Xd({defaultBranch:e,getTag:n,isLatest:o,version:s}),c={};return await t.download({id:`mc-je/${s}/${i}.tar.gz`,uri:`https://api.github.com/repos/${a}/${i}/tarball/${l}`,transformer:u=>u,cache:Pl(a,i,l),options:Qd,ttl:_s},c),c.cacheUri}async function em(e,t,r,n){return{info:{startDepth:1},uri:await pk({defaultBranch:"main",downloader:t,externals:e,getTag:i=>i,isLatest:n,owner:"SpyglassMC",repo:"vanila-mcdoc",version:r})}}var mk=(()=>{let e=new Set(["block","fluid","game_event","item","worldgen/block_placer_type","worldgen/surface_builder"]),t=new Map([["advancements",{category:"advancement",extname:".json"}],["dimension",{category:"dimension",extname:".json",since:"1.16"}],["dimension_type",{category:"dimension_type",extname:".json",since:"1.16"}],["functions",{category:"function",extname:".mcfunction"}],["item_modifiers",{category:"item_modifier",extname:".json",since:"1.17"}],["loot_tables",{category:"loot_table",extname:".json"}],["predicates",{category:"predicate",extname:".json"}],["recipes",{category:"recipe",extname:".json"}],["tags/blocks",{category:"tag/block",extname:".json"}],["tags/entity_types",{category:"tag/entity_type",extname:".json"}],["tags/fluids",{category:"tag/fluid",extname:".json"}],["tags/functions",{category:"tag/function",extname:".json"}],["tags/game_events",{category:"tag/game_event",extname:".json",since:"1.17"}],["tags/items",{category:"tag/item",extname:".json"}],["worldgen/biome",{category:"worldgen/biome",extname:".json",since:"1.16"}],["worldgen/configured_carver",{category:"worldgen/configured_carver",extname:".json",since:"1.16"}],["worldgen/configured_feature",{category:"worldgen/configured_feature",extname:".json",since:"1.16"}],["worldgen/configured_structure_feature",{category:"worldgen/configured_structure_feature",extname:".json",since:"1.16"}],["worldgen/configured_surface_builder",{category:"worldgen/configured_surface_builder",extname:".json",since:"1.16",until:"1.17"}],["worldgen/noise",{category:"worldgen/noise",extname:".json",since:"1.18"}],["worldgen/noise_settings",{category:"worldgen/noise_settings",extname:".json",since:"1.16"}],["worldgen/placed_feature",{category:"worldgen/placed_feature",extname:".json",since:"1.18"}],["worldgen/processor_list",{category:"worldgen/processor_list",extname:".json",since:"1.16"}],["worldgen/template_pool",{category:"worldgen/template_pool",extname:".json",since:"1.16"}]]);for(let r of lr)e.has(r)||t.set(`tags/${r}`,{category:`tag/${r}`,extname:".json",since:"1.18"});return t})();function*hk(e,t){yield*oe.getRels(e,t);let r=e.split("/");for(let n=r.length-2;n>=0;n--)r[n]==="data"&&(yield r.slice(n).join("/"))}function vi(e,t){let r=/^data\/([^\/]+)\/((?:tags\/|worldgen\/)?[a-z_]+)\/(.*)(\.(?:mcfunction|json))$/,n=hk(e,t.roots);for(let i of n){let o=i.match(r);if(!o)continue;let a=mk.get(o[2]);if(!(!a||a.extname!==o[4])&&!!gk(t.project.loadedVersion,a.since,a.until))return{category:a.category,namespace:o[1],identifier:o[3]}}}var tm=(e,t)=>{for(let r of e){let n=vi(r,t);n&&t.symbols.query(r,n.category,`${n.namespace}:${n.identifier}`).enter({usage:{type:"definition"}})}};function gk(e,t,r){return!(t&&gt.cmp(e,t)<0||r&&gt.cmp(r,e)<0)}var _k=e=>[Ce.create(e,"literal")],yk=e=>[Ce.create(e,"literal")],bk=(e,t)=>{let r=[];for(let n of e.children)if(n.key&&r.push(Ce.create(n.key,"property")),n.value){let i=t.meta.getColorizer(n.value.type);r.push(...i(n.value,t))}return r};function rm(e){e.registerColorizer("json:boolean",_k),e.registerColorizer("json:null",yk),e.registerColorizer("json:number",Oe.number),e.registerColorizer("json:object",bk),e.registerColorizer("json:string",Oe.string)}var Po={};ar(Po,{JsonStringOptions:()=>ys,array:()=>Fl,entry:()=>Gr,json:()=>am,number:()=>Dl,object:()=>Ml,string:()=>Io});var im=(e,t)=>{let r=e.cursor;return e.trySkip("false")?{type:"json:boolean",range:y.create(r,e),value:!1}:e.trySkip("true")?{type:"json:boolean",range:y.create(r,e),value:!0}:G};var om=(e,t)=>{let r=e.cursor;return e.trySkip("null")?{type:"json:null",range:y.create(r,e)}:G};var Dl=(e,t)=>{let n=Xt({pattern:/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][-+]?\d+)?$/})(e,t);return n.type="json:number",n};var ys={escapable:{characters:["b","f","n","r","t"],unicode:!0},quotes:['"']},Io=(e,t)=>{let n=Ke(ys)(e,t);return n.type="json:string",n};var Ml=(e,t)=>he("json:object",Lt({start:"{",pair:{key:Io,sep:":",value:Gr,end:",",trailingEnd:!1},end:"}"}))(e,t);var kk=new Set(["0","1","2","3","4","5","6","7","8","9","-"]);function am(e=!1){return(t,r)=>{let n=me([{predicate:i=>i.tryPeek("["),parser:Fl},{predicate:i=>i.tryPeek("false")||i.tryPeek("true"),parser:im},{predicate:i=>i.tryPeek("null"),parser:om},{predicate:i=>kk.has(i.peek()),parser:Dl},{predicate:i=>i.tryPeek("{"),parser:Ml},{parser:Io}])(t,r);return e&&r.err.dump(),n}}var Gr=am(!0);var Fl=(e,t)=>{let n=Pr({start:"[",value:Gr,sep:",",trailingSep:!1,end:"]"})(e,t);return n.type="json:array",n};var bs;(function(e){function t(n){return et.is(n)||Ft.is(n)||Ge.is(n)||$n.is(n)||Do.is(n)||Vl.is(n)}e.is=t;function r(n){return e.is(n)||Ul.is(n)||Bl.is(n)}e.isRelated=r})(bs||(bs={}));var On;(function(e){function t(i){return i.type==="json:array"}e.isArray=t;function r(i){return i.type==="json:object"}e.isObject=r;function n(i){return i.type==="json:string"}e.isString=n})(On||(On={}));var et;(function(e){function t(n){return n?.type==="json:object"}e.is=t;function r(n){return{type:"json:object",range:y.get(n),children:[]}}e.mock=r})(et||(et={}));var Ul;(function(e){function t(r){return r.type==="pair"}e.is=t})(Ul||(Ul={}));var Ft;(function(e){function t(n){return n?.type==="json:array"}e.is=t;function r(n){return{type:"json:array",range:y.get(n),children:[]}}e.mock=r})(Ft||(Ft={}));var Bl;(function(e){function t(r){return r.type==="item"}e.is=t})(Bl||(Bl={}));var ks;(function(e){function t(r){return r.type==="json:string"}e.is=t})(ks||(ks={}));var Ge;(function(e){function t(n){return n?.type==="json:string"}e.is=t;function r(n){return O(k({},Qe.mock(n,ys)),{type:"json:string"})}e.mock=r})(Ge||(Ge={}));var $n;(function(e){function t(r){return r.type==="json:number"}e.is=t})($n||($n={}));var Do;(function(e){function t(r){return r.type==="json:boolean"}e.is=t})(Do||(Do={}));var Vl;(function(e){function t(r){return r.type==="json:null"}e.is=t})(Vl||(Vl={}));var sm=[`
`,":",'"'],ql={"json:object":"{$1}","json:array":"[$1]","json:string":'"$1"',"json:boolean":"${1|false,true|}","json:number":"${1:0}"},vk=(e,t)=>ue.dispatch(e,t),wk=ue.record({key:(e,t,r,n,i,o)=>e.expectation?Fo(e.expectation.filter(On.isObject).flatMap(a=>Nk(n,e,a,r,i,o,t?.key?.value))):[],value:(e,t,r)=>t.value&&!y.isEmpty(t.value)?ue.dispatch(t.value,r):e.expectation?Fo(e.expectation.filter(On.isObject).filter(n=>n.fields).map(n=>n.fields.find(i=>i.key===t.key?.value)).flatMap(n=>cm(r.offset,n.value,r))):[]}),xk=(e,t)=>{let r=Fu(e.children,t.offset,(i,o)=>i.sep?y.compareOffset(y.translate(i,0,-1),o,!0):y.compareOffset(i.range,o,!0)),n=r>=0?e.children[r]:void 0;return n?.value?ue.dispatch(n.value,t):e.expectation&&y.contains(y.translate(e,1,-1),t.offset,!0)?Fo(e.expectation.filter(On.isArray).filter(i=>i.items).flatMap(i=>cm(t.offset,i.items,t))):[]},Sk=e=>["false","true"].map(t=>Mo(e,t)),Ck=(e,t)=>e.children?.length?ue.string(e,t):e.expectation?Fo(e.expectation.filter(On.isString).flatMap(r=>Zl(e,r,t))):[];function Nk(e,t,r,n,i,o,a){return r.fields?r.fields.filter(s=>s.key===a||!t.children.find(l=>s.key===l.key?.value)).map(s=>Rk(e,s,i,o)):r.keys?r.keys.flatMap(s=>Zl(e,s,n).map(l=>k(k({},l),i?{insertText:`${l.insertText}: ${o?",":""}`}:{}))):[]}function Rk(e,t,r,n){let i=t.value?.[0]?ql[t.value[0].type]:"";return be.create(t.key,e,{kind:10,detail:t.value?.map(o=>o.typedoc).join(" | "),sortText:`${t.deprecated?2:t.opt?1:0}${t.key}`,deprecated:t.deprecated,filterText:`"${t.key}"`,insertText:`"${t.key}"${r?`: ${i}`:""}${n?",":""}`})}function cm(e,t,r){return Fo(t.flatMap(n=>{switch(n.type){case"json:object":case"json:array":return[Mo(e,ql[n.type])];case"json:string":return Zl(r.offset,n,r);case"json:boolean":return["false","true"].map(i=>Mo(e,i));case"json:number":return[Mo(e,"0")]}}))}function Zl(e,t,r){return Array.isArray(t.pool)?t.pool.map(n=>be.create(n,e,{kind:12,filterText:`"${n}"`,insertText:`"${n}"`})):[Mo(e,ql[t.type])]}function Mo(e,t){return be.create(t.replace("$1",""),e,{kind:12,insertText:t})}function Fo(e){let t=[],r=new Set;return e.forEach(n=>{r.has(n.label)||(r.add(n.label),t.push(n))}),t}function lm(e){e.registerCompleter("json:entry",vk),e.registerCompleter("json:array",xk),e.registerCompleter("json:boolean",Sk),e.registerCompleter("json:object",wk),e.registerCompleter("json:string",Ck)}var Tk=(e,t)=>e.children.length===0?"[]":`[
${e.children.map(n=>{let i=n.value&&t.meta.getFormatter(n.value.type)(n.value,bc(t));return`${t.indent(1)}${i??""}`}).join(`,
`)}
${t.indent()}]`,jk=(e,t)=>e.children.length===0?"{}":`{
${e.children.map(n=>{let i=n.key&&Gt.string(n.key,t),o=n.value&&t.meta.getFormatter(n.value.type)(n.value,bc(t));return`${t.indent(1)}${i??""}: ${o??""}`}).join(`,
`)}
${t.indent()}}`;function fm(e){e.registerFormatter("json:array",Tk),e.registerFormatter("json:boolean",Gt.boolean),e.registerFormatter("json:null",()=>"null"),e.registerFormatter("json:number",Gt.float),e.registerFormatter("json:object",jk),e.registerFormatter("json:string",Gt.string)}function j(e,t){t.ops.set(e,"expectation",[{type:"json:boolean",typedoc:"Boolean"}]),Do.is(e)||t.err.report(h("expected",h("boolean")),e)}function De(e){return(t,r)=>e()(t,r)}function L(e,t){return(r,n)=>{t(r,O(k({},n),{context:e}))}}function Ek(e,t,r){let n=O(k({},r),{err:new ft,ops:new Tr,symbols:r.symbols.clone()});e(t,n);let i=t.expectation;return n.ops.undo(),{totalErrorSpan:n.err.errors.map(a=>a.range.end-a.range.start).reduce((a,s)=>a+s,0),maxSeverity:Math.max(...n.err.errors.map(a=>a.severity)),expectation:i,updateNodeAndCtx:()=>{r.err.absorb(n.err),n.ops.redo(),n.symbols.applyDelayedEdits()}}}function K(e=[]){return(t,r)=>{if(e.length===0)return;let n=e.map(a=>Ek(a,t,r)).sort((a,s)=>a.maxSeverity-s.maxSeverity||a.totalErrorSpan-s.totalErrorSpan),i=n.filter(a=>a.expectation?.map(s=>s.type).includes(t.type)),o=n.filter(a=>a.expectation).flatMap(a=>a.expectation);if(i.length===0){let a=o.map(s=>h(s.type.slice(5)));r.err.report(h("expected",cr(a,!1)),t)}else i[0].updateNodeAndCtx();r.ops.set(t,"expectation",o)}}function Uo(e,t){let r={type:"json:null",range:y.create(0)},n=O(k({},t),{err:new ft,depth:(t.depth??0)+1});return e(r,n),r.expectation}function N(e){return(t,r)=>{r.ops.set(t,"expectation",[{type:"json:array",typedoc:"Array"}]),(!r.depth||r.depth<=0)&&r.ops.set(t.expectation[0],"items",Uo(e,r)),Ft.is(t)?t.children.filter(n=>n.value).forEach(n=>e(n.value,r)):r.err.report(h("expected",h("array")),t)}}function dm(e,t={}){let r=t.items??(i=>[Ge.is(i)?i.value:void 0,i]),n=t.report??((i,o)=>o.err.report(h("json.checker.item.duplicate"),i,2));return(i,o)=>{if(N(e)(i,o),Ft.is(i)){let a=new Map,s=new Set;i.children.forEach(l=>{if(!l.value)return;let[c,u]=r(l.value);if(!c)return;let p=a.get(c);p&&(s.add(p),s.add(u)),a.set(c,u)}),s.forEach(l=>n(l,o))}}}var vs=e=>(t,r)=>(n,i)=>{let o="Number"+(t===void 0&&r===void 0?"":`(${t??"-\u221E"}, ${r??"+\u221E"})`);i.ops.set(n,"expectation",[{type:"json:number",typedoc:o}]),!$n.is(n)||e==="integer"&&!Number.isInteger(n.value)?i.err.report(h("expected",h(e)),n):t!==void 0&&r!==void 0&&(n.value<t||n.value>r)?i.err.report(h("expected",h("number.between",t,r)),n):t!==void 0&&n.value<t?i.err.report(h("expected",h("number.>=",t)),n):r!==void 0&&n.value>r&&i.err.report(h("expected",h("number.<=",r)),n)},E=vs("integer")(void 0,void 0),Z=vs("float")(void 0,void 0),C=vs("integer"),I=vs("float");function lt(e){return e?.checker!==void 0}function Ne(e,t,r={}){return(n,i)=>{if(i.ops.set(n,"expectation",[{type:"json:object",typedoc:"Object"}]),!i.depth||i.depth<=0)if(Array.isArray(e)&&t){let o=e.map(a=>[a,t(a,i)]).filter(([a,s])=>s!==void 0);i.ops.set(n.expectation[0],"fields",o.map(([a,s])=>k(k({key:a,value:Uo(lt(s)?s.checker:s,i)},lt(s)&&(s.opt||s.deprecated)?{opt:!0}:{}),lt(s)&&s.deprecated?{deprecated:!0}:{})))}else typeof e=="function"&&t&&i.ops.set(n.expectation[0],"keys",Uo(e,i)?.filter(ks.is));if(!et.is(n))i.err.report(h("expected",h("object")),n);else if(Array.isArray(e)&&t){let o=n.children.map(a=>a.key?.value);e.forEach(a=>{let s=t(a,i);!s||lt(s)&&(s.opt||s.deprecated)||o.includes(a)||i.err.report(h("json.checker.property.missing",D(a)),y.create(n.range.start,n.range.start+1))}),n.children.filter(a=>a.key).forEach(a=>{let s=a.key.value,l=t(s,i);if(!l||!e.includes(s)){r.allowUnknownProperties||i.err.report(h("json.checker.property.unknown",D(s)),a.key,2);return}lt(l)&&l.deprecated&&i.err.report(h("json.checker.property.deprecated",D(s)),a.key,0,{deprecated:!0});let c=i.context+(lt(l)&&l.context?`.${l.context}`:""),u=h(`json.doc.${c}`),p=a.value!==void 0?a.value:{type:"json:null",range:y.create(0)},d=lt(l)?l.checker:l;try{d(p,O(k({},i),{context:`${c}.${s}`}))}catch(T){let b=i.doc.positionAt(a.range.start);i.logger.error(`Checking "${s}" at ${b.line}:${b.character} in "${i.doc.uri}"`,T)}let m=lt(l)?l.def:void 0,_=p.expectation?.map(T=>T.typedoc).join(" | ");a.key.hover=`\`\`\`typescript
${c}.${s}: ${_}
\`\`\`${u||m!==void 0?`
******
 `:""}${u}${m!==void 0?`
\`@default\` ${JSON.stringify(m)}`:""}`})}else typeof e=="function"&&t&&n.children.filter(o=>o.key).forEach(o=>{if(e(o.key,i),o.value!==void 0){let a=t(o.key.value,i);a&&(lt(a)?a.checker:a)(o.value,i)}})}}function w(e,t){return Ne(Object.keys(e),r=>e[r],t)}function f(e,t){if(e!==void 0)return lt(e)?O(k({},e),{opt:!0,def:t}):{checker:e,opt:!0,def:t}}function mm(e){if(e!==void 0)return lt(e)?O(k({},e),{deprecated:!0}):{checker:e,deprecated:!0}}function F(e,t){return(r,n)=>{if(!et.is(r))n.err.report(h("expected",h("object")),r);else if(t){let i=r.children.findIndex(s=>s.key?.value===e),o=r.children[i],a=o?.value?.type==="json:string"?o.value.value:void 0;t(a,r.children,n)(r,n)}else e(r.children,n)(r,n)}}function te(e,t){if(e===void 0)return{};let r=t[W.shorten(e)];return r===void 0?{}:(Object.keys(r).forEach(n=>{let i=r[n];i!==void 0&&(r[n]={checker:lt(i)?i.checker:i,opt:lt(i)?i.opt:void 0,deprecated:lt(i)?i.deprecated:void 0,context:W.shorten(e)})}),r)}function Et(e,t,r,n={}){return e===void 0?{}:t.includes(W.shorten(e))?r:n}function Re(e,t){let r=t?.find(n=>n.key?.value===e);return r?.value?.type==="json:string"?r.value.value:void 0}function hm(e,t,r){let n=r?.find(o=>o.key?.value===e);if(n?.value?.type!=="json:object")return;let i=n.children?.find(o=>o.key?.value===t);return i?.type==="json:string"?i.value:void 0}function ws(e,t){let r=t?.find(n=>n.key?.value===e);return r?.value?.type==="json:array"&&r.value.children?.every(n=>n.value?.type==="json:string")?r.value.children.map(n=>n.value.value):void 0}function Hl(e,t,r){let n=new Set(et.is(e)?e.children.map(a=>a.key?.value):[]),i=Object.keys(r).find(a=>n.has(a));if(i===void 0)return t.err.report(h("json.checker.property.missing",Object.keys(r)),y.create(e.range.start,e.range.start+1)),Object.fromEntries(Object.entries(r).map(([a,s])=>[a,f(typeof s=="function"?K():s[a]??K())]));let o=r[i];return typeof o=="function"?o():o}function v(e,t=!1){return Ze(e,Te(typeof e=="string"?{category:e,allowTag:t}:{pool:e.map(W.lengthen)}),it.resourceLocation)}function M(e){return typeof e=="string"?Ze(e,pi(e)):Ze(e,Ee(...e))}function Ze(e,t,r,n){return(i,o)=>{if(o.ops.set(i,"expectation",[k({type:"json:string",typedoc:Ok(e)},n)]),!Ge.is(i))o.err.report(h("expected",h("string")),i);else if(t){let a=kn(vr.resolve(t),i.value,i.valueMap,o);a!==G&&(i.children=[a],a.parent=i,r&&vr.resolve(r)(a,o))}else r&&vr.resolve(r)(i,o)}}function Ok(e){return e?typeof e=="string"?`String("${e}")`:e.slice(0,10).map(t=>`"${t}"`).join(" | ")+(e.length>10?" | ...":""):"String"}var X=Ze();var gm=({meta:e})=>{e.registerLanguage("json",{extensions:[".json",".mcmeta"],triggerCharacters:sm,parser:Gr}),e.registerParser("json:entry",Gr),rm(e),lm(e),fm(e)};function Kl(e){return(t,r)=>{if(!r.ensureChecked){X(t,r);return}let n=Object.values(r.symbols.query(r.doc,"advancement",e).symbol?.members??{}).filter(i=>i?.subcategory==="criterion").map(i=>i.identifier);M(n)(t,r)}}function zk(e,t,r){return r.symbols.query(r.doc,e,W.lengthen(t)).symbol?.definition?.map(n=>n.uri)??[]}function _r(e,t,r){let n=o=>Ge.is(o)?o.value:o.children.find(a=>a.key?.value==="id").value.value;return[...zk(e,t,r).reduce((o,a)=>{let s=r.getDocAndNode(a);if(!s||s.node.parserErrors.length||s.node.checkerErrors?.length)return o;let l=s.node.children[0],c=l.children.find(m=>m.key?.value==="replace")?.value,u=l.children.find(m=>m.key?.value==="values")?.value,p=c?.value,d=u.children.map(m=>W.lengthen(n(m.value)));p&&(o=new Set);for(let m of d)o.add(m);return o},new Set)]}function ir({category:e,id:t,ids:r,tag:n,mixedTypes:i,requireAll:o}){return(a,s)=>{if(n?r=_r(`tag/${e??"block"}`,n,s):t&&(r=[t]),!r?.length||!s.ensureChecked){let c=i?K([j,X,_m()]):X;Ne(X,()=>o?c:f(c))(a,s);return}let l=rn(e??"block",r,s);Ne(Object.keys(l),c=>{let u=l[c]??[],p=[M(u)];i&&u.length&&(["true","false"].includes(u[0])?p.push(j):u[0].match(/^\d+$/)&&p.push(_m(parseInt(u[0]),parseInt(u[u.length-1]))));let d=p.length>1?K(p):p[0];return o?d:f(d)})(a,s)}}function ym({category:e,id:t,ids:r,tag:n}){return(i,o)=>{if(n?r=_r(`tag/${e??"block"}`,n,o):t&&(r=[t]),!r?.length||!o.ensureChecked){N(X)(i,o);return}let a=rn(e??"block",r,o);N(M(Object.keys(a)))(i,o)}}function _m(e=void 0,t=void 0){return K([C(e,t),w({min:f(C(e,t)),max:f(C(e,t))})])}function bm(){let e=/^[0-9a-f]{1,6}$/i,t=(r,n)=>{let i=0,o=r.cursor;if(r.trySkip("#")){let a=r.readRemaining();a.match(e)?i=parseInt(a,16):n.err.report(h("expected",h("json.checker.string.hex-color")),y.create(o,r))}else{let a=r.readRemaining();Ue.NamedColors.has(a)?i=Ue.NamedColors.get(a):n.err.report(h("expected",Ue.ColorNames),y.create(o,r))}return Ue.fromCompositeInt(i)};return(r,n)=>{if(n.ops.set(r,"expectation",[{type:"json:string",typedoc:'String("Color")',pool:Ue.ColorNames}]),!Ge.is(r))n.err.report(h("expected",h("string")),r);else{let i=kn(t,r.value,r.valueMap,n);i!==G&&n.ops.set(r,"color",{value:i,format:[ot.HexRGB],range:{start:r.range.start+1,end:r.range.end-1}})}}}function zn(){return(e,t)=>{!$n.is(e)||!Number.isInteger(e.value)?t.err.report(h("expected",h("integer")),e):t.ops.set(e,"color",{value:Ue.fromCompositeInt(e.value),format:[ot.CompositeInt]})}}function Ot(e){return Ak(e)?Lk(e):Ik(e)}function Ak(e){return typeof e.definition=="string"}function Lk({definition:e}){return(t,r)=>{if(!r.ensureChecked){X(t,r);return}let n=r.meta.getParserLazily("nbt:compound"),i=qe.definition(e);Ze("nbt",n,i)(t,r)}}function Ik(e){return(t,r)=>{let n=km(e,r);if(!r.ensureChecked){X(t,r);return}let i=r.meta.getParser("nbt:compound"),o=qe.index(e.registry,n);Ze("nbt",i,o)(t,r)}}function An(e){return(t,r)=>{let n=km(e,r);if(!r.ensureChecked){X(t,r);return}let i=r.meta.getParser("nbt:path"),o=qe.path(e.registry,n);Ze("nbt_path",i,o)(t,r)}}function km({registry:e,id:t,idOrTag:r,ids:n,tag:i},o){return r&&(r.startsWith("#")?i=r.slice(1):t=r),i&&(e==="block"||e==="item"||e==="entity_type")?n=_r(`tag/${e}`,i,o):t&&(n=[t]),n?.map(W.lengthen)}var vm=Ze("recipe_group",pi("recipe_group"));function wm(e){return[...new Set((e.find(t=>t.key?.value==="pattern"&&t.value?.type==="json:array")?.value?.children??[]).map(t=>t.value).filter(t=>t&&t.type==="json:string").flatMap(t=>[...t.value]).filter(t=>t!==" "))]}var Pk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,Vo=Ze(void 0,void 0,(e,t)=>{e.value.match(Pk)||t.err.report(h("expected",h("uuid")),e)});function Dk(e){return e.project.loadedVersion}function Gl(e,t){return gt.cmp(Dk(e),t)}function x(e,t,r,n){if(typeof t=="string"){let i=Gl(e,t)>=0;return r===void 0?r:Array.isArray(r)?i?r:[]:i?r:void 0}else{let i=Gl(e,r)<0;return t===void 0?t:Array.isArray(t)?i?t:n??[]:i?t:n??void 0}}function xm(e,t,r,n,i){return x(e,{[t]:i},r,{[n]:i})}function _t(e,t,r){return Gl(e,t)<0?r:mm(r)}function Mk(e){return e=e-1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}var Fk=64-2*(1+Math.log2(Mk(3e7))),Ss=(1<<Fk)-32,xs=(Ss>>1)-1,Wl=xs-Ss+1,Je=L("range",K([Z,F("type",e=>w(k(k({type:f(v("loot_number_provider_type"))},e===void 0?{min:Je,max:Je}:{}),te(e,{constant:{value:Z},uniform:{min:Je,max:Je},binomial:{n:Je,p:Je},score:{target:Uk,score:M("objective"),scale:f(Z)}}))))])),Uk=K([M(["this","killer","player_killer","direct_killer"]),F("type",e=>w(k({type:v("loot_score_provider_type")},te(e,{context:{target:M(["this","killer","player_killer","direct_killer"])},fixed:{name:X}}))))]),Sm=K([M(["this","killer","killer_player","block_entity"]),F("type",e=>w(k({type:v("loot_nbt_provider_type")},te(e,{context:{target:M(["this","killer","killer_player","block_entity"])},storage:{source:v("storage")}}))))]),xe=L("bounds",K([E,K([w({min:E,max:f(E)}),w({min:f(E),max:E})])])),He=L("bounds",K([Z,K([w({min:Z,max:f(Z)}),w({min:f(Z),max:Z})])])),V=L("block_state",F(e=>w({Name:v("block"),Properties:f(ir({id:Re("Name",e),requireAll:!0}))}))),Cm=L("fluid_state",F(e=>w({Name:v("fluid"),Properties:f(ir({id:Re("Name",e),category:"fluid",requireAll:!0}))}))),We=L("vertical_anchor",K([w({absolute:C(Wl,xs)}),w({above_bottom:C(Wl,xs)}),w({below_top:C(Wl,xs)})])),Wr=L("height_provider",K([We,F("type",e=>w(k({type:v("height_provider_type")},te(e,{constant:{value:We},uniform:{min_inclusive:We,max_inclusive:We},biased_to_bottom:{min_inclusive:We,max_inclusive:We,inner:f(C(1,void 0),1)},very_biased_to_bottom:{min_inclusive:We,max_inclusive:We,inner:f(C(1,void 0),1)},trapezoid:{min_inclusive:We,max_inclusive:We,plateau:f(E,0)},weighted_list:{distribution:N(w({data:De(()=>Wr),weight:E}))}}))))])),Ye=(e=void 0,t=void 0)=>L("float_provider",K([I(e,t),F("type",r=>w(k({type:v("float_provider_type")},te(r,{constant:{value:I(e,t)},uniform:{value:w({min_inclusive:I(e,t),max_exclusive:I(e,t)})},clamped_normal:{value:w({mean:Z,deviation:Z,min:I(e,t),max:I(e,t)})},trapezoid:{value:w({min:I(e,t),max:I(e,t),plateau:Z})}}))))])),ce=(e=void 0,t=void 0)=>L("int_provider",K([C(e,t),F("type",r=>w(k({type:v("int_provider_type")},te(r,{constant:{value:C(e,t)},uniform:{value:w({min_inclusive:C(e,t),max_inclusive:C(e,t)})},biased_to_bottom:{value:w({min_inclusive:C(e,t),max_inclusive:C(e,t)})},clamped:{value:w({min_inclusive:C(e,t),max_inclusive:C(e,t),source:De(()=>ce())})},clamped_normal:{value:w({mean:Z,deviation:Z,min_inclusive:C(e,t),max_inclusive:C(e,t)})},weighted_list:{distribution:N(w({data:De(()=>ce()),weight:E}))}}))))])),yt=(e,t,r)=>L("uniform_int",K([C(e,t),w({base:C(e,t),spread:C(0,r)})])),Nm=(e,t)=>L("inclusive_range",K([w({min_inclusive:C(e,t),max_inclusive:C(e,t)}),N(C(e,t))])),Jr=w({firstOctave:E,amplitudes:N(Z)}),Yr=["MOTION_BLOCKING","MOTION_BLOCKING_NO_LEAVES","OCEAN_FLOOR","OCEAN_FLOOR_WG","WORLD_SURFACE","WORLD_SURFACE_WG"],qo=["mainhand","offhand","head","chest","legs","feet"],Cs=["up","down","north","east","south","west"];var Bk=["key.jump","key.sneak","key.sprint","key.left","key.right","key.back","key.forward","key.attack","key.pickItem","key.use","key.drop","key.hotbar.1","key.hotbar.2","key.hotbar.3","key.hotbar.4","key.hotbar.5","key.hotbar.6","key.hotbar.7","key.hotbar.8","key.hotbar.9","key.inventory","key.swapOffhand","key.loadToolbarActivator","key.saveToolbarActivator","key.playerlist","key.chat","key.command","key.socialInteractions","key.advancements","key.spectatorOutlines","key.screenshot","key.smoothCamera","key.fullscreen","key.togglePerspective"],Vk=L("text_component",(e,t)=>w(O(k({},Hl(e,t,{text:{text:X},translate:{translate:X,with:f(N(Me),[])},selector:{selector:X,separator:f(x(t,"1.17",Me))},score:{score:w({name:X,objective:X,value:f(X)})},keybind:{keybind:M(Bk)},nbt:()=>O(k({nbt:X},Hl(e,t,{block:{block:X,nbt:An({registry:"block"})},entity:{entity:X,nbt:An({registry:"entity_type"})},storage:{storage:v("storage"),nbt:An({registry:"storage"})}})),{interpret:f(j,!1),separator:f(x(t,"1.17",Me))})})),{color:f(bm()),font:f(X),bold:f(j),italic:f(j),underlined:f(j),strikethrough:f(j),obfuscated:f(j),insertion:f(X),clickEvent:f(F("action",r=>w(k({action:M(["open_url","open_file","run_command","suggest_command","change_page","copy_to_clipboard"]),value:X},te(r,{run_command:{value:Ze("command",t.meta.getParserLazily("mcfunction:command"),t.meta.getChecker("mcfunction:command"))},change_page:{value:Ze("number",At({pattern:/\d+/,min:0}))}}))))),hoverEvent:f(F("action",(r,n,i)=>w(k({action:M(["show_text","show_item","show_entity"])},te(r,{show_text:{value:_t(i,"1.16",Me),contents:f(x(i,"1.16",Me))},show_item:{value:_t(i,"1.16",Ot({definition:"::minecraft::util::invitem::InventoryItem"})),contents:f(x(i,"1.16",F(o=>w({id:v("item"),count:f(E),tag:f(Ot({registry:"item",id:Re("id",o)}))}))))},show_entity:{value:_t(i,"1.16",w({name:f(X),type:f(v("entity_type")),id:f(Vo)})),contents:f(x(i,"1.16",w({name:f(Me),type:f(v("entity_type")),id:f(Vo)})))}}))))),extra:f(N(Me))}))(e,t)),Me=L("text_component",K([X,Vk,N(De(()=>Me))]));var qk=["empty","chest","command","selector","fishing","entity","gift","barter","advancement_reward","advancement_entity","generic","block"],Zk=["mansion","monument","player","frame","red_marker","blue_marker","target_x","target_point","player_off_map","player_off_limits","red_x","banner_white","banner_orange","banner_magenta","banner_light_blue","banner_yellow","banner_lime","banner_pink","banner_gray","banner_light_gray","banner_cyan","banner_purple","banner_blue","banner_brown","banner_green","banner_red","banner_black"],yr=L("predicate",F("condition",(e,t)=>w(k({condition:v("loot_condition_type")},te(e,{alternative:{terms:N(yr)},block_state_property:{block:v("block"),properties:ir({id:Re("block",t)})},damage_source_properties:{predicate:Ko},entity_properties:{entity:M(["this","killer","killer_player","direct_killer"]),predicate:le},entity_scores:{entity:M(["this","killer","killer_player","direct_killer"]),scores:Ne(M("objective"),()=>xe)},inverted:{term:yr},killed_by_player:{inverse:f(j,!1)},location_check:{offsetX:f(E,0),offsetY:f(E,0),offsetZ:f(E,0),predicate:tt},match_tool:{predicate:Fe},random_chance:{chance:I(0,1)},random_chance_with_looting:{chance:I(0,1),looting_multiplier:Z},reference:{name:v("predicate")},table_bonus:{enchantment:v("enchantment"),chances:N(I(0,1))},time_check:{value:xe,period:f(E)},value_check:{value:Je,range:xe},weather_check:{raining:f(j),thundering:f(j)}}))))),Rm=K([yr,N(yr)]),Ho=L("item_modifier",F("function",(e,t,r)=>w(O(k({function:v("loot_function_type")},te(e,{apply_bonus:k({enchantment:v("enchantment"),formula:v(["binomial_with_bonus_count","ore_drops","uniform_bonus_count"])},te(Re("formula",t),{binomial_with_bonus_count:{parameters:w({extra:Z,probability:I(0,1)})},uniform_bonus_count:{parameters:w({bonusMultiplier:Z})}})),copy_name:{source:M(["this","killer","killer_player","block_entity"])},copy_nbt:{source:Sm,ops:N(w({source:An({registry:"entity_type"}),target:An({registry:"item"}),op:M(["replace","append","merge"])}))},copy_state:{block:v("block"),properties:ym({id:Re("block",t)})},enchant_randomly:{enchantments:f(N(v("enchantment")))},enchant_with_levels:{levels:Je,treasure:f(j,!1)},exploration_map:{destination:f(v("worldgen/structure_feature"),"buried_treasure"),decoration:f(M(Zk),"mansion"),zoom:f(E,2),search_radius:f(E,50),skip_existing_chunks:f(j,!0)},fill_player_head:{entity:M(["this","killer","killer_player","direct_killer"])},limit_count:{limit:xe},looting_enchant:{count:Je,limit:f(E,0)},set_attributes:{modifiers:N(w({attribute:v("attribute"),name:X,operation:M(["addition","multiply_base","multiply_total"]),id:f(Vo),amount:Je,slot:K([M(qo),N(M(qo))])}))},set_contents:{type:x(r,"1.18",v("block_entity_type")),entries:N(Zo)},set_count:{count:Je,add:f(x(r,"1.17",j),!1)},set_damage:{damage:Je,add:f(x(r,"1.17",j),!1)},set_loot_table:{name:v("loot_table"),seed:f(E,0)},set_lore:{entity:f(M(["this","killer","killer_player","direct_killer"])),lore:N(Me),replace:f(j,!1)},set_name:{entity:f(M(["this","killer","killer_player","direct_killer"])),name:f(Me)},set_nbt:{tag:Ot({registry:"item"})},set_potion:{id:v("potion")},set_stew_effect:{effects:f(N(w({type:v("mob_effect"),duration:Je})),[])}})),{conditions:f(N(yr))})))),Tm=K([Ho,N(Ho)]),Zo=L("loot_entry",F("type",e=>w(O(k({type:v("loot_pool_entry_type"),weight:f(C(1,void 0),1),quality:f(E,0)},te(e,{alternatives:{children:N(Zo)},dynamic:{name:v(["contents"])},group:{children:N(Zo)},item:{name:v("item")},loot_table:{name:v("loot_table")},sequence:{children:N(Zo)},tag:{name:v("tag/item"),expand:j}})),{functions:f(N(Ho),[]),conditions:f(N(yr),[])})))),Hk=L("loot_pool",w({rolls:Je,bonus_rolls:f(Je,0),entries:N(Zo),functions:f(N(Ho),[]),conditions:f(N(yr),[])})),jm=L("loot_table",w({type:f(v(qk)),pools:f(N(Hk),[]),functions:f(N(Ho),[])}));var Kk=e=>["minecraft:bee_nest_destroyed","minecraft:bred_animals","minecraft:brewed_potion","minecraft:changed_dimension","minecraft:channeled_lightning","minecraft:construct_beacon","minecraft:consume_item","minecraft:cured_zombie_villager","minecraft:effects_changed","minecraft:enchanted_item","minecraft:enter_block","minecraft:entity_hurt_player","minecraft:entity_killed_player",...x(e,"1.18",["minecraft:fall_from_height"]),"minecraft:filled_bucket","minecraft:fishing_rod_hooked","minecraft:hero_of_the_village","minecraft:impossible","minecraft:inventory_changed","minecraft:item_durability_changed",...x(e,"1.16",["minecraft:item_used_on_block"]),"minecraft:killed_by_crossbow","minecraft:levitation",...x(e,"1.17",["minecraft:lightning_strike"]),"minecraft:location","minecraft:nether_travel","minecraft:placed_block",...x(e,"1.16",["minecraft:player_generates_container_loot"]),"minecraft:player_hurt_entity",...x(e,"1.16",["minecraft:player_interacted_with_entity"]),"minecraft:player_killed_entity","minecraft:recipe_unlocked",...x(e,"1.18",["minecraft:ride_entity_in_lava"]),"minecraft:shot_crossbow",...x(e,["minecraft:safely_harvest_honey"],"1.16"),"minecraft:slept_in_bed","minecraft:slide_down_block",...x(e,"1.17",["minecraft:started_riding"]),"minecraft:summoned_entity","minecraft:tame_animal",...x(e,"1.16",["minecraft:target_hit"]),"minecraft:tick",...x(e,"1.16",["minecraft:thrown_item_picked_up_by_entity"]),"minecraft:used_ender_eye","minecraft:used_totem",...x(e,"1.17",["minecraft:using_item"]),"minecraft:villager_trade","minecraft:voluntary_exile"],Fe=L("item",F((e,t)=>w(O(k({},x(t,{item:f(v("item"))},"1.17",{items:f(N(v("item")))})),{tag:f(v("tag/item")),count:f(xe),durability:f(He),potion:f(v("potion")),nbt:f(Ot({registry:"item",ids:ws("items",e),tag:Re("tag",e)})),enchantments:f(N(w({enchantment:f(v("enchantment")),levels:f(xe)})))})))),Om=L("block",F((e,t)=>w(O(k({},x(t,{block:f(v("block"))},"1.17",{blocks:f(N(v("block")))})),{tag:f(v("tag/block")),nbt:f(Ot({registry:"block",ids:ws("blocks",e),tag:Re("tag",e)})),state:f(ir({ids:ws("blocks",e),tag:Re("tag",e),mixedTypes:!0}))})))),$m=L("fluid",F(e=>w({fluid:f(v("fluid")),tag:f(v("tag/fluid")),state:f(ir({category:"fluid",id:Re("fluid",e),tag:Re("tag",e),mixedTypes:!0}))}))),tt=L("location",F((e,t)=>w({position:f(w({x:f(He),y:f(He),z:f(He)})),biome:f(v("worldgen/biome")),feature:f(X),dimension:f(v("dimension")),block:f(Om),fluid:f($m),light:f(w({light:xe})),smokey:f(x(t,"1.16",j))}))),Go=L("distance",w({x:f(He),y:f(He),z:f(He),absolute:f(He),horizontal:f(He)})),zm=L("mob_effect",w({amplifier:f(xe),duration:f(xe),ambient:f(j),visible:f(j)})),Gk=L("statistic",F("type",e=>w(O(k({type:v("stat_type")},te(e,{mined:{stat:v("block")},crafted:{stat:v("item")},used:{stat:v("item")},broken:{stat:v("item")},picked_up:{stat:v("item")},dropped:{stat:v("item")},killed:{stat:v("entity_type")},killed_by:{stat:v("entity_type")},custom:{stat:v("custom_stat")}})),{value:xe})))),Wk=L("player",F((e,t)=>w({gamemode:f(M(["survival","adventure","creative","spectator"])),level:f(xe),advancements:f(Ne(v("advancement"),r=>K([j,Ne(Kl(r),()=>j)]))),recipes:f(Ne(v("recipe"),()=>j)),stats:f(N(Gk)),looking_at:f(x(t,"1.17",De(()=>le)))}))),le=L("entity",F((e,t)=>w({type:f(v("entity_type",!0)),nbt:f(Ot({registry:"entity_type",idOrTag:Re("type",e)})),team:f(M("team")),location:f(tt),stepping_on:f(x(t,"1.17",tt)),distance:f(Go),flags:f(w({is_on_fire:f(j),is_sneaking:f(j),is_sprinting:f(j),is_swimming:f(j),is_baby:f(j)})),equipment:f(Ne(M(qo),()=>Fe)),effects:f(Ne(X,()=>zm)),player:f(Wk),vehicle:f(x(t,"1.16",De(()=>le))),passenger:f(x(t,"1.17",De(()=>le))),targeted_entity:f(x(t,"1.16",De(()=>le))),lightning_bolt:f(x(t,"1.17",w({blocks_set_on_fire:f(xe),entity_struck:f(De(()=>le))}))),fishing_hook:f(x(t,"1.16",w({in_open_water:f(j)}))),catType:f(X)}))),Ko=L("damage_source",w({is_explosion:f(j),is_fire:f(j),is_magic:f(j),is_projectile:f(j),is_lightning:f(j),bypasses_armor:f(j),bypasses_invulnerability:f(j),bypasses_magic:f(j),source_entity:f(le),direct_entity:f(le)})),Em=L("damage",w({dealt:f(xe),taken:f(xe),blocked:f(j),source_entity:f(le),type:f(Ko)})),je=K([le,N(De(()=>yr))]),Jk=L("criterion",F("trigger",(e,t,r)=>w({trigger:v(Kk(r)),conditions:f(F(n=>w(k(k(k({},x(r,"1.16",Et(e,["impossible"],{},{player:f(x(r,le,"1.16",je))}))),te(e,{bee_nest_destroyed:{block:f(v("block")),item:f(Fe),num_bees_inside:f(E)},bred_animals:{parent:f(x(r,le,"1.16",je)),partner:f(x(r,le,"1.16",je)),child:f(x(r,le,"1.16",je))},brewed_potion:{potion:f(v("potion"))},changed_dimension:{from:f(v("dimension")),to:f(v("dimension"))},channeled_lightning:{victims:f(N(x(r,le,"1.16",je)))},construct_beacon:{level:f(xe)},consume_item:{item:f(Fe)},cured_zombie_villager:{villager:f(x(r,le,"1.16",je)),zombie:f(x(r,le,"1.16",je))},effects_changed:{effects:f(Ne(v("mob_effect"),()=>zm)),source:f(x(r,le,"1.16",je))},enter_block:{block:f(v("block")),state:f(ir({id:Re("block",n)}))},enchanted_item:{levels:f(xe),item:f(Fe)},entity_hurt_player:{damage:f(Em)},entity_killed_player:{entity:f(x(r,le,"1.16",je)),killing_blow:f(Ko)},fall_from_height:{start_position:f(tt),distance:f(Go)},filled_bucket:{item:f(Fe)},fishing_rod_hooked:{entity:f(x(r,le,"1.16",je)),item:f(Fe)},hero_of_the_village:{location:f(x(r,"1.16",tt))},inventory_changed:{slots:f(w({empty:f(xe),occupied:f(xe),full:f(xe)})),items:f(N(Fe))},item_durability_changed:{delta:f(He),durability:f(He),item:f(Fe)},item_used_on_block:{item:f(Fe),location:f(tt)},killed_by_crossbow:{unique_entity_types:f(xe),victims:f(N(x(r,le,"1.16",je)))},levitation:{distance:f(Go),duration:f(He)},lightning_strike:{lightning:f(x(r,le,"1.16",je)),bystander:f(x(r,le,"1.16",je))},location:{location:f(x(r,"1.16",tt))},nether_travel:O(k({},x(r,{entered:f(tt)},"1.18",{start_position:f(tt)})),{exited:f(x(r,tt,"1.18")),distance:f(Go)}),placed_block:{block:f(v("block")),state:f(ir({id:Re("block",n)})),item:f(Fe),location:f(tt)},player_generates_container_loot:{loot_table:v("loot_table")},player_hurt_entity:{damage:f(Em),entity:f(x(r,le,"1.16",je))},player_interacted_with_entity:{item:f(Fe),entity:f(x(r,le,"1.16",je))},player_killed_entity:{entity:f(x(r,le,"1.16",je)),killing_blow:f(Ko)},recipe_unlocked:{recipe:v("recipe")},ride_entity_in_lava:{start_position:f(tt),distance:f(Go)},slept_in_bed:{location:f(x(r,"1.16",tt))},slide_down_block:{block:f(v("block"))},shot_crossbow:{item:f(Fe)},summoned_entity:{entity:f(x(r,le,"1.16",je))},tame_animal:{entity:f(x(r,le,"1.16",je))},target_hit:{projectile:f(x(r,le,"1.16",je)),shooter:f(x(r,le,"1.16",je)),signal_strength:f(xe)},thrown_item_picked_up_by_entity:{entity:f(x(r,le,"1.16",je)),item:f(Fe)},used_ender_eye:{distance:f(He)},used_totem:{item:f(Fe)},using_item:{item:f(Fe)},villager_trade:{villager:f(le),item:f(Fe)},voluntary_exile:{location:f(x(r,"1.16",tt))}})),Et(e,["hero_of_the_village","location","slept_in_bed","voluntary_exile"],{position:f(_t(r,"1.16",w({x:f(He),y:f(He),z:f(He)}))),biome:f(_t(r,"1.16",v("worldgen/biome"))),feature:f(_t(r,"1.16",X)),dimension:f(_t(r,"1.16",v("dimension"))),block:f(_t(r,"1.16",Om)),fluid:f(_t(r,"1.16",$m)),light:f(_t(r,"1.16",w({light:xe}))),smokey:f(_t(r,"1.16",j))})))))}))),Am=L("advancement",w({display:f(w({icon:F(e=>w({item:v("item"),nbt:f(Ot({registry:"item",id:Re("item",e)}))})),title:Me,description:Me,background:f(X),frame:f(M(["task","challenge","goal"]),"task"),show_toast:f(j,!0),announce_to_chat:f(j,!0),hidden:f(j,!1)})),parent:f(v("advancement")),criteria:Ne(Ze(void 0,void 0,(e,t)=>{if(!t.ensureChecked)return;let r=vi(t.doc.uri,t),n=`${r?.namespace}:${r?.identifier}`,i=e.value;t.symbols.query(t.doc,"advancement",n,i).enter({data:{subcategory:"criterion"},usage:{type:"definition",node:e}})}),()=>Jk),requirements:f(N(N((e,t)=>{if(!t.ensureChecked)return;let r=vi(t.doc.uri,t),n=`${r?.namespace}:${r?.identifier}`;Kl(n)(e,t)}))),rewards:f(w({function:f(v("function")),loot:f(N(v("loot_table"))),recipes:f(N(v("recipe"))),experience:f(E)}))}));var wi=L("rule_test",F("predicate_type",e=>w(k({predicate_type:v("rule_test")},te(e,{block_match:{block:v("block")},blockstate_match:{block_state:V},random_block_match:{block:v("block"),probability:I(0,1)},random_blockstate_match:{block_state:V,probability:I(0,1)},tag_match:{tag:v("tag/block")}}))))),Yk=L("pos_rule_test",F("predicate_type",e=>w(k(k({predicate_type:v("pos_rule_test")},te(e,{axis_aligned_linear_pos:{axis:M(["x","y","z"]),min_dist:f(C(0,255)),max_dist:f(C(0,255)),min_chance:f(I(0,1)),max_chance:f(I(0,1))}})),Et(e,["axis_aligned_linear_pos","linear_pos"],{}))))),Xk=L("processor_rule",F(e=>w({position_predicate:f(Yk,{predicate_type:"always_true"}),input_predicate:wi,location_predicate:wi,output_state:V,output_nbt:f(Ot({registry:"block",id:hm("output_state","Name",e)}))}))),Lm=L("processor",F("processor_type",e=>w(k({processor_type:v("worldgen/structure_processor")},te(e,{block_age:{mossiness:Z},block_ignore:{blocks:N(V)},block_rot:{integrity:I(0,1)},gravity:{heightmap:M(Yr)},protected_blocks:{value:v("tag/block")},rule:{rules:N(Xk)}}))))),Jl=L("processor_list",K([w({processors:N(Lm)}),N(Lm)])),Wo=L("processor_list",K([v("worldgen/processor_list"),Jl])),Im=L("template_element",F("element_type",(e,t,r)=>w(k(k({element_type:v("worldgen/structure_pool_element")},Et(e,["empty_pool_element"],{},{projection:M(["rigid","terrain_matching"])})),te(e,{feature_pool_element:{feature:x(r,or,"1.18",br)},legacy_single_pool_element:{location:v("structure"),processors:Wo},list_pool_element:{elements:N(Im)},single_pool_element:{location:v("structure"),processors:Wo}}))))),Yl=L("template_pool",w({name:X,fallback:v("worldgen/template_pool"),elements:N(w({weight:C(1,void 0),element:Im}))})),Qk=K([v("worldgen/template_pool"),Yl]),Ns=L("structure_feature",F("type",e=>w({type:v("worldgen/structure_feature"),config:w(k({},Et(e,["bastion_remnant","pillager_outpost","village"],{start_pool:Qk,size:C(0,7)},te(e,{buried_treasure:{probability:I(0,1)},mineshaft:{type:M(["normal","mesa"]),probability:I(0,1)},nether_fossil:{height:Wr},ocean_ruin:{biome_temp:M(["cold","warm"]),large_probability:I(0,1),cluster_probability:I(0,1)},ruined_portal:{portal_type:M(["standard","desert","jungle","mountain","nether","ocean","swamp"])},shipwreck:{is_beached:f(j,!1)}}))))})));function ru(...e){return[...new Set([].concat(...e).filter(t=>e.every(r=>r.includes(t))))]}function Si(e,t){if(e&&et.is(e)){let r=Re("Name",e.children);if(r)return r.startsWith("minecraft:")||(r=`minecraft:${r}`),Object.values(t.symbols.query(t.doc,"block",r).symbol?.members??{}).filter(n=>n?.subcategory==="state").filter(n=>Object.keys(n.members??{})[0]?.match(/^\d+$/)).map(n=>n.identifier)}else if(e&&Ft.is(e)){let r=e.children.map(n=>n.value).filter(n=>n).map(n=>Si(n,t));return ru(...r)}return[]}function Fm(e,t){if(!e||!et.is(e))return[];switch(Re("type",e.children)?.replace(/^minecraft:/,"")){case"dual_noise_provider":case"noise_provider":let r=e.children.find(l=>l.key?.value==="states")?.value;return Si(r,t);case"noise_threshold":let n=e.children.find(l=>l.key?.value==="low_states")?.value,i=e.children.find(l=>l.key?.value==="high_states")?.value;return ru(Si(n,t),Si(i,t));case"randomized_int_state_provider":let o=e.children.find(l=>l.key?.value==="source")?.value;return Fm(o,t);case"rotated_block_provider":case"simple_state_provider":let a=e.children.find(l=>l.key?.value==="state")?.value;return Si(a,t);case"weighted_state_provider":let s=e.children.find(l=>l.key?.value==="entries")?.value;if(s&&Ft.is(s)){let l=s.children.map(c=>c.value&&et.is(c.value)&&c.value.children.find(u=>u.key?.value==="data")?.value).filter(c=>c).map(c=>Si(c,t));return ru(...l)}}return[]}var Xl={seed:E,noise:Jr,scale:I(0,void 0)},ke=L("block_state_provider",F("type",(e,t,r)=>w(k({type:v("worldgen/block_state_provider_type")},te(e,{dual_noise_provider:O(k({},Xl),{variety:Nm(1,64),slow_noise:Jr,slow_scale:I(0,void 0),states:N(V)}),noise_threshold_provider:O(k({},Xl),{threshold:I(-1,1),high_chance:I(0,1),default_state:V,low_states:N(V),high_states:N(V)}),noise_provider:O(k({},Xl),{states:N(V)}),randomized_int_state_provider:{property:r.ensureChecked?M(Fm(t.find(n=>n.key?.value==="source")?.value,r)):X,values:ce(),source:ke},rotated_block_provider:{state:V},simple_state_provider:{state:V},weighted_state_provider:{entries:N(w({weight:C(1,void 0),data:V}))}}))))),xi={offset:f(N(C(-16,16)))},Xr=L("block_predicate_worldgen",F("type",e=>w(k({type:v("block_predicate_type")},te(e,{all_of:{predicates:N(Xr)},any_of:{predicates:N(Xr)},has_sturdy_face:O(k({},xi),{direction:M(Cs)}),inside_world_bounds:k({},xi),matching_block_tag:O(k({},xi),{tag:v("tag/block")}),matching_blocks:O(k({},xi),{blocks:N(v("block"))}),matching_fluids:O(k({},xi),{fluids:N(v("fluid"))}),not:{predicate:Xr},would_survive:O(k({},xi),{state:V})}))))),ev=L("block_placer",F("type",(e,t,r)=>w(k({type:v("worldgen/block_placer_type")},te(e,{column_placer:k({},x(r,{min_size:E,extra_size:E},"1.17",{size:ce(0,void 0)}))}))))),tv=L("feature_size",F("type",e=>w(k({type:v("worldgen/feature_size_type"),min_clipped_height:f(C(0,80))},te(e,{two_layers_feature_size:{limit:f(C(0,81),1),lower_size:f(C(0,16),0),upper_size:f(C(0,16),1)},three_layers_feature_size:{limit:f(C(0,81),1),upper_limit:f(C(0,80),1),lower_size:f(C(0,16),0),middle_size:f(C(0,16),1),upper_size:f(C(0,16),1)}}))))),rv=L("trunk_placer",F("type",e=>w(k({type:v("worldgen/trunk_placer_type"),base_height:C(0,32),height_rand_a:C(0,24),height_rand_b:C(0,24)},te(e,{bending_trunk_placer:{bend_length:ce(1,64),min_height_for_leaves:f(C(1,void 0),1)}}))))),nv=L("foliage_placer",F("type",(e,t,r)=>w(k({type:v("worldgen/foliage_placer_type"),radius:x(r,yt(0,8,8),"1.17",ce(0,16)),offset:x(r,yt(0,8,8),"1.17",ce(0,16))},te(e,{blob_foliage_placer:{height:C(0,16)},bush_foliage_placer:{height:C(0,16)},fancy_foliage_placer:{height:C(0,16)},jungle_foliage_placer:{height:C(0,16)},mega_pine_foliage_placer:{crown_height:x(r,yt(0,16,8),"1.17",ce(0,24))},pine_foliage_placer:{height:x(r,yt(0,16,8),"1.17",ce(0,24))},random_spread_foliage_placer:{foliage_height:ce(1,512),leaf_placement_attempts:C(0,256)},spruce_foliage_placer:{trunk_height:x(r,yt(0,16,8),"1.17",ce(0,24))}}))))),iv=L("tree_decorator",F("type",e=>w(k({type:v("worldgen/tree_decorator_type")},te(e,{alter_ground:{provider:ke},beehive:{probability:I(0,1)},cocoa:{probability:I(0,1)}}))))),Pm=e=>({state:V,radius:x(e,yt(0,4,4),"1.17",ce(0,8)),half_height:C(0,4),targets:N(V)}),Ql=e=>x(e,k({state_provider:ke,block_placer:ev,whitelist:N(V),blacklist:N(V)},x(e,{tries:E,xspread:E,yspread:E,zspread:E,can_replace:j,project:j,need_water:j},"1.17",{tries:f(C(1,void 0),128),xspread:f(C(0,void 0),7),yspread:f(C(0,void 0),3),zspread:f(C(0,void 0),7),can_replace:f(j,!1),project:f(j,!0),need_water:f(j,!1)})),"1.18",{tries:f(C(1,void 0),128),xz_spread:f(C(0,void 0)),y_spread:f(C(0,void 0)),feature:br}),Dm={foliage_radius:f(E,2),cap_provider:ke,stem_provider:ke},eu=e=>k({size:C(0,64)},x(e,{state:V,target:wi},"1.17",{discard_chance_on_air_exposure:I(0,1),targets:N(w({state:V,target:wi}))})),Jo=e=>({count:x(e,yt(-10,128,128),"1.17",ce(0,256))}),tu={maximum:E,bottom_offset:E,top_offset:E},Mm=e=>({surface:M(["floor","ceiling"]),depth:ce(1,128),vertical_range:C(1,256),extra_bottom_block_chance:I(0,1),extra_edge_column_chance:I(0,1),vegetation_chance:I(0,1),xz_radius:ce(),replaceable:v("tag/block"),ground_state:ke,vegetation_feature:x(e,De(()=>or),"1.18",De(()=>br))}),nu=L("decorator",F("type",(e,t,r)=>w({type:v("worldgen/decorator"),config:w(te(e,{carving_mask:{step:M(["air","liquid"]),probability:x(r,I(0,1),"1.16")},cave_surface:{surface:M(["floor","ceiling"]),floor_to_ceiling_search_range:E},chance:{chance:E},count:Jo(r),count_extra:{count:E,extra_chance:Z,extra_count:E},count_multilayer:Jo(r),count_noise:{noise_level:Z,below_noise:E,above_noise:E},count_noise_biased:{noise_to_count_ratio:E,noise_factor:Z,noise_offset:f(Z,0)},decorated:{outer:nu,inner:nu},depth_average:{baseline:E,spread:E},fire:Jo(r),glowstone:Jo(r),heightmap:{heightmap:x(r,"1.17",M(Yr))},heightmap_spread_double:{heightmap:x(r,"1.17",M(Yr))},lava_lake:{chance:E},range:k({},x(r,tu,"1.17",{height:Wr})),range_biased:tu,range_very_biased:tu,water_depth_threshold:{max_water_depth:E},water_lake:{chance:E}}))}))),ov=L("placement_modifier",F("type",e=>w(k({type:v("worldgen/placement_modifier_type")},te(e,{block_predicate_filter:{predicate:Xr},carving_mask:{step:M(["air","liquid"])},rarity_filter:{chance:C(1,void 0)},count:{count:ce(0,256)},count_on_every_layer:{count:ce(0,256)},noise_threshold_count:{noise_level:Z,below_noise:E,above_noise:E},noise_based_count:{noise_to_count_ratio:E,noise_factor:Z,noise_offset:f(Z)},environment_scan:{direction_of_search:M(["up","down"]),max_steps:C(1,32),target_condition:Xr,allowed_search_condition:f(Xr)},heightmap:{heightmap:M(Yr)},height_range:{height:Wr},random_offset:{xz_spread:ce(-16,16),y_spread:ce(-16,16)},surface_relative_threshold_filter:{heigtmap:M(Yr),min_inclusive:f(E),max_inclusive:f(E)},surface_water_depth_filter:{max_water_depth:E}}))))),Rs=L("feature",F("type",(e,t,r)=>w({type:v("worldgen/feature"),config:w(te(e,{bamboo:{probability:I(0,1)},basalt_columns:{reach:x(r,yt(0,2,1),"1.17",ce(0,3)),height:x(r,yt(1,5,5),"1.17",ce(1,10))},block_column:{direction:M(Cs),allowed_placement:Xr,prioritize_tip:j,layers:N(w({height:ce(0,void 0),provider:ke}))},block_pile:{state_provider:ke},decorated:{decorator:nu,feature:or},delta_feature:{contents:V,rim:V,size:x(r,yt(0,8,8),"1.17",ce(0,16)),rim_size:x(r,yt(0,8,8),"1.17",ce(0,16))},disk:Pm(r),dripstone_cluster:{floor_to_ceiling_search_range:C(1,512),height:ce(0,128),radius:ce(0,128),max_stalagmite_stalactite_height_diff:C(0,64),height_deviation:C(0,64),dripstone_block_layer_thickness:ce(0,128),density:Ye(0,2),wetness:Ye(0,2),chance_of_dripstone_column_at_max_distance_from_center:I(0,1),max_distance_from_edge_affecting_chance_of_dripstone_column:C(1,64),max_distance_from_center_affecting_height_bias:C(1,64)},emerald_ore:{state:V,target:V},end_gateway:{exit:f(N(E)),exact:j},end_spike:{crystal_invulnerable:f(j,!1),crystal_beam_target:f(N(E)),spikes:N(w({centerX:f(E,0),centerZ:f(E,0),radius:f(E,0),height:f(E,0),guarded:f(j,!1)}))},fill_layer:{height:C(0,Ss),state:V},flower:Ql(r),forest_rock:{state:V},fossil:{max_empty_corners_allowed:C(0,7),fossil_structures:N(v("structure")),overlay_structures:N(v("structure")),fossil_processors:Wo,overlay_processors:Wo},geode:{blocks:w({filling_provider:ke,inner_layer_provider:ke,alternate_inner_layer_provider:ke,middle_layer_provider:ke,outer_layer_provider:ke,inner_placements:N(V),cannot_replace:v("tag/block"),invalid_blocks:v("tag/block")}),layers:w({filling:f(I(.01,50),1.7),inner_layer:f(I(.01,50),2.2),middle_layer:f(I(.01,50),3.2),outer_layer:f(I(.01,50),4.2)}),crack:w({generate_crack_chance:f(I(0,1),1),base_crack_size:f(I(0,5),2),crack_point_offset:f(C(0,10),2)}),noise_multiplier:f(I(0,1),.05),use_potential_placements_chance:f(I(0,1),.35),use_alternate_layer0_chance:f(I(0,1),0),placements_require_layer0_alternate:f(j,!0),outer_wall_distance:f(ce(0,10),{value:{min_inclusive:0,max_inclusive:10}}),distribution_points:f(ce(1,20),{value:{min_inclusive:3,max_inclusive:4}}),point_offset:f(ce(0,10),{value:{min_inclusive:1,max_inclusive:2}}),min_gen_offset:f(E,-16),max_gen_offset:f(E,16),invalid_blocks_threshold:E},glow_lichen:{search_range:f(C(1,64),10),chance_of_spreading:f(I(0,1),.5),can_place_on_floor:f(j,!1),can_place_on_wall:f(j,!1),can_place_on_ceiling:f(j,!1),can_be_placed_on:N(x(r,V,"1.18",v("block")))},growing_plant:{direction:M(Cs),allow_water:j,height_distribution:N(w({weight:E,data:ce()})),body_provider:ke,head_provider:ke},huge_brown_mushroom:Dm,huge_fungus:{planted:f(j,!1),hat_state:V,decor_state:V,stem_state:V,valid_base_block:V},huge_red_mushroom:Dm,ice_patch:Pm(r),iceberg:{state:V},lake:x(r,{state:V},"1.18",{fluid:ke,barrier:ke}),large_dripstone:{floor_to_ceiling_search_range:f(C(1,512),30),column_radius:ce(0,20),height_scale:Ye(0,20),max_column_radius_to_cave_height_ratio:I(0,1),stalactite_bluntness:Ye(.1,10),stalagmite_bluntness:Ye(.1,10),wind_speed:Ye(0,2),min_radius_for_wind:C(0,100),min_bluntness_for_wind:I(0,5)},nether_forest_vegetation:k({state_provider:ke},x(r,"1.18",{spread_width:C(1,void 0),spread_height:ce(1,void 0)})),netherrack_replace_blobs:{radius:x(r,yt(),"1.17",ce(0,12)),state:V,target:V},no_bonemeal_flower:Ql(r),no_surface_ore:eu(r),ore:eu(r),pointed_dripstone:{chance_of_taller_dripstone:I(0,1),chance_of_directional_spread:I(0,1),chance_of_spread_radius2:I(0,1),chance_of_spread_radius3:I(0,1)},random_boolean_selector:{feature_false:x(r,or,"1.18",br),feature_true:x(r,or,"1.18",br)},random_patch:Ql(r),random_selector:{features:N(w({chance:I(0,1),feature:x(r,or,"1.18",br)})),default:x(r,or,"1.18",br)},replace_single_block:{targets:N(w({state:V,target:wi}))},root_system:{required_vertical_space_for_tree:C(1,64),root_radius:C(1,64),root_placement_attempts:C(1,256),root_column_max_height:C(1,4096),hanging_root_radius:C(1,64),hanging_roots_vertical_span:C(0,16),hanging_root_placement_attempts:C(0,256),allowed_vertical_water_for_tree:C(1,64),root_replaceable:v("tag/block"),root_state_provider:ke,hanging_root_state_provider:ke,allowed_tree_position:x(r,"1.18",Xr),feature:x(r,or,"1.18",br)},scattered_ore:eu(r),sea_pickle:Jo(r),seagrass:{probability:I(0,1)},simple_block:k({},x(r,x(r,{to_place:V,place_on:N(V),place_in:N(V),place_under:N(V)},"1.17",{to_place:ke,place_on:f(N(V),[]),place_in:f(N(V),[]),place_under:f(N(V),[])}),"1.18",{to_place:ke})),simple_random_selector:{features:x(r,iu,"1.18",ou)},small_dripstone:{max_placements:f(C(0,100),5),empty_space_search_radius:f(C(0,20),10),max_offset_from_origin:f(C(0,20),2),chance_of_taller_dripstone:f(I(0,1),.2)},spring_feature:{requires_block_below:f(j,!0),rock_count:f(E,4),hole_count:f(E,1),state:Cm,valid_blocks:N(v("block"))},tree:O(k({ignore_vines:f(j,!1),force_dirt:f(x(r,"1.17",j),!1),max_water_depth:x(r,E,"1.17"),heightmap:x(r,M(Yr),"1.17"),minimum_size:tv,dirt_provider:x(r,"1.17",ke),sapling_provider:x(r,"1.17",x(r,ke,"1.18")),trunk_provider:ke},xm(r,"leaves_provider","1.17","foliage_provider",ke)),{trunk_placer:rv,foliage_placer:nv,decorators:N(iv)}),twisting_vines:x(r,{},"1.18",{spread_width:C(1,void 0),spread_height:C(1,void 0),max_height:C(1,void 0)}),underwater_magma:{floor_search_range:C(0,512),placement_radius_around_floor:C(0,64),placement_probability_per_valid_position:I(0,1)},vegetation_patch:Mm(r),waterlogged_vegetation_patch:Mm(r)}))}))),or=K([v("worldgen/configured_feature"),Rs]),iu=K([N(v("worldgen/configured_feature")),N(Rs)]),Um=L("placed_feature",w({feature:or,placement:N(ov)})),br=K([v("worldgen/placed_feature"),Um]),ou=K([N(v("worldgen/placed_feature")),N(Um)]);var av=e=>["beach","desert","extreme_hills","forest","icy","jungle","mesa",...x(e,"1.18",["mountain"]),"mushroom","nether","none","ocean","plains","river","savanna","swamp","taiga","the_end",...x(e,"1.17",["underground"])],sv=e=>[...x(e,"1.18",["axolotls"]),"monster","creature","ambient","water_creature","water_ambient",...x(e,"1.17",["underground_water_creature"]),"misc"],au=L("surface_builder",w({type:v("worldgen/surface_builder"),config:w({top_material:V,under_material:V,underwater_material:V})})),su=L("carver",F("type",(e,t,r)=>w({type:v("worldgen/carver"),config:w(k({probability:I(0,1)},x(r,"1.17",k(k({y:Wr,yScale:Ye(),lava_level:We,aquifers_enabled:x(r,j,"1.18"),debug_settings:f(w({debug_mode:f(j),air_state:f(V),water_state:f(V),lava_state:f(V),barrier_state:f(V)}))},Et(e,["cave","nether_cave","underwater_cave"],{horizontal_radius_multiplier:Ye(),vertical_radius_multiplier:Ye(),floor_level:Ye(-1,1)})),Et(e,["canyon","underwater_canyon"],{vertical_rotation:Ye(),shape:w({distance_factor:Ye(),thickness:Ye(),width_smoothness:C(0,void 0),horizontal_radius_factor:Ye(),vertical_radius_default_factor:Z,vertical_radius_center_factor:Z})})))))}))),Bm=L("biome",F((e,t)=>w(O(k({},x(t,{depth:Z,scale:Z},"1.18")),{downfall:Z,temperature:Z,temperature_modifier:f(M(["none","frozen"])),precipitation:M(["none","rain","snow"]),category:M(av(t)),effects:w({sky_color:zn(),fog_color:zn(),water_color:zn(),water_fog_color:zn(),grass_color:f(zn()),foliage_color:f(zn()),grass_color_modifier:f(M(["none","dark_forest","swamp"])),particle:f(w({options:w({type:v("particle_type")}),probability:I(0,1)})),ambient_sound:f(v("sound_event")),mood_sound:f(w({sound:v("sound_event"),tick_delay:E,block_search_extent:E,offset:Z})),additions_sound:f(w({sound:v("sound_event"),tick_chance:I(0,1)})),music:f(w({sound:v("sound_event"),min_delay:E,max_delay:E,replace_current_music:j}))}),player_spawn_friendly:f(x(t,j,"1.18")),creature_spawn_probability:f(I(0,.9999999)),spawners:Ne(M(sv(t)),()=>N(w({type:v("entity_type"),weight:E,minCount:E,maxCount:E}))),spawn_costs:Ne(v("entity_type"),()=>w({energy_budget:Z,charge:Z})),surface_builder:x(t,K([v("worldgen/configured_surface_builder"),au]),"1.18"),carvers:Ne(["air","liquid"],()=>f(K([N(v("worldgen/configured_carver")),N(su)]))),starts:x(t,K([N(v("worldgen/configured_structure_feature")),N(Ns)]),"1.18"),features:N(x(t,iu,"1.18",ou))}))));var qm=L("material_condition",F("type",e=>w(k({type:v("worldgen/material_condition")},te(e,{biome:{biome_is:N(v("worldgen/biome"))},noise_threshold:{noise:v("worldgen/noise"),min_threshold:Z,max_threshold:Z},not:{invert:qm},stone_depth:{offset:E,surface_type:M(["floor","ceiling"]),add_surface_depth:j,add_surface_secondary_depth:j},vertical_gradient:{random_name:X,true_at_and_below:We,false_at_and_above:We},water:{offset:E,surface_depth_multiplier:C(-20,20),add_stone_depth:j},y_above:{anchor:We,surface_depth_multiplier:C(-20,20),add_stone_depth:j}}))))),cu=L("material_rule",F("type",e=>w(k({type:v("worldgen/material_rule")},te(e,{block:{result_state:V},condition:{if_true:qm,then_run:cu},sequence:{sequence:N(cu)}}))))),Ts=L("terrain_spline",K([Z,w({coordinate:M(["continents","erosion","weirdness","ridges"]),points:N(w({location:Z,value:De(()=>Ts),derivative:Z}))})])),Zm=L("structure_settings",w({stronghold:f(w({distance:C(0,1023),spread:C(0,1023),count:C(1,4095)})),structures:Ne(v("worldgen/structure_feature"),()=>w({spacing:C(0,4096),separation:C(0,4096),salt:C(0,void 0)}))})),Vm=F((e,t)=>w({target:Z,size:x(t,E,"1.17",C(0,void 0)),offset:E})),lu=L("noise_settings",F((e,t)=>w(O(k({bedrock_roof_position:x(t,E,"1.18"),bedrock_floor_position:x(t,E,"1.18"),sea_level:E,min_surface_level:x(t,"1.17",x(t,E,"1.18")),disable_mob_generation:j},x(t,"1.17",{noise_caves_enabled:j,noodle_caves_enabled:j,aquifers_enabled:j,deepslate_enabled:x(t,j,"1.18"),ore_veins_enabled:j})),{legacy_random_source:x(t,"1.18",j),default_block:V,default_fluid:V,noise:w({min_y:x(t,"1.17",C(-2048,2047)),height:C(0,4096),size_horizontal:C(1,4),size_vertical:C(1,4),density_factor:x(t,Z,"1.18"),density_offset:x(t,Z,"1.18"),simplex_surface_noise:x(t,j,"1.18"),random_density_offset:f(x(t,j,"1.18"),!1),island_noise_override:f(j,!1),amplified:f(j,!1),large_biomes:f(x(t,"1.18",j),!1),sampling:w({xz_scale:I(.001,1e3),y_scale:I(.001,1e3),xz_factor:I(.001,1e3),y_factor:I(.001,1e3)}),top_slide:Vm,bottom_slide:Vm,terrain_shaper:x(t,"1.18",w({offset:Ts,factor:Ts,jaggedness:Ts}))}),surface_rule:x(t,"1.18",cu),structures:Zm})))),Ci=K([I(-2,2),N(I(-2,2))]),cv=L("biome_source",F("type",(e,t,r)=>w(k({type:v("worldgen/biome_source")},te(e,{checkerboard:{scale:f(C(0,62),2),biomes:N(v("worldgen/biome"))},fixed:{biome:v("worldgen/biome")},multi_noise:O(k({seed:x(r,E,"1.18"),preset:f(x(r,M(["nether"]),"1.18",v(["minecraft:overworld","minecraft:nether"])))},x(r,{altitude_noise:Jr,temperature_noise:Jr,humidity_noise:Jr,weirdness_noise:Jr},"1.18")),{biomes:N(w({biome:v("worldgen/biome"),parameters:w(x(r,{altitude:Z,temperature:Z,humidity:Z,weirdness:Z,offset:Z},"1.18",{temperature:Ci,humidity:Ci,continentalness:Ci,erosion:Ci,weirdness:Ci,depth:Ci,offset:I(0,1)}))}))}),the_end:{seed:E},vanilla_layered:{seed:E,large_biomes:f(j,!1),legacy_biome_init_layer:f(j,!1)}}))))),uu=L("dimension_type",F((e,t)=>w({min_y:x(t,"1.17",C(-2048,2047)),height:x(t,"1.17",C(0,4096)),logical_height:x(t,C(0,256),"1.17",C(0,4096)),coordinate_scale:I(1e-5,3e7),ambient_light:Z,fixed_time:f(E),infiniburn:v("tag/block"),effects:f(v(["overworld","the_nether","the_end"]),"overworld"),ultrawarm:j,natural:j,piglin_safe:j,respawn_anchor_works:j,bed_works:j,has_raids:j,has_skylight:j,has_ceiling:j}))),Hm=L("dimension",w({type:K([v("dimension_type"),uu]),generator:L("chunk_generator",F("type",e=>w(k({type:v("worldgen/chunk_generator")},te(e,{flat:{settings:w({layers:N(w({block:v("block"),height:C(0,4096)})),biome:v("worldgen/biome"),lakes:f(j,!1),features:f(j,!1),structures:Zm})},noise:{seed:E,settings:K([v("worldgen/noise_settings"),lu]),biome_source:cv}})))))}));var Es=K([w({item:v("item")}),w({tag:v("tag/item")})]),js=K([Es,N(Es)]),fu=w({item:v("item"),count:f(C(1,64),1)}),Km=L("recipe",F("type",(e,t)=>w(k(k({type:v("recipe_serializer"),group:f(vm)},te(e,{crafting_shaped:{pattern:N(X),key:Ne(wm(t),()=>js),result:fu},crafting_shapeless:{ingredients:N(js),result:fu},stonecutting:{ingredient:js,result:v("item"),count:E},smithing:{base:Es,addition:Es,result:fu}})),Et(e,["blasting","campfire_cooking","smelting","smoking"],{ingredient:js,result:v("item"),experience:f(Z,0),cookingtime:f(E,e==="smelting"?200:100)})))));var Ni=e=>w({replace:f(j,!1),values:dm(K([v(e,!0),w({id:v(e,!0),required:f(j,!0)})]),{items:t=>{if(Ge.is(t))return[W.shorten(t.value),t];if(et.is(t)){let r=t.children.find(n=>n.key?.value==="id");if(r&&r.value&&Ge.is(r.value))return[W.shorten(r.value.value),r.value]}return[void 0,t]},report:(t,r)=>r.err.report(h("json.checker.tag-entry.duplicate"),t,2)})}),Gm=Ni("block"),Wm=Ni("entity_type"),Jm=Ni("fluid"),Ym=Ni("function"),Xm=Ni("game_event"),Qm=Ni("item");var eh=L("pack",w({pack:w({pack_format:E,description:Me})},{allowUnknownProperties:!0})),pu=new Map([["advancement",Am],["dimension",Hm],["dimension_type",uu],["item_modifier",Tm],["loot_table",jm],["predicate",Rm],["recipe",Km],["tag/block",Gm],["tag/entity_type",Wm],["tag/fluid",Jm],["tag/function",Ym],["tag/game_event",Xm],["tag/item",Qm],["worldgen/biome",Bm],["worldgen/configured_carver",su],["worldgen/configured_surface_builder",au],["worldgen/configured_feature",Rs],["worldgen/configured_structure_feature",Ns],["worldgen/noise_settings",lu],["worldgen/processor_list",Jl],["worldgen/template_pool",Yl]]);var Ri=(e,t)=>{let r=vi(t.doc.uri,t);if(r&&pu.has(r.category))pu.get(r.category)(e,O(k({},t),{context:""}));else if(t.doc.uri.endsWith("/pack.mcmeta"))eh(e,O(k({},t),{context:""}));else return};function th(e){e.registerChecker("json:array",Ri),e.registerChecker("json:boolean",Ri),e.registerChecker("json:null",Ri),e.registerChecker("json:number",Ri),e.registerChecker("json:object",Ri),e.registerChecker("json:string",Ri)}var nh=e=>{gm(e),th(e.meta)};function oh(e){e.registerColorizer("mcfunction:command_child/literal",Oe.literal),e.registerColorizer("mcfunction:command_child/trailing",Oe.error)}var Is={};ar(Is,{command:()=>ch,entry:()=>lv});var Os;(function(e){function t(n){return n.type==="mcfunction:command"}e.is=t;function r(n){return{type:"mcfunction:command",range:y.get(n),children:[]}}e.mock=r})(Os||(Os={}));var $s;(function(e){function t(r){return r.type==="mcfunction:command_child"}e.is=t})($s||($s={}));var sh;(function(e){function t(r){return r?.type==="mcfunction:command_child/literal"}e.is=t})(sh||(sh={}));var zs;(function(e){function t(r){return r?.type==="mcfunction:entry"}e.is=t})(zs||(zs={}));var Yo,As=class{constructor(){P(this,Yo,new Map);if(As._instance)throw new Error("Use the `instance` static property to get an instance.")}register(t,r,n){g(this,Yo).set(t,n?Ai(r,n):r)}get(t){let r=g(this,Yo).get(t);if(!r)throw new Error(`No command tree exist for version \u201C${t}\u201D`);return r}static get instance(){return this._instance??(this._instance=new As)}},$t=As;Yo=new WeakMap,re($t,"_instance");function du(e,t){return t.reduce((r,n)=>r?.children?.[n],e)}function Ln(e,t,r){return e?.redirect?{treeNode:du(t,e.redirect),path:[...e.redirect]}:e&&!e.children&&!e.executable?{treeNode:t,path:[]}:{treeNode:e,path:r}}function Ls(e){let t={literalTreeNodes:[],argumentTreeNodes:[]};for(let r of Object.entries(e))r[1].type==="literal"?t.literalTreeNodes.push(r):r[1].type==="argument"&&t.argumentTreeNodes.push(r);return t}function lv(e,t){return(r,n)=>{let i=$t.instance.get(e),o=Ie.findChild(r,n.offset,!0);return Un.is(o)?[]:ch(i,t)(o??Os.mock(n.offset),n)}}function ch(e,t){return(r,n)=>{let i=Ie.findChildIndex(r,n.offset,!0),o=r.children[i]?.children[0];if(o)return ue.dispatch(o,n);let a=Ie.findLastChild(r,n.offset);if(!a)return Object.keys(e.children??{}).map(p=>be.create(p,n.offset,{kind:14}));let s=a.path,{treeNode:l}=Ln(du(e,s),e);if(!l?.children)return[];let{literalTreeNodes:c,argumentTreeNodes:u}=Ls(l.children);return[...c.map(([p])=>be.create(p,n.offset,{kind:14})),...u.flatMap(([p,d])=>ye.toArray(t(d,n.offset)).flatMap(m=>ue.dispatch(m,n)))]}}function lh(e,t){let r=t.parser.slice(t.parser.indexOf(":")+1);return`<${e}: ${r}>`}var Xo=(e,t)=>{let r=e.cursor,n=e.readSpace();return n!==" "&&t.err.report(h("expected",h("mcfunction.parser.sep",D(" "))),y.create(r,e)),n};function uh(e,t=!1){let r={pool:e,colorTokenType:t?"keyword":"literal"};return(n,i)=>{let o=n.cursor,a=n.readUntil(" ","\r",`
`);if(!a.length)return G;let s={type:"mcfunction:command_child/literal",range:y.create(o,n),options:r,value:a};return e.includes(a)||i.err.report(h("expected",e),s),s}}function Ps(e,t){return(r,n)=>{let i={type:"mcfunction:command",range:y.create(r),children:[]},o=r.cursor;if(r.trySkip("/")&&(i.slash=y.create(o,r.cursor)),uv(i.children,r,n,[],e,e,t),r.canReadInLine()){let a=pv(r,n);i.children.push({type:"mcfunction:command_child",range:a.range,children:[a],path:[]})}return i.range.end=r.cursor,i}}function uv(e,t,r,n,i,o,a){function s(c,u){let{treeNode:p,path:d}=Ln(u,i,c);c=d;let m=p?.children;if(!m)return!1;let{literalTreeNodes:_,argumentTreeNodes:T}=Ls(m),b=T.map(([pe,R])=>({name:pe,parser:a(R)??fv(R)})),S=_.length?uh(_.map(([pe,R])=>pe),p.type==="root"):void 0,z=[...S?[S]:[],...b.map(pe=>pe.parser)],q={index:0},J=(z.length>1?Ct(z,q):z[0])(t,r);if(J!==G){let pe=b[q.index-(S?1:0)]?.name??J.value,R=[...c,pe];e.push({type:"mcfunction:command_child",range:J.range,children:[J],path:R});let A=m[pe];if(!A)return!1;let H=A.permission??2;if(r.config.env.permissionLevel<H&&r.err.report(h("mcfunction.parser.no-permission",H,r.config.env.permissionLevel),J),J.type==="mcfunction:command_child/unknown")return!1;if(t.canReadInLine())return Xo(t,r),{childPath:R,childTreeNode:A};A.executable||r.err.report(h("mcfunction.parser.eoc-unexpected"),t)}else r.err.report(h("expected",mv(m)),y.create(t));return!1}let l=s(n,o);for(;l;)l=s(l.childPath,l.childTreeNode)}function fv(e){return(t,r)=>{let n=t.cursor,i=t.readUntilLineEnd(),o=y.create(n,t);return r.err.report(h("mcfunction.parser.unknown-parser",D(e.parser)),o,0),{type:"mcfunction:command_child/unknown",range:o,value:i}}}var pv=(e,t)=>{let r=e.cursor,n=e.readUntilLineEnd(),i=y.create(r,e);return t.err.report(h("mcfunction.parser.trailing",D(n)),i),{type:"mcfunction:command_child/trailing",range:i,value:n}};function dv(e,t){return t?`[${e}]`:e}function mu(e,t=!1){return Object.entries(e).map(([n,i])=>dv(hu(n,i),t))}function mv(e){let t=mu(e);return t.length>5?`${t.slice(0,3).join("|")}|...|${t.slice(-2).join("|")}`:t.join("|")}function hu(e,t){return t.type==="argument"?lh(e,t):e}function fh(e,t){return(r,n)=>{let i={type:"mcfunction:entry",range:y.create(r),children:[]};for(;r.skipWhitespace().canReadInLine();){let o;r.peek()==="#"?o=hv(r,n):o=Ps($t.instance.get(e),t)(r,n),i.children.push(o),r.nextLine()}return i.range.end=r.cursor,i}}var hv=lo({singleLinePrefixes:new Set(["#"])});var ph=({meta:e})=>{oh(e),e.registerCompleter("mcfunction:command_child/literal",ue.literal)};var Ds;(function(e){function t(r){return r.type==="mcfunction:block/states"}e.is=t})(Ds||(Ds={}));var Ut;(function(e){function t(n){return n?.type==="mcfunction:block"}e.is=t;function r(n,i){let o=Q.mock(n,{category:"block",allowTag:i});return{type:"mcfunction:block",range:y.get(n),children:[o],id:o}}e.mock=r})(Ut||(Ut={}));var Ms;(function(e){function t(n){return{type:"mcfunction:coordinate",range:y.get(n),notation:"",value:0}}e.mock=t;function r(n){let i=n.value%360;return i>=180?i-360:i<-180?i+360:i}e.toDegree=r})(Ms||(Ms={}));var Fs;(function(e){function t(r){return r.type==="mcfunction:entity_selector/arguments"}e.is=t})(Fs||(Fs={}));var mh=["a","e","p","r","s"],dh;(function(e){function t(r){return mh.includes(r)}e.is=t})(dh||(dh={}));var ea=mh.map(e=>`@${e}`),Ti;(function(e){function t(r){return ea.includes(r)}e.is=t})(Ti||(Ti={}));var Bt;(function(e){function t(i){return i?.type==="mcfunction:entity_selector"}e.is=t;function r(i){let o=$e.mock(i,{pool:ea,colorTokenType:"keyword"});return{type:"mcfunction:entity_selector",range:y.get(i),children:[o],variable:"e"}}e.mock=r,e.ArgumentKeys=new Set(["advancements","distance","gamemode","level","limit","name","nbt","predicate","scores","sort","tag","team","type","x","y","z","dx","dy","dz","x_rotation","y_rotation"]);function n(i,o,a){let s=c=>!!o.children.find(u=>u.key?.value===c),l=c=>!!o.children.find(u=>u.key?.value===c&&!u.value?.inverted);switch(a){case"advancements":case"distance":case"level":case"scores":case"x":case"y":case"z":case"dx":case"dy":case"dz":case"x_rotation":case"y_rotation":return s(a)?1:0;case"gamemode":case"name":case"team":return l(a)?1:0;case"limit":case"sort":return i.currentEntity?2:s(a)?1:0;case"type":return i.typeLimited?s(a)?1:2:0}return 0}e.canKeyExist=n})(Bt||(Bt={}));var ji;(function(e){function t(r){return r?.type==="mcfunction:entity"}e.is=t})(ji||(ji={}));var Qr;(function(e){function t(n){return n?.type==="mcfunction:item"}e.is=t;function r(n,i){let o=Q.mock(n,{category:"item",allowTag:i});return{type:"mcfunction:item",range:y.get(n),children:[o],id:o}}e.mock=r})(Qr||(Qr={}));var Us;(function(e){function t(r){return{type:"mcfunction:int_range",range:y.get(r),children:[],value:[void 0,void 0]}}e.mock=t})(Us||(Us={}));var en;(function(e){e.SimpleValues=["air","armor","deathCount","dummy","food","health","level","playerKillCount","totalKillCount","trigger","xp"],e.ComplexCategories=new Map([["broken","item"],["crafted","item"],["custom","custom_stat"],["dropped","item"],["killed","entity_type"],["killed_by","entity_type"],["mined","block"],["picked_up","item"],["used","item"]]),e.ComplexSep=":";function t(r){return{type:"mcfunction:objective_criteria",range:y.get(r)}}e.mock=t})(en||(en={}));var In;(function(e){let t=new Set(["block","block_marker","dust","dust_color_transition","falling_dust","item","sculk_charge","vibration"]);function r(o){return t.has(o)}e.isSpecialType=r;function n(o){return o?.type==="mcfunction:particle"}e.is=n;function i(o){let a=Q.mock(o,{category:"particle_type"});return{type:"mcfunction:particle",range:y.get(o),children:[a],id:a}}e.mock=i})(In||(In={}));var Bs;(function(e){function t(r){let n=xt.mock(r,{category:"score_holder"});return{type:"mcfunction:score_holder",range:y.get(r),children:[n],fakeName:n}}e.mock=t})(Bs||(Bs={}));var Vs;(function(e){e.UnitToTicks=new Map([["",1],["t",1],["s",20],["d",24e3]]),e.Units=[...e.UnitToTicks.keys()]})(Vs||(Vs={}));var bt;(function(e){function t(r,n){return{type:"mcfunction:vector",range:y.get(r),children:[],options:n,system:0}}e.mock=t})(bt||(bt={}));var gv=(e,t)=>{e.slash&&e.parent&&zs.is(e.parent)&&t.err.report(h("unexpected-leading-slash"),e.slash),hh(e.children,0,t)},kt=(e,t)=>e[t]?.path[e[t].path.length-1],vt=(e,t)=>e[t]?.children[0],hh=(e,t,r)=>{for(let{children:[n]}of e)Ut.is(n)?gh(n,r):ji.is(n)?_h(n,r):Qr.is(n)?yh(n,r):In.is(n)?bh(n,r):bs.is(n)&&Me(n,O(k({},r),{context:""}));if(kt(e,t)==="data")if(kt(e,t+1)==="get")qs(e,t+2,r);else if(kt(e,t+1)==="merge")_v(e,t+2,r);else if(kt(e,t+1)==="modify"){qs(e,t+2,r);let n=vt(e,t+4)}else kt(e,t+1)==="remove"&&qs(e,t+2,r);else if(kt(e,t)==="execute"){for(let n=t+1;n<e.length;n++)if((kt(e,n)==="if"||kt(e,n)==="unless")&&kt(e,n+1)==="data")qs(e,n+2,r),n+=2;else if(kt(e,n)==="run"){hh(e,n+1,r);break}}else kt(e,t)==="summon"&&yv(e,t+1,r)},gh=(e,t)=>{!e.nbt||qe.index("block",Q.toString(e.id,"full"))(e.nbt,t)},_h=(e,t)=>{let r=e.selector?.arguments?.children.find(o=>o.key?.value==="nbt");if(!r)return;let n=gu(e,t),i=r.value;qe.index("entity_type",n)(i,t)},yh=(e,t)=>{!e.nbt||qe.index("item",Q.toString(e.id,"full"))(e.nbt,t)},bh=(e,t)=>{it.dispatchSync(e,t)},_v=(e,t,r)=>{switch(kt(e,t)){case"block":{let i=vt(e,t+2);Mt.is(i)&&qe.index("block",void 0)(i,r);break}case"entity":{let i=vt(e,t+1),o=vt(e,t+2);if(ji.is(i)&&Mt.is(o)){let a=gu(i,r);qe.index("entity_type",a)(o,r)}break}case"storage":{let i=vt(e,t+1),o=vt(e,t+2);Q.is(i)&&Mt.is(o)&&qe.index("storage",Q.toString(i,"full"))(o,r);break}}},qs=(e,t,r)=>{switch(kt(e,t)){case"block":{let i=vt(e,t+2);ki.is(i)&&qe.path("block",void 0)(i,r);break}case"entity":{let i=vt(e,t+1),o=vt(e,t+2);if(ji.is(i)&&ki.is(o)){let a=gu(i,r);qe.path("entity_type",a)(o,r)}break}case"storage":{let i=vt(e,t+1),o=vt(e,t+2);Q.is(i)&&ki.is(o)&&qe.path("storage",Q.toString(i,"full"))(o,r);break}}},yv=(e,t,r)=>{let n=vt(e,t),i=vt(e,t+2);Q.is(n)&&Mt.is(i)&&qe.index("entity_type",Q.toString(n,"full"))(i,r)},gu=(e,t)=>{if(e.playerName!==void 0||e.selector?.playersOnly)return["minecraft:player"];if(e.selector){let r=e.selector.arguments;if(!r)return;let n=[];for(let i of r.children){if(i.key?.value!=="type")continue;let o=i.value;if(!o||o.inverted)continue;let a=Q.toString(o.value,"full");if(a.startsWith(W.TagPrefix)){let s=_r("tag/entity_type",a.slice(1),t);n=n.filter(l=>s.includes(l))}else n=[a]}return n}};function kh(e){e.registerChecker("mcfunction:command",gv),e.registerChecker("mcfunction:block",gh),e.registerChecker("mcfunction:entity",_h),e.registerChecker("mcfunction:item",yh),e.registerChecker("mcfunction:particle",bh)}var bv=e=>[Ce.create(e,"type")],kv=e=>[Ce.create(e,"vector")];function wh(e){e.registerColorizer("mcfunction:coordinate",Oe.number),e.registerColorizer("mcfunction:vector",kv),e.registerColorizer("mcfunction:objective_criteria",bv)}var Zs=[...Ue.ColorNames,"reset"],Hs=["feet","eyes"],Ks=[...[...Array(54).keys()].map(e=>`container.${e}`),...[...Array(27).keys()].map(e=>`enderchest.${e}`),...[...Array(15).keys()].map(e=>`horse.${e}`),...[...Array(9).keys()].map(e=>`hotbar.${e}`),...[...Array(27).keys()].map(e=>`inventory.${e}`),...[...Array(8).keys()].map(e=>`villager.${e}`),"armor.chest","armor.feet","armor.head","armor.legs","horse.armor","horse.chest","horse.saddle","weapon","weapon.mainhand","weapon.offhand"],Gs=["=","+=","-=","*=","/=","%=","<",">","><"],Ws=["belowName","list","sidebar",...Ue.ColorNames.map(e=>`sidebar.team.${e}`)],Js=["x","xy","xz","xyz","xzy","y","yx","yz","yxz","yzx","z","zx","zy","zxy","zyx"];var Sh=(e,t)=>{let r=e;switch(r.parser){case"brigadier:bool":return ha.mock(t);case"brigadier:double":case"brigadier:float":case"brigadier:integer":case"brigadier:long":case"minecraft:float_range":case"minecraft:message":case"minecraft:time":case"minecraft:uuid":return[];case"brigadier:string":return r.properties.type==="phrase"?Qe.mock(t,Dr):[];case"minecraft:angle":return Ms.mock(t);case"minecraft:block_pos":return bt.mock(t,{dimension:3,integersOnly:!0});case"minecraft:block_predicate":return Ut.mock(t,!0);case"minecraft:block_state":return Ut.mock(t,!1);case"minecraft:color":return $e.mock(t,{pool:Zs});case"minecraft:column_pos":return bt.mock(t,{dimension:2,integersOnly:!0});case"minecraft:component":return[Ft.mock(t),et.mock(t),Ge.mock(t)];case"minecraft:dimension":return Q.mock(t,{category:"dimension"});case"minecraft:entity":case"minecraft:game_profile":return Bt.mock(t);case"minecraft:entity_anchor":return $e.mock(t,{pool:Hs});case"minecraft:entity_summon":return Q.mock(t,{category:"entity_type"});case"minecraft:function":return Q.mock(t,{category:"function"});case"minecraft:int_range":return Us.mock(t);case"minecraft:item_enchantment":return Q.mock(t,{category:"enchantment"});case"minecraft:item_predicate":return Qr.mock(t,!0);case"minecraft:item_slot":return $e.mock(t,{pool:Ks});case"minecraft:item_stack":return Qr.mock(t,!1);case"minecraft:mob_effect":return Q.mock(t,{category:"mob_effect"});case"minecraft:objective":return xt.mock(t,{category:"objective"});case"minecraft:objective_criteria":return en.mock(t);case"minecraft:operation":return $e.mock(t,{pool:Gs,colorTokenType:"operator"});case"minecraft:particle":return In.mock(t);case"minecraft:resource":case"minecraft:resource_or_tag":return Q.mock(t,{category:W.shorten(r.properties.registry),allowTag:r.parser==="minecraft:resource_or_tag"});case"minecraft:resource_location":return Q.mock(t,r.properties??{pool:[],allowUnknown:!0});case"minecraft:rotation":return bt.mock(t,{dimension:2,noLocal:!0});case"minecraft:scoreboard_slot":return $e.mock(t,{pool:Ws});case"minecraft:score_holder":return Bs.mock(t);case"minecraft:swizzle":return $e.mock(t,{pool:Js});case"minecraft:team":return xt.mock(t,{category:"team"});case"minecraft:vec2":return bt.mock(t,{dimension:2,integersOnly:!0});case"minecraft:vec3":return bt.mock(t,{dimension:3});case"spyglassmc:tag":return xt.mock(t,{category:"tag"});case"minecraft:nbt_compound_tag":case"minecraft:nbt_path":case"minecraft:nbt_tag":default:return[]}},vv=(e,t)=>{let r=[];return y.contains(e.id,t.offset,!0)&&r.push(...ue.resourceLocation(e.id,t)),e.states&&y.contains(y.translate(e.states,1,-1),t.offset,!0)&&r.push(...wv(e.states,t)),r},wv=(e,t)=>{if(!Ut.is(e.parent))return[];let r=e.parent.id,n=Q.toString(r,"full"),i=r.isTag?_r("tag/block",n,t):[n],o=rn("block",i,t);return ue.record({key:(a,s,l,c,u,p,d)=>Object.keys(o).filter(m=>s?.key?.value===m||!d.some(_=>_.value===m)).map(m=>be.create(m,c,{kind:10,detail:h("mcfunction.completer.block.states.default-value",D(o[m][0])),insertText:new Bi().literal(m).if(u,_=>_.literal("=").placeholder(...o[m])).if(p,_=>_.literal(",")).build()})),value:(a,s,l)=>s.key&&o[s.key.value]?o[s.key.value].map(c=>be.create(c,s.value??l.offset,{kind:12})):[]})(e,t)},xv=(e,t)=>[be.create("~",e)],Sv=(e,t)=>{let r=[];return y.contains(e.id,t.offset,!0)&&r.push(...ue.resourceLocation(e.id,t)),r},Cv=(e,t)=>{let r=en.SimpleValues.map(n=>be.create(n,e));return(!e.children?.[0]||y.contains(e.children[0],t.offset,!0))&&r.push(...ue.resourceLocation(e.children?.[0]??Q.mock(e,{category:"stat_type",namespacePathSep:"."}),t)),e.children?.[1]&&y.contains(e.children[1],t.offset,!0)&&r.push(...ue.resourceLocation(e.children[1],t)),r},Nv=(e,t)=>{let r=Ie.findChild(e,t.offset,!0);if(r)return ue.dispatch(r,t);let n=Q.toString(e.id,"short"),i={block:[Ut.mock(t.offset,!1)],block_marker:[Ut.mock(t.offset,!1)],dust:[bt.mock(t.offset,{dimension:3}),sr.mock(t.offset)],dust_color_transition:[bt.mock(t.offset,{dimension:3}),sr.mock(t.offset),bt.mock(t.offset,{dimension:3})],falling_dust:[Ut.mock(t.offset,!1)],item:[Qr.mock(t.offset,!1)],sculk_charge:[sr.mock(t.offset)],vibration:[bt.mock(t.offset,{dimension:3}),bt.mock(t.offset,{dimension:3}),Bn.mock(t.offset)]};if(In.isSpecialType(n)){let o=e.children?.slice(1).filter(s=>s.range.end<t.offset).length??0,a=i[n][o];if(a)return ue.dispatch(a,t)}return[]},Rv=(e,t)=>{let r;return e.selector&&y.contains(e.selector,t.offset,!0)?(r=_u(e.selector,t),y.contains(e.children[0],t.offset,!0)&&r.push(...ue.symbol(xt.mock(e,{category:"score_holder"}),t))):(r=ue.symbol(e.fakeName??xt.mock(e,{category:"score_holder"}),t),r.push(..._u(Bt.mock(e),t))),r},_u=(e,t)=>y.contains(e.children[0],t.offset,!0)?ue.literal(e.children[0],t):e.arguments&&y.contains(y.translate(e.arguments,1,-1),t.offset,!0)?Ch(e.arguments,t):[],Ch=(e,t)=>{let r=e.parent;return Bt.is(r)?ue.record({key:(n,i,o,a,s,l)=>[...Bt.ArgumentKeys].filter(c=>Bt.canKeyExist(r,n,c)===0).map(c=>be.create(c,a,{kind:10,insertText:new Bi().literal(c).if(s,u=>u.literal("=").placeholder()).if(l,u=>u.literal(",")).build()})),value:(n,i,o)=>i.value?ue.dispatch(i.value,o):[]})(e,t):[]},Tv=(e,t)=>[be.create("-2147483648..2147483647",e,{kind:21})],jv=(e,t)=>{let r=(i,o)=>be.create(new Array(e.options.dimension).fill(i).join(" "),e,{sortText:o}),n=[];return n.push(r("~","a")),e.options.noLocal||n.push(r("^","b")),n.push(r("0.0","c")),n};function Nh(e){e.registerCompleter("mcfunction:block",vv),e.registerCompleter("mcfunction:coordinate",xv),e.registerCompleter("mcfunction:entity_selector",_u),e.registerCompleter("mcfunction:entity_selector/arguments",Ch),e.registerCompleter("mcfunction:int_range",Tv),e.registerCompleter("mcfunction:item",Sv),e.registerCompleter("mcfunction:objective_criteria",Cv),e.registerCompleter("mcfunction:particle",Nv),e.registerCompleter("mcfunction:score_holder",Rv),e.registerCompleter("mcfunction:vector",jv)}var Th=(e,t)=>{if(e.children[0]?.type!=="mcfunction:entry")return[];let r=[];return Kt(e,n=>!0,$s.is,n=>{let i=n,o=t.config.env.feature.inlayHint;(o===!0||typeof o=="object"&&o.enabledNodes.includes(i.children[0].type))&&r.push({offset:i.range.start,text:`${i.path[i.path.length-1]}:`})}),r};var Eh=/^-?\d+$/,Oh=/^-?(?:\d+\.?\d*|\.\d+)$/,$h=Number.MAX_VALUE,Ev=-$h,zh=(2-2**-23)*2**127,Ov=-zh,$v=2**31-1,zv=-(2**31),Ah=9223372036854775807n,Av=-9223372036854775808n,Lv=40,Iv=16,Pv=16;function Dv(e){let t=e.project.loadedVersion;return!t||gt.cmp(t,"1.18")<0}var bu=e=>{let t=e,r=n=>de(dr(n,"\r",`
`));switch(t.parser){case"brigadier:bool":return r(Za);case"brigadier:double":return r(Xs(t.properties?.min,t.properties?.max));case"brigadier:float":return r($i(t.properties?.min,t.properties?.max));case"brigadier:integer":return r(ta(t.properties?.min,t.properties?.max));case"brigadier:long":return r(Mv(t.properties?.min,t.properties?.max));case"brigadier:string":switch(t.properties.type){case"word":return r(Uh);case"phrase":return r(vn);case"greedy":default:return r(Ih)}case"minecraft:angle":return r(co(yu(),n=>n.notation!=="^",h("mcfunction.parser.vector.local-disallowed")));case"minecraft:block_pos":return r(Ei({dimension:3,integersOnly:!0}));case"minecraft:block_predicate":return r(ku);case"minecraft:block_state":return r(Ys);case"minecraft:color":return r(ie(Ee(...Zs),n=>O(k({},n),{color:Ue.NamedColors.has(n.value)?Ue.fromCompositeInt(Ue.NamedColors.get(n.value)):void 0})));case"minecraft:column_pos":return r(Ei({dimension:2,integersOnly:!0}));case"minecraft:component":return r(vu);case"minecraft:dimension":return r(Te({category:"dimension"}));case"minecraft:entity":return r(jh(t.properties.amount,t.properties.type));case"minecraft:entity_anchor":return r(Ee(...Hs));case"minecraft:entity_summon":return r(Te({category:"entity_type"}));case"minecraft:float_range":return r(Oi("float"));case"minecraft:function":return r(Te({category:"function",allowTag:!0}));case"minecraft:game_profile":return r(jh("multiple","players"));case"minecraft:int_range":return r(Oi("integer"));case"minecraft:item_enchantment":return r(Te({category:"enchantment"}));case"minecraft:item_predicate":return r(Fv);case"minecraft:item_slot":return r(Ee(...Ks));case"minecraft:item_stack":return r(Dh);case"minecraft:message":return r(Uv);case"minecraft:mob_effect":return r(Te({category:"mob_effect"}));case"minecraft:nbt_compound_tag":return r(nr.compound);case"minecraft:nbt_path":return r(nr.path);case"minecraft:nbt_tag":return r(nr.entry);case"minecraft:objective":return r(Fh(Di.is(t.properties?.usageType)?t.properties?.usageType:void 0));case"minecraft:objective_criteria":return r(Zv);case"minecraft:operation":return r(Ee({pool:Gs,colorTokenType:"operator"}));case"minecraft:particle":return r(wu);case"minecraft:resource":case"minecraft:resource_or_tag":return r(Te({category:W.shorten(t.properties.registry),allowTag:t.parser==="minecraft:resource_or_tag"}));case"minecraft:resource_location":return r(Te(t.properties??{pool:[],allowUnknown:!0}));case"minecraft:rotation":return r(Ei({dimension:2,noLocal:!0}));case"minecraft:score_holder":return r(qv(t.properties.amount));case"minecraft:scoreboard_slot":return r(Ee(...Ws));case"minecraft:swizzle":return r(Ee(...Js));case"minecraft:team":return r(ec(Di.is(t.properties?.usageType)?t.properties?.usageType:void 0));case"minecraft:time":return r(Hv);case"minecraft:uuid":return r(Bh);case"minecraft:vec2":return r(Ei({dimension:2,noLocal:!0}));case"minecraft:vec3":return r(Ei({dimension:3}));case"spyglassmc:tag":return r(Qs());default:return}};function Lh(e){return ie(ve([Te({category:"block",allowTag:e}),_e(ie(de(Lt({start:"[",pair:{key:Ke(O(k({},Dr),{colorTokenType:"property"})),sep:"=",value:vn,end:",",trailingEnd:!0},end:"]"})),t=>O(k({},t),{type:"mcfunction:block/states"}))),_e(de(nr.compound))]),t=>({type:"mcfunction:block",range:t.range,children:t.children,id:t.children.find(Q.is),states:t.children.find(Ds.is),nbt:t.children.find(Mt.is)}))}var Ys=Lh(!1),ku=Lh(!0),vu=Po.json();function Xs(e=Ev,t=$h){return Xt({pattern:Oh,min:e,max:t})}function $i(e=Ov,t=zh){return Xt({pattern:Oh,min:e,max:t})}function ta(e=zv,t=$v){return At({pattern:Eh,min:e,max:t})}function Mv(e,t){return uo({pattern:Eh,min:BigInt(e??Av),max:BigInt(t??Ah)})}function yu(e=!1){return(t,r)=>{let n={type:"mcfunction:coordinate",notation:"",range:y.create(t),value:0};if(t.trySkip("^")?n.notation="^":t.trySkip("~")&&(n.notation="~"),t.canReadInLine()&&t.peek()!==" "||n.notation===""){let i=(e&&n.notation===""?ta:Xs)()(t,r);n.value=Number(i.value)}return n.range.end=t.cursor,n}}function jh(e,t){return ie(me([{predicate:r=>Ti.is(r.peek(2)),parser:xu()},{parser:Ct([Cu(vn,Pv,"mcfunction.parser.entity-selector.player-name.too-long"),Bh])}]),(r,n,i)=>{let o={type:"mcfunction:entity",range:r.range,children:[r]};return Qe.is(r)?o.playerName=r:Bt.is(r)?o.selector=r:o.uuid=r,e==="single"&&o.selector&&!o.selector.single&&i.err.report(h("mcfunction.parser.entity-selector.multiple-disallowed"),o),t==="players"&&(o.uuid||o.selector&&!o.selector.playersOnly&&!o.selector.currentEntity)&&i.err.report(h("mcfunction.parser.entity-selector.entities-disallowed"),o),o})}var Ih=Ke({unquotable:{blockList:new Set([`
`,"\r"])}});function Ph(e){return ie(ve([Te({category:"item",allowTag:e}),_e(de(nr.compound))]),t=>({type:"mcfunction:item",range:t.range,children:t.children,id:t.children.find(Q.is),nbt:t.children.find(Mt.is)}))}var Dh=Ph(!1),Fv=Ph(!0),Uv=(e,t)=>{let r={type:"mcfunction:message",range:y.create(e),children:[]};for(;e.canReadInLine();)Ti.is(e.peek(2))?r.children.push(xu()(e,t)):r.children.push(dr(Ih,...ea)(e,t));return r},wu=(()=>{let e=ie(Xo,()=>[]),t=Ei({dimension:3}),r=ie(t,i=>O(k({},i),{color:i.children.length===3?{value:Ue.fromDecRGB(i.children[0].value,i.children[1].value,i.children[2].value),format:[ot.DecRGB]}:void 0})),n={block:Ys,block_marker:Ys,dust:ve([r,$i()],e),dust_color_transition:ve([r,$i(),r],e),falling_dust:Ys,item:Dh,sculk_charge:$i(),vibration:ve([t,t,ta()],e)};return ie(ve([Te({category:"particle_type"}),{get:i=>n[Q.toString(i.children[0],"short")]}],e),i=>({type:"mcfunction:particle",range:i.range,children:i.children,id:i.children.find(Q.is)}))})();function Oi(e,t,r,n){let i=e==="float"?$i(t,r):ta(t,r),o=de(dr(i,"..")),a=de(Ee({pool:[".."],colorTokenType:"keyword"})),s=de(i);return ie(Ct([ve([o]),ve([o,a]),ve([a,s]),ve([o,a,s])]),(l,c,u)=>{let p=e==="float"?l.children.filter(sr.is):l.children.filter(Bn.is),d=l.children.find($e.is),m={type:e==="float"?"mcfunction:float_range":"mcfunction:int_range",range:l.range,children:l.children,value:d?p.length===2?[p[0].value,p[1].value]:y.endsBefore(p[0].range,d.range.start)?[p[0].value,void 0]:[void 0,p[0].value]:[p[0].value,p[0].value]};return!n&&m.value[0]!==void 0&&m.value[1]!==void 0&&m.value[0]>m.value[1]&&u.err.report(h("mcfunction.parser.range.min>max",m.value[0],m.value[1]),l),m})}function xu(){let e,t,r,n,i,o,a;return ie(ve([de(Ee({pool:ea,colorTokenType:"keyword"})),{get:s=>{let l=$e.is(s.children?.[0])?s.children[0].value:void 0;t=l?l==="@s":void 0,n=l?l==="@p"||l==="@a"||l==="@r":void 0,i=l==="@e"?["Entity::isAlive"]:void 0,o=l?l==="@p"||l==="@r"||l==="@s":void 0,a=n;function c(u){return ie(ve([_e(de(Ee({pool:["!"],colorTokenType:"keyword"}))),p=>{p.skipSpace()},u]),p=>({type:"mcfunction:entity_selector/arguments/value/invertable",range:p.range,children:p.children,inverted:!!p.children.find(m=>$e.is(m)&&m.value==="!"),value:p.children.find(m=>!$e.is(m)||m.value!=="!")}))}return _e(ie(de(Lt({start:"[",pair:{key:Ke(O(k({},Dr),{value:{parser:Ee({pool:[...Bt.ArgumentKeys],colorTokenType:"property"}),type:"literal"}})),sep:"=",value:{get:(u,p)=>{let d=_=>!!u.children.find(T=>T.key?.value===_),m=_=>!!u.children.find(T=>T.key?.value===_&&!T.value?.inverted);switch(p?.value){case"advancements":return ie(Lt({start:"{",pair:{key:Te({category:"advancement"}),sep:"=",value:me([{predicate:_=>_.peek()==="{",parser:ie(Lt({start:"{",pair:{key:Uh,sep:"=",value:Za,end:",",trailingEnd:!0},end:"}"}),_=>O(k({},_),{type:"mcfunction:entity_selector/arguments/advancements/criteria"}))},{parser:Za}]),end:",",trailingEnd:!0},end:"}"}),(_,T,b)=>(d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),O(k({},_),{type:"mcfunction:entity_selector/arguments/advancements"})));case"distance":return ie(Oi("float",0),(_,T,b)=>(r=!0,e??=!n&&_.value[1]!==void 0,d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"gamemode":return ie(c(Ke({unquotable:fo,value:{type:"literal",parser:Ee("adventure","creative","spectator","survival")}})),(_,T,b)=>(n=!0,(_.inverted?m(p.value):d(p.value))&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"limit":return ie(ta(0),(_,T,b)=>(o=_.value<=1,d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),t&&b.err.report(h("mcfunction.parser.entity-selector.arguments.not-applicable",D(p.value)),p),_));case"level":return ie(Oi("integer",0),(_,T,b)=>(n=!0,d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"name":return ie(c(vn),(_,T,b)=>((_.inverted?m(p.value):d(p.value))&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"nbt":return c(nr.compound);case"predicate":return c(Te({category:"predicate"}));case"scores":return ie(Lt({start:"{",pair:{key:Fh("reference",["[","=",",","]","{","}"]),sep:"=",value:Oi("integer"),end:",",trailingEnd:!0},end:"}"}),(_,T,b)=>(d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),O(k({},_),{type:"mcfunction:entity_selector/arguments/scores"})));case"sort":return ie(Ke({unquotable:fo,value:{type:"literal",parser:Ee("arbitrary","furthest","nearest","random")}}),(_,T,b)=>(d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),t&&b.err.report(h("mcfunction.parser.entity-selector.arguments.not-applicable",D(p.value)),p),_));case"tag":return c(Qs(["[","=",",","]","{","}"]));case"team":return ie(c(ec("reference",["[","=",",","]","{","}"])),(_,T,b)=>((_.inverted?m(p.value):d(p.value))&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"type":return ie(c(Te({category:"entity_type",allowTag:!0})),(_,T,b)=>(a?d(p.value)?b.err.report(h("duplicate-key",D(p.value)),p):b.err.report(h("mcfunction.parser.entity-selector.arguments.not-applicable",D(p.value)),p):!_.inverted&&!_.value.isTag&&(a=!0,Q.toString(_.value,"short")==="player"&&(n=!0)),_));case"x":case"y":case"z":return ie(Xs(),(_,T,b)=>(r=!0,d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"dx":case"dy":case"dz":return ie(Xs(),(_,T,b)=>(r=!0,e=!n,d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),_));case"x_rotation":case"y_rotation":return ie(Oi("float",void 0,void 0,!0),(_,T,b)=>(d(p.value)&&b.err.report(h("duplicate-key",D(p.value)),p),_));case void 0:return()=>G;default:return(_,T)=>(T.err.report(h("mcfunction.parser.entity-selector.arguments.unknown",D(p.value)),p),G)}}},end:",",trailingEnd:!0},end:"]"})),u=>O(k({},u),{type:"mcfunction:entity_selector/arguments"})))}}]),s=>{let l={type:"mcfunction:entity_selector",range:s.range,children:s.children,variable:s.children.find($e.is).value.slice(1),arguments:s.children.find(Fs.is),chunkLimited:e,currentEntity:t,dimensionLimited:r,playersOnly:n,predicates:i,single:o,typeLimited:a};return l.hover=Bv(l),l})}function Bv(e){let t=new Map([[0,"\u{1F922}"],[1,"\u{1F605}"],[2,"Good"],[3,"Great"],[4,"\u{1F60C}\u{1F44C}"]]),r;if(e.currentEntity)r=`**Performance**: ${t.get(4)}  
- \`currentEntity\`: \`${e.currentEntity}\``;else{let n=[e.chunkLimited,e.dimensionLimited,e.playersOnly,e.typeLimited].filter(i=>i).length;r=`**Performance**: ${t.get(n)}  
- \`chunkLimited\`: \`${!!e.chunkLimited}\`
- \`dimensionLimited\`: \`${!!e.dimensionLimited}\`
- \`playersOnly\`: \`${!!e.playersOnly}\`
- \`typeLimited\`: \`${!!e.chunkLimited}\``}return e.predicates?.length&&(r+=`

------
**Predicates**: 
${e.predicates.map(n=>`- \`${n}\``).join(`
`)}`),r}var Vv=Cu(Mh("score_holder"),Lv,"mcfunction.parser.score_holder.fake-name.too-long");function qv(e){return ie(me([{predicate:t=>Ti.is(t.peek(2)),parser:xu()},{parser:Vv}]),(t,r,n)=>{let i={type:"mcfunction:score_holder",range:t.range,children:[t]};return xt.is(t)?i.fakeName=t:i.selector=t,e==="single"&&i.selector&&!i.selector.single&&n.err.report(h("mcfunction.parser.entity-selector.multiple-disallowed"),i),i})}function Mh(e,t=[]){return dr(pi(e),Bu,t)}function Fh(e,t=[]){return Cu(Su({category:"objective",usageType:e},t),Iv,"mcfunction.parser.objective.too-long")}var Zv=ie(Ct([ve([dr(Te({category:"stat_type",namespacePathSep:"."}),":"),de(Ee(":")),{get:e=>{if(Q.is(e.children[0])){let t=en.ComplexCategories.get(Q.toString(e.children[0],"short"));if(t)return Te({category:t,namespacePathSep:"."})}return Te({pool:[],allowUnknown:!0,namespacePathSep:"."})}}]),Ee(...en.SimpleValues)]),e=>{let t={type:"mcfunction:objective_criteria",range:e.range};return $e.is(e)?t.simpleValue=e.value:t.children=e.children.filter(Q.is),t});function Qs(e=[]){return Su("tag",e)}function ec(e,t=[]){return Su({category:"team",usageType:e},t)}function Su(e,t){return Gv(Mh(e,t))}var Hv=ie(ve([$i(0,void 0),_e(de(Ee(...Vs.Units)))]),e=>{let t=e.children.find(sr.is),r=e.children.find($e.is);return{type:"mcfunction:time",range:e.range,children:e.children,value:t.value,unit:r?.value}}),Uh=Ke({unquotable:fo}),Kv=/^[0-9a-f]+-[0-9a-f]+-[0-9a-f]+-[0-9a-f]+-[0-9a-f]+$/i,Bh=(e,t)=>{let r={type:"mcfunction:uuid",range:y.create(e),bits:[0n,0n]},n=e.readUntil(" ","\r",`
`,"\r"),i=!1;if(n.match(Kv))try{let o=n.split("-").map(a=>BigInt(`0x${a}`));o.every(a=>a<=Ah)&&(i=!0,r.bits[0]=BigInt.asIntN(64,o[0]<<32n|o[1]<<16n|o[2]),r.bits[1]=BigInt.asIntN(64,o[3]<<48n|o[4]))}catch{}return r.range.end=e.cursor,i||t.err.report(h("mcfunction.parser.uuid.invalid"),r),r};function Cu(e,t,r){return(n,i)=>Dv(i)?ie(e,(o,a,s)=>(o.value.length>t&&s.err.report(h(r,t),o),o))(n,i):e(n,i)}function Gv(e){return ie(e,(t,r,n)=>(t.value.match(Lf)||n.err.report(h("parser.string.illegal-brigadier",D(t.value)),t),t))}function Ei(e){return(t,r)=>{let n={type:"mcfunction:vector",range:y.create(t),children:[],options:e,system:0};t.peek()==="^"&&(n.system=1);for(let i=0;i<e.dimension;i++){i>0&&Xo(t,r);let o=(e.integersOnly,yu(e.integersOnly)(t,r));n.children.push(o),n.system===1!=(o.notation==="^")&&r.err.report(h("mcfunction.parser.vector.mixed"),o)}return e.noLocal&&n.system===1&&r.err.report(h("mcfunction.parser.vector.local-disallowed"),n),n.range.end=t.cursor,n}}function qh(e){let t=$t.instance.get(e);return(r,n)=>{if(r.children[0]?.type!=="mcfunction:entry")return;let i=Wv(r,n.offset),o=i?i.children:[],a=Jv(t,o);if(a.length===0)return;let s=0;for(let c of o)if(n.offset>c.range.end)s+=1;else break;if(s>=a[0].length)return;let l={activeSignature:0,signatures:[]};return l.signatures=a.map(c=>{let u=c[s],p=s+1<c.length?` ${c[s+1]}`:"",d=`${u}${p}`;return{label:d,activeParameter:0,parameters:[{label:[0,u.length]},{label:[u.length,d.length]}]}}),l}}function Wv(e,t){return Ie.findChild(e.children[0],t,!0)}function Jv(e,t){let r=[],n=e;for(let i of t){let o=i.path[i.path.length-1];if(!o||(n=Ln(n,e).treeNode?.children?.[o],!n))break;r.push(hu(o,n))}return n&&(n=Ln(n,e).treeNode,n?.children)?mu(n.children,n.executable).map(i=>[...r,i]):r.length?[r]:[]}function Wh(e){return{children:O(k(O(k(O(k({advancement:{children:{grant:Zh,revoke:Zh}}},gt.cmp(e,"1.16")>=0?{attribute:{children:{target:{children:{attribute:{properties:{category:"attribute"},children:{modifier:{children:{add:{children:{uuid:{properties:{category:"attribute_modifier_uuid",usageType:"definition"}}}},remove:{children:{uuid:{properties:{category:"attribute_modifier_uuid"}}}},value:{children:{get:{children:{uuid:{properties:{category:"attribute_modifier_uuid"}}}}}}}}}}}}}}}:{}),{ban:{permission:3},"ban-ip":{permission:3},banlist:{permission:3},bossbar:{children:{add:{children:{id:{properties:{category:"bossbar",usageType:"definition"}}}},get:{children:{id:{properties:{category:"bossbar"}}}},remove:{children:{id:{properties:{category:"bossbar"}}}},set:{children:{id:{properties:{category:"bossbar",accessType:1}}}}}},data:{children:{get:tc,merge:Jh,modify:{children:{block:{children:{targetPos:{children:{targetPath:Nu}}}},entity:{children:{target:{children:{targetPath:Nu}}}},storage:{children:{target:{properties:{category:"storage",accessType:1},children:{targetPath:Nu}}}}}},remove:tc}},debug:{permission:3},deop:{permission:3},execute:{children:{if:Hh,store:{children:{result:Kh,success:Kh}},unless:Hh}}}),gt.cmp(e,"1.17")>=0?{item:{children:{replace:{children:{block:{children:{pos:{children:{slot:{children:{from:{children:{block:{children:{source:{children:{sourceSlot:{children:{modifier:{properties:{category:"item_modifier"}}}}}}}},entity:{children:{source:{children:{sourceSlot:{children:{modifier:{properties:{category:"item_modifier"}}}}}}}}}}}}}}}},entity:{children:{targets:{children:{slot:{children:{from:{children:{block:{children:{source:{children:{sourceSlot:{children:{modifier:{properties:{category:"item_modifier"}}}}}}}},entity:{children:{source:{children:{sourceSlot:{children:{modifier:{properties:{category:"item_modifier"}}}}}}}}}}}}}}}}}},modify:{children:{block:{children:{pos:{children:{slot:{children:{modifier:{properties:{category:"item_modifier"}}}}}}}},entity:{children:{targets:{children:{slot:{children:{modifier:{properties:{category:"item_modifier"}}}}}}}}}}}}}:{}),{help:{permission:0},kick:{permission:3},list:{permission:0}}),gt.cmp(e,"1.16")>=0?{locatebiome:{children:{biome:{properties:{category:"worldgen/biome"}}}}}:{}),{loot:{children:{give:{children:{players:Pn}},insert:{children:{targetPos:Pn}},replace:{children:{block:{children:{targetPos:{children:{slot:{children:O(k({},Pn.children),{count:Pn})}}}}},entity:{children:{entities:{children:{slot:{children:O(k({},Pn.children),{count:Pn})}}}}}}},spawn:{children:{targetPos:Pn}}}},me:{permission:0},msg:{permission:0},op:{permission:3},pardon:{permission:3},"pardon-ip":{permission:3},playsound:zt,publish:{permission:4},recipe:{children:{give:Gh,take:Gh}},"save-all":{permission:4},"save-off":{permission:4},"save-on":{permission:4},scoreboard:{children:{objectives:{children:{add:{children:{objective:{parser:"minecraft:objective",properties:{usageType:"definition"}}}}}},players:{children:{add:na,operation:na,remove:na,reset:na,set:na}}}},setidletimeout:{permission:3},stop:{permission:4},stopsound:{children:{targets:{children:{"*":zt,ambient:zt,block:zt,hostile:zt,master:zt,music:zt,neutral:zt,player:zt,record:zt,voice:zt,weather:zt}}}},tag:{children:{targets:{children:{add:{children:{name:{parser:"spyglassmc:tag"}}},remove:{children:{name:{parser:"spyglassmc:tag"}}}}}}},team:{children:{add:{children:{team:{parser:"minecraft:team",properties:{usageType:"definition"}}}}}},teammsg:{permission:0},teleport:{children:{destination:void 0,targets:{executable:!0}}},tell:{permission:0},tm:{permission:0},trigger:{permission:0,children:{objective:{properties:{category:"objective",accessType:1}}}},w:{permission:0},whitelist:{permission:3}})}}var Zh=Object.freeze({children:{targets:{children:{from:{children:{advancement:{properties:{category:"advancement"}}}},only:{children:{advancement:{properties:{category:"advancement"}}}},through:{children:{advancement:{properties:{category:"advancement"}}}},until:{children:{advancement:{properties:{category:"advancement"}}}}}}}}),tc=Object.freeze({children:{storage:{children:{source:{properties:{category:"storage"}}}}}}),Jh=Object.freeze({children:{storage:{children:{target:{properties:{category:"storage",accessType:1}}}}}}),ra=Object.freeze({children:{from:tc}}),Nu=Object.freeze({children:{append:ra,insert:{children:{index:ra}},merge:ra,prepend:ra,set:ra}}),Hh=Object.freeze({children:{data:tc,predicate:{children:{predicate:{properties:{category:"predicate"}}}}}}),Kh=Object.freeze({children:O(k({},Jh.children),{bossbar:{children:{id:{properties:{category:"bossbar",accessType:1}}}}})}),Pn=Object.freeze({children:{fish:{children:{loot_table:{properties:{category:"loot_table"}}}},loot:{children:{loot_table:{properties:{category:"loot_table"}}}}}}),na=Object.freeze({children:{targets:{children:{objective:{properties:{accessType:1}}}}}}),Gh=Object.freeze({children:{targets:{children:{recipe:{properties:{category:"recipe"}}}}}}),zt=Object.freeze({children:{sound:{properties:{category:"sound_event"}}}});var Yh=(e,t,r)=>{let{meta:n}=e;ph(e),$t.instance.register(r,t,Wh(r)),n.registerLanguage("mcfunction",{extensions:[".mcfunction"],parser:fh(r,bu),completer:Is.entry(r,Sh),triggerCharacters:[" ","[","=","!",",","{",":","/",".",'"',"'"]}),n.registerParser("mcfunction:block_predicate",ku),n.registerParser("mcfunction:component",vu),n.registerParser("mcfunction:particle",wu),n.registerParser("mcfunction:tag",Qs()),n.registerParser("mcfunction:team",ec()),n.registerParser("mcfunction:command",Ps($t.instance.get(r),bu)),kh(n),wh(n),Nh(n),n.registerInlayHintProvider(Th),n.registerSignatureHelpProvider(qh(r))};var Qh=async e=>{let{config:t,downloader:r,externals:n,logger:i,meta:o,projectRoot:a}=e;async function s(){let _,T=`${a}pack.mcmeta`;try{let b=await oe.readJson(n,T);gs.assert(b),_=b}catch(b){n.error.isKind(b,"ENOENT")||i.error(`[je.initialize] Failed loading pack.mcmeta \u201C${T}\u201D`,b)}return _}o.registerUriBinder(tm);let l=await Jd(e.externals,e.downloader);if(!l){e.logger.error("[je-initialize] Failed loading game version list. Expect everything to be broken.");return}let c=await s(),{release:u,id:p,isLatest:d}=Hd(t.env.gameVersion,{packMcmeta:c,versions:l});o.registerDependencyProvider("@vanilla-mcdoc",()=>em(n,r,p,d));let m=await Yd(e.externals,r,i,p,d,t.env.dataSource,t.env.mcmetaSummaryOverrides);if(!m.blocks||!m.commands||!m.fluids||!m.registries){e.logger.error("[je-initialize] Failed loading mcmeta summaries. Expect everything to be broken.");return}return o.registerSymbolRegistrar("mcmeta-summary",{checksum:m.checksum,registrar:Gd(m)}),o.registerLinter("nameOfNbtKey",{configValidator:Er.configValidator.nameConvention,linter:Er.nameConvention("value"),nodePredicate:_=>!_.symbol&&_.parent?.parent?.type==="nbt:compound"&&sn.is(_.parent)&&_.type==="string"&&_.parent.key===_||!_.symbol&&_.parent?.type==="nbt:path"&&_.type==="string"||Od.is(_.parent)&&$d.is(_)&&!_.symbol?.path[0]?.startsWith("::minecraft")}),nh(e),Yh(e,m.commands,u),Zd(e),{loadedVersion:u}};var zi=new qa({logger:console,profilers:new zr(console,["cache#load","cache#save","project#init","project#ready"]),project:{cacheRoot:"file:///.cache/",defaultConfig:dn.merge(gc,{env:{dependencies:[]}}),externals:nl,initializers:[zd,Qh],projectRoot:"file:///root/"}});await zi.project.ready();zi.project.on("documentErrorred",({errors:e})=>{Xv.innerHTML=e.map(t=>`${t.message}`).join("<br>")});var Xv=document.getElementById("errors"),rc=document.getElementById("language"),nc=document.getElementById("text"),ia=document.getElementById("uri"),Ru=0;zi.project.onDidOpen(ia.value,rc.value,Ru,nc.value);nc.oninput=()=>{zi.project.onDidChange(ia.value,[{text:nc.value}],++Ru)};rc.onchange=()=>{zi.project.onDidClose(ia.value),ia.value=`file:///root/foo.${rc.value}`,zi.project.onDidOpen(ia.value,rc.value,Ru,nc.value)};
/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */
